<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/anypoint-studio/6/studio-policy-editor.html">
  <link rel="stylesheet" href="../../_theme/stylesheets/theme.css">
  <title>Studio Custom Policy Editor (Beta) // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="index.html">Anypoint Studio</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="setting-up-your-development-environment.html">Development Environment Setup</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="hardware-and-software-requirements.html">Hardware and Software Requirements</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="download-and-launch-anypoint-studio.html">Download and Launch Anypoint Studio</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="install-update-items-in-studio.html">Updating Studio, Mule and Components</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="mule-runtime/adding-community-runtime.html">Installing Mule Runtime in Studio</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="install-update-items-in-studio.html">Installing Extensions</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="install-studio-gw.html">Installing API Gateway Runtime</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="maven/using-maven-in-anypoint-studio.html">Using Maven in Studio</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="maven/maven-support-in-anypoint-studio.html">Maven Support in Studio</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="maven/building-a-mule-application-with-maven-in-studio.html">Building Mule Applications with Maven in Studio</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="maven/enabling-maven-support-for-a-studio-project.html">Enabling Maven Support on Studio Projects</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="maven/importing-a-maven-project-into-studio.html">Importing Maven Projects</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="studio-in-eclipse.html">Studio in Eclipse</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="using-subversion-with-studio.html">Using Subversion</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="preparing-a-gitignore-file.html">Preparing a .gitignore file</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="troubleshooting-studio.html">Troubleshooting Studio Issues</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="basic-studio-tutorial.html">Basic Studio Tutorial</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="anypoint-studio-features.html">Studio Reference</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="datasense/datasense.html">DataSense</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="about-defining-metadata.html">Defining Metadata</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="testing-connections.html">Testing Connections</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="using-perceptive-flow-design.html">Using Perceptive Flow Design</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datasense/datasense-enabled-connectors.html">DataSense-enabled Connectors</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datasense/using-the-datasense-explorer.html">Using the DataSense Explorer</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="raml-1-0-data-types-support.html">RAML 1.0 Data Types Support</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datasense/datasense-query-editor.html">DataSense Query Editor</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datasense/datasense-query-language.html">DataSense Query Language</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="transform-message/transform-message-component-concept-studio.html">About Transform Message Component</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                          <button class="nav-tgl"></button>
                                        <a class="nav-lnk" href="transform-message/workflow-create-mapping-ui-studio.html">Workflow: Create a Mapping</a>
                                          <ul class="nav-lst">
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="transform-message/input-output-structure-transformation-studio-task.html">To Define Input and Output Structure of a Transformation</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="transform-message/graphically-construct-mapping-studio-task.html">To Graphically Construct a Mapping</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="transform-message/preview-transformation-output-studio-task.html">To Preview the Output of a Transformation</a>
                                              </li>
                                          </ul>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="transform-message/tips-transform-message-ui-studio.html">Tips on the Transform Message UI</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="transform-message/change-target-output-transformation-studio-task.html">To Change the Target Output of a Transformation</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="transform-message/add-another-output-transform-studio-task.html">To Add Another Output Target</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="transform-message/move-transformations-separate-file-studio-task.html">To Move Transformations to Separate Files</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="studio-visual-debugger.html">Studio Visual Debugger</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="import-export-projects-studio.html">Importing and Exporting</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="api-sync-reference.html">API Sync</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="mule-runtime/changing-runtimes-in-studio.html">Changing Runtimes in Studio</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="studio-policy-editor.html">Studio Policy Editor (Beta)</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="keyboard-shortcuts-in-studio.html">Keyboard Shortcuts</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-source-attachments-to-studio.html">Adding Source Attachments to Studio</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="deploy-more-than-one-application.html">Deploy More than One Application</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="mule-runtime/starting-the-runtime-in-cluster-mode-in-studio.html">Starting the Studio Runtime in Cluster Mode</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="datamapper/datamapper-user-guide-and-reference.html">DataMapper (Deprecated)</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datamapper/datamapper-concepts.html">DataMapper Concepts</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datamapper/datamapper-visual-reference.html">DataMapper Visual Reference</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                          <button class="nav-tgl"></button>
                                        <a class="nav-lnk" href="datamapper/defining-datamapper-input-and-output-metadata.html">Defining DataMapper Input and Output Metadata</a>
                                          <ul class="nav-lst">
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="defining-metadata-using-edit-fields.html">Defining Metadata Using Edit Fields</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="pojo-class-bindings-and-factory-classes.html">POJO Class Bindings and Factory Classes</a>
                                              </li>
                                          </ul>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                          <button class="nav-tgl"></button>
                                        <a class="nav-lnk" href="building-a-mapping-flow-in-the-graphical-mapping-editor.html">Building a Mapping Flow in the Graphical Mapping Editor</a>
                                          <ul class="nav-lst">
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="mapping-flow-input-and-output-properties.html">Mapping Flow Input and Output Properties</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="datamapper/datamapper-input-error-policy-for-bad-input-data.html">DataMapper Input Error Policy for Bad Input Data</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="datamapper/using-datamapper-lookup-tables.html">Using DataMapper Lookup Tables</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="datamapper/streaming-data-processing-with-datamapper.html">Streaming Data Processing with DataMapper</a>
                                              </li>
                                          </ul>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="updating-metadata-in-an-existing-mapping.html">Updating Metadata in an Existing Mapping</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="mapping-elements-inside-lists.html">Mapping Elements Inside Lists</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datamapper/previewing-datamapper-results-on-sample-data.html">Previewing DataMapper Results on Sample Data</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datamapper/datamapper-examples.html">DataMapper Examples</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                          <button class="nav-tgl"></button>
                                        <a class="nav-lnk" href="datamapper/datamapper-supplemental-topics.html">DataMapper Supplemental Topics</a>
                                          <ul class="nav-lst">
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="choosing-mel-or-ctl2-as-scripting-engine.html">Choosing MEL or CTL2 as Scripting Engine</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="datamapper/datamapper-fixed-width-input-format.html">DataMapper Fixed Width Input Format</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="datamapper/datamapper-flat-to-structured-and-structured-to-flat-mapping.html">DataMapper Flat-to-Structured and Structured-to-Flat Mapping</a>
                                              </li>
                                          </ul>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datamapper/including-the-datamapper-plugin.html">Including the DataMapper Plugin</a>
                                      </li>
                                  </ul>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">Studio Custom Policy Editor (Beta)</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/anypoint-studio-docs/edit/v6/modules/ROOT/content/studio-policy-editor.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>Studio Custom Policy Editor (Beta)</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Studio 6.1 (and newer) grants you the ability to create a <strong>policy project</strong>, under which you can group your <strong>custom API policies</strong> and apply them to your local Studio deployments.<br>
This way you can compose, debug and test custom API policies within Studio, using an editor that fully supports and validates custom API policies design.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The custom policy editor is still in beta and is available only for Enterprise Edition users of <a href="../../release-notes/anypoint-studio/6.1-with-3.8.1-runtime-release-notes.html">Anypoint Studio 6.1</a> and newer.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assumptions"><a class="anchor" href="#assumptions"></a>Assumptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This article assumes that you are familiar <a href="../../anypoint-platform/api-manager/using-policies.html">using policies</a> in Anypoint Platform and that you are able to <a href="../../anypoint-platform/api-manager/creating-a-policy-walkthrough.html">create</a> and <a href="../../anypoint-platform/api-manager/applying-custom-policies.html">apply</a> custom policies.<br>
It also assumes that you are familiar with <a href="index.html#the-visual-editor">Studio&#8217;s Visual Editor</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usage"><a class="anchor" href="#usage"></a>Usage</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For this beta release, Studio only supports policy creation and edition through XML.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to create a custom policy project:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right click in your <strong>Package explorer</strong> and select, <strong>New</strong> and <strong>API Custom Policy Project (beta)</strong>.</p>
</li>
<li>
<p>Give a Name to your Policy Project, and make sure to agree to the beta trial license:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/studio-policy-editor-a01e0.png" alt="studio policy editor a01e0">
</div>
</div>
</li>
<li>
<p>When you create a Custom Policy Project for the first time, a default example loads containing:</p>
<div class="ulist">
<ul>
<li>
<p>a sample <a href="../../anypoint-platform/api-manager/creating-a-policy-walkthrough.html#create-the-policy-configuration-file">policy configuration file</a>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;policy xmlns="http://www.mulesoft.org/schema/mule/policy"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:spring="http://www.springframework.org/schema/beans"
        xmlns:mule="http://www.mulesoft.org/schema/mule/core"
        xmlns:mule-ss="http://www.mulesoft.org/schema/mule/spring-security"
        xmlns:ss="http://www.springframework.org/schema/security"
        xmlns:api-platform-gw="http://www.mulesoft.org/schema/mule/api-platform-gw"
        xsi:schemaLocation="http://www.mulesoft.org/schema/mule/policy http://www.mulesoft.org/schema/mule/policy/current/mule-policy.xsd
              http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
              http://www.mulesoft.org/schema/mule/spring-security http://www.mulesoft.org/schema/mule/spring-security/current/mule-spring-security.xsd
              http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security-current.xsd
              http://www.mulesoft.org/schema/mule/api-platform-gw http://www.mulesoft.org/schema/mule/api-platform-gw/current/mule-api-platform-gw.xsd
              http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd"&gt;

    &lt;pointcut&gt;
        &lt;api-platform-gw:api-pointcut apiName="{{ apiName }}" apiVersion="{{ apiVersionName }}"/&gt;
    &lt;/pointcut&gt;

    &lt;before&gt;
        &lt;mule:set-variable variableName="evaluated" value="{{ query }}" /&gt;

        &lt;mule:message-filter onUnaccepted="policyViolation"&gt;
            &lt;mule:expression-filter expression="#[!evaluated]" /&gt;
        &lt;/mule:message-filter&gt;
    &lt;/before&gt;

    &lt;after&gt;
        &lt;mule:set-property propertyName="Custom-Header" value="Example Policy" /&gt;
    &lt;/after&gt;

    &lt;mule:processor-chain name="policyViolation"&gt;
        &lt;mule:logger message="The custom policy filtered the message #[message.getId()] based on a MEL query" level="DEBUG" /&gt;
        &lt;mule:set-property propertyName="http.status" value="403"/&gt;
        &lt;mule:set-property propertyName="Content-Type" value="application/json"/&gt;
        &lt;mule:set-payload value='{ "error" : "Custom Policy: {{ denied-message }}"}'/&gt;
    &lt;/mule:processor-chain&gt;
&lt;/policy&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When designing a custom API in Studio, the <code>&lt;before&gt;</code> and <code>&lt;after&gt;</code> tags can&#8217;t be left empty.<br>
If your design does not require an after tag, don&#8217;t declare it.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>a sample <a href="../../anypoint-platform/api-manager/creating-a-policy-walkthrough.html#create-the-custom-policy-definition">policy definition file</a>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">name: Custom Policy Example
description: Specifies an MEL *query* expression which when evaluated against incoming messages and returning true, rejects the incoming message.
category: Security
standalone: true
providedCharacteristics: [Message protection]
requiredCharacteristics: []

configuration:
  - propertyName: query
    name: MEL query
    description: MEL query expression to filter incoming requests
    type: expression
    optional: false
    defaultValue: "#[message.inboundProperties['http.method'] == 'POST']"
  - propertyName: denied-message
    name: Rejection message
    description: A message to display when an incoming message is filtered
    type: string
    defaultValue: Access denied
    optional: false</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This sample custom policy bascially blocks all POST requests being sent to your endpoint.<br>
It asserts the MEL expression: <code>#[message.inboundProperties['http.method'] == 'POST']</code> against the message being received. If there&#8217;s a match it prevents the action and returns an <code>Access denied</code> message.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can have more than one configuration and definition file inside the same project. However, you can only apply one pair at a time.
Your Custom Policy Project holds a <code>mule-policy.xml</code> file in which you can define an <code>.xml</code> and <code>.yaml</code> to apply.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/studio-policy-editor-f4c04.png" alt="studio policy editor f4c04">
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="applying-the-custom-policy-in-your-local-deployment"><a class="anchor" href="#applying-the-custom-policy-in-your-local-deployment"></a>Applying the Custom Policy in Your Local Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Custom policies are independent of the APIs to which you want to apply them.<br>
You can <em>point</em> a custom policy to one or several APIs by <a href="../../anypoint-platform/api-manager/applying-custom-policies.html#customizing-a-pointcut">customizing the pointcut conditions</a> to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Point the policy using the <code>{{ apiName }}</code> and <code>{{ apiVersionName }}</code> <a href="../../anypoint-platform/api-manager/applying-custom-policies.html#referencing-properties">reference properties</a>.</p>
</li>
<li>
<p>Set up a regex expression to match it with defined endpoints and resources.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>However, when designing a custom API in Studio, you need to have at least one local Mule project to deploy and apply the policy.<br>
In order to test how the policy behaves when applied to an API, we are creating a simple Mule Project using a variation of the Leagues API example used in <a href="../../anypoint-platform/api-manager/applying-custom-policies.html">Applying custom policies</a> page:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download <a href="./_attachments/LeagueAPIexample.raml">this RAML API definition</a> and import it to Studio, so APIKit Studio plugin can automatically generate the flows for your Mule application.</p>
</li>
<li>
<p>Go to the "Global Elements" tab, and <em>Create</em> a new API Autodiscovery element. Assign an API Name, Version and select the flow that contains your APIKit router component as your main flow reference.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The API Autodiscovery element is necessary if you want to leave the <code>apiName</code> and <code>apiVersionName</code> placeholder properties in your .yaml definition file. You can additionally replace the API name and version in your policy&#8217;s configuration file.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also apply this policy to an existing Mule Project in your Package Explorer, however, make sure to either configure a proper <strong>API Autodiscovery</strong> element, or manually point your custom policy pointcut to that specific API.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Now that you have one Project to which apply this newly created policy, it&#8217;s time to locally deploy everything together.<br>
In order to do so:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right click in your policy project, and select <strong>Run as</strong> and <strong>Run Configurations&#8230;&#8203;</strong></p>
</li>
<li>
<p>The run configuration screen for custom policies is shown:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/studio-policy-editor-8a38d.png" alt="studio policy editor 8a38d">
</div>
</div>
</li>
<li>
<p>Select an API Custom Policy Project and a Mule Domain or Project to launch</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you configured an API Autodiscovery element for your projects, when you select the Mule Project, the apiName and apiVersionName properties are automatically updated.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <strong>Apply</strong> and then <strong>Run</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you inspect your console logs, depending on your logging settings, you might notice an INFO message letting you know that the policy was correctly applied:</p>
</div>
<hr>
<div class="paragraph">
<p>com.mulesoft.module.policies.lifecyle.PolicyRegistryLifecycleManager: Policy policy.xml was correctly applied
---</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can choose to select <code>Show generated API policy file</code> before running the policy project. This causes Studio to show the resulting policy XML file that&#8217;s generated from the configuration file, using the properties defined in the definition file.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In order to test if the policy is being applied, open POSTMAN (or any other similar application to send requests) and try to POST anything to <code>0.0.0.0:8081/api/teams</code>, the response should be align to your configured policy:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "error": "Custom Policy: Access denied"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="know-limitations"><a class="anchor" href="#know-limitations"></a>Know Limitations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Being a beta release, the Custom Policy Editor for Studio has some limitations. Keep the following points in mind when designing and testing your custom policy:</p>
</div>
<div class="sect2">
<h3 id="limitations-for-the-configuration-file"><a class="anchor" href="#limitations-for-the-configuration-file"></a>Limitations for the Configuration File</h3>
<div class="ulist">
<ul>
<li>
<p>XML validation for sections within the policy configuration file (such as <code>{{#isWsdlEndpoint}} {{/isWsdlEndpoint}}</code>) is not supported. Policies configured using sections such as the one in the example below will run, but the editor won&#8217;t validate them before running.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;mule:processor-chain name="{{policyId}}-build-response"&gt;
       &lt;mule:set-property propertyName="http.status" value="403"/&gt;
       {{#isWsdlEndpoint}}
         &lt;mule:set-property propertyName="Content-Type" value="text/xml"/&gt;
         &lt;mule:set-payload value="#[soapFault('client', _invalidClientMessage)]"/&gt;
       {{/isWsdlEndpoint}}

       {{^isWsdlEndpoint}}
         &lt;mule:set-property propertyName="Content-Type" value="application/json"/&gt;
         &lt;mule:set-payload value="#[_invalidClientMessage]"/&gt;
       {{/isWsdlEndpoint}}
   &lt;/mule:processor-chain&gt;</code></pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="limitations-for-the-definition-file"><a class="anchor" href="#limitations-for-the-definition-file"></a>Limitations for the Definition File</h3>
<div class="ulist">
<ul>
<li>
<p>The only supported YAML types for the policy definition file are: <code>String</code>, <code>Boolean</code>, <code>Int</code>, <code>Expression</code> and <code>IpAddress</code>.</p>
</li>
<li>
<p>The <code>hasContract</code> boolean to define wether this custom policy has credentials defined to access other APIs or not, is currently not supported.</p>
</li>
<li>
<p>Studio does not validate the <code>gatewayCompatibility</code> attribute</p>
</li>
<li>
<p><code>requiredCharacteristics</code> and <code>providedCharacteristics</code> fields are not validated from Studio</p>
</li>
<li>
<p>The <code>{{order}}</code> attribute from the YAML file is not supported. The order of the policy is overwritten by the other set in the <strong>Run Configurations</strong> screen.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="limititations-for-studio"><a class="anchor" href="#limititations-for-studio"></a>Limititations for Studio</h3>
<div class="ulist">
<ul>
<li>
<p>Importing and exporting custom policies from API Platform is not supported</p>
</li>
<li>
<p>Importing custom policies from Exchange is not supported</p>
</li>
<li>
<p>As stated earlier, this feature is currently aimed for local testing. Currently it&#8217;s not possible to run your custom policies against your APIs in API Manager and validate them there.</p>
</li>
<li>
<p>You can only configure one <code>ApiName</code> and <code>ApiVersion</code> attribute in the Run Configuration.</p>
</li>
<li>
<p>The Visual Debugger does not support debugging of custom policies.</p>
</li>
<li>
<p>There is no MUnit support</p>
</li>
<li>
<p>Maven support for Custom Policies is not supported</p>
</li>
</ul>
</div>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../_theme/scripts/menu.js"></script>
<script src="../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
