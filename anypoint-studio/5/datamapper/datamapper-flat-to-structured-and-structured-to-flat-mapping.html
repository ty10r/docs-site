<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="datamapper">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/anypoint-studio/6/datamapper/datamapper-flat-to-structured-and-structured-to-flat-mapping.html">
  <link rel="stylesheet" href="../../../_theme/stylesheets/theme.css">
  <title>DataMapper Flat-to-Structured and Structured-to-Flat Mapping // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="../index.html">Anypoint Studio</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="../setting-up-your-development-environment.html">Development Environment Setup</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../hardware-and-software-requirements.html">Hardware and Software Requirements</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="../download-and-launch-anypoint-studio.html">Download and Launch Anypoint Studio</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../install-update-items-in-studio.html">Installing Extensions</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="../install-update-items-in-studio.html">Studio Update Sites</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../mule-runtime/adding-community-runtime.html">Installing Community Edition of Mule Runtime</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../install-studio-gw.html">Installing API Gateway Runtime</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="../maven/using-maven-in-anypoint-studio.html">Using Maven in Studio</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../maven/maven-support-in-anypoint-studio.html">Maven Support in Studio</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../maven/building-a-mule-application-with-maven-in-studio.html">Building Mule Applications with Maven in Studio</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../maven/enabling-maven-support-for-a-studio-project.html">Enabling Maven Support on Studio Projects</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../maven/importing-a-maven-project-into-studio.html">Importing Maven Projects</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../studio-in-eclipse.html">Studio in Eclipse</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../using-subversion-with-studio.html">Using Subversion</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="../basic-studio-tutorial.html">Basic Studio Tutorial</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="../anypoint-studio-features.html">Studio Reference</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="../datasense/datasense.html">DataSense</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../testing-connections.html">Testing Connections</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../using-perceptive-flow-design.html">Using Perceptive Flow Design</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../datasense/datasense-enabled-connectors.html">DataSense-enabled Connectors</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../datasense/using-the-datasense-explorer.html">Using the DataSense Explorer</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../datasense/datasense-query-editor.html">DataSense Query Editor</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../datasense/datasense-query-language.html">DataSense Query Language</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../using-dataweave-in-studio.html">DataWeave</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../studio-visual-debugger.html">Studio Visual Debugger</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../import-export-projects-studio.html">Importing and Exporting</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../mule-runtime/changing-runtimes-in-studio.html">Changing Runtimes in Studio</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../keyboard-shortcuts-in-studio.html">Keyboard Shortcuts</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../adding-source-attachments-to-studio.html">Adding Source Attachments to Studio</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="../mule-runtime/starting-the-runtime-in-cluster-mode-in-studio.html">Starting the Runtime in Cluster Mode in Studio</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="datamapper-user-guide-and-reference.html">DataMapper (Deprecated)</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datamapper-concepts.html">DataMapper Concepts</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datamapper-visual-reference.html">DataMapper Visual Reference</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                          <button class="nav-tgl"></button>
                                        <a class="nav-lnk" href="defining-datamapper-input-and-output-metadata.html">Defining DataMapper Input and Output Metadata</a>
                                          <ul class="nav-lst">
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="../defining-metadata-using-edit-fields.html">Defining Metadata Using Edit Fields</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="../pojo-class-bindings-and-factory-classes.html">POJO Class Bindings and Factory Classes</a>
                                              </li>
                                          </ul>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                          <button class="nav-tgl"></button>
                                        <a class="nav-lnk" href="../building-a-mapping-flow-in-the-graphical-mapping-editor.html">Building a Mapping Flow in the Graphical Mapping Editor</a>
                                          <ul class="nav-lst">
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="../mapping-flow-input-and-output-properties.html">Mapping Flow Input and Output Properties</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="datamapper-input-error-policy-for-bad-input-data.html">DataMapper Input Error Policy for Bad Input Data</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="using-datamapper-lookup-tables.html">Using DataMapper Lookup Tables</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="streaming-data-processing-with-datamapper.html">Streaming Data Processing with DataMapper</a>
                                              </li>
                                          </ul>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../updating-metadata-in-an-existing-mapping.html">Updating Metadata in an Existing Mapping</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="../mapping-elements-inside-lists.html">Mapping Elements Inside Lists</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="previewing-datamapper-results-on-sample-data.html">Previewing DataMapper Results on Sample Data</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="datamapper-examples.html">DataMapper Examples</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                          <button class="nav-tgl"></button>
                                        <a class="nav-lnk" href="datamapper-supplemental-topics.html">DataMapper Supplemental Topics</a>
                                          <ul class="nav-lst">
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="../choosing-mel-or-ctl2-as-scripting-engine.html">Choosing MEL or CTL2 as Scripting Engine</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="datamapper-fixed-width-input-format.html">DataMapper Fixed Width Input Format</a>
                                              </li>
                                              <li class="nav-itm" data-depth="4" data-state="collapsed">
                                                <a class="nav-lnk" href="datamapper-flat-to-structured-and-structured-to-flat-mapping.html">DataMapper Flat-to-Structured and Structured-to-Flat Mapping</a>
                                              </li>
                                          </ul>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="including-the-datamapper-plugin.html">Including the DataMapper Plugin</a>
                                      </li>
                                  </ul>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">DataMapper Flat-to-Structured and Structured-to-Flat Mapping</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/anypoint-studio-docs/edit/v5/modules/ROOT/content/datamapper/datamapper-flat-to-structured-and-structured-to-flat-mapping.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>DataMapper Flat-to-Structured and Structured-to-Flat Mapping</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>DataMapper will continue to be fully supported in all current and future versions of Mule ESB 3.x, however it will be removed in Mule 4.0 in favour of the <strong>Transform Message</strong> component (based on <a href="../../../mule-runtime/3.8/dataweave/dataweave.html">DataWeave</a> code). We recommend that if you wish to take advantage of the new capabilities of DataWeave or if you start new projects, upgrade now.</p>
</div>
<div class="paragraph">
<p>A <a href="../../../mule-runtime/3.8/dataweave/dataweave-migrator.html">migration tool</a> is now included in Studio, which assists in converting a DataMapper map to DataWeave. Right click on a DataMapper, select <strong>Migrate to DataWeave</strong>, and follow the instructions.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/dw-migrator-script.png" alt="dw migrator">
</div>
</div>
<div class="paragraph">
<p>If you don&#8217;t see DataMapper on your palette, you can enable it by going to <strong>Preferences</strong> &#8594; <strong>Anypoint Studio</strong> &#8594; <strong>Palette Profiles</strong> and ticking the checkbox <strong>Show deprecated Mule Components and Attributes</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This document describes how to use Anypoint DataMapper to map data between a flat format and a structured format. Here you will find two working examples: Mapping from <a href="#csv-to-xml">CSV to XML</a> and from <a href="#xml-to-csv">XML to CSV</a>.</p>
</div>
<div class="paragraph">
<p>In the first example, the CSV file contains repetitive numbered fields (<code>address 1</code> and <code>address 2</code>) which we must map to  nested structures in the XML file. Likewise, the XML file contains nested structures which we must map to numbered fields in the CSV output file.</p>
</div>
<div class="paragraph">
<p>To map numbered CSV fields to XML, we will work with mapping levels. To map from XML to numbered CSV fields, we will work with <a href="http://en.wikipedia.org/wiki/XPath">XPath</a> rules.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="csv-to-xml"><a class="anchor" href="#csv-to-xml"></a>CSV to XML</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="files-used-for-this-example"><a class="anchor" href="#files-used-for-this-example"></a>Files Used For This Example</h3>
<div class="listingblock">
<div class="title">Input CSV File</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Name,Last Name,Street 1,ZipCode 1,Street 2,ZipCode 2
John,Doe,123 Main Street,111,987 Cypress Avenue,222
Jane,Doe,345 Main Street,111,654 Sunset Boulevard,333</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">XML Reference File</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;users&gt;
    &lt;user&gt;
        &lt;name&gt;&lt;/name&gt;
        &lt;lastName&gt;&lt;/lastName&gt;
        &lt;addresses&gt;
            &lt;address&gt;
                &lt;street&gt;&lt;/street&gt;
                &lt;zipCode&gt;&lt;/zipCode&gt;
            &lt;/address&gt;
            &lt;address&gt;
                &lt;street&gt;&lt;/street&gt;
                &lt;zipCode&gt;&lt;/zipCode&gt;
            &lt;/address&gt;
        &lt;/addresses&gt;
    &lt;/user&gt;
    &lt;user&gt;
        &lt;name&gt;&lt;/name&gt;
        &lt;lastName&gt;&lt;/lastName&gt;
        &lt;addresses&gt;
            &lt;address&gt;
                &lt;street&gt;&lt;/street&gt;
                &lt;zipCode&gt;&lt;/zipCode&gt;
            &lt;/address&gt;
        &lt;/addresses&gt;
    &lt;/user&gt;
&lt;/users&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example shows how to map the numbered fields in the CSV file shown above to the XML file shown below it.</p>
</div>
<div class="paragraph">
<p>We will map the numbered fields <code>Street 1</code> and <code>Street 2</code>, and <code>ZipCode 1</code> and <code>ZipCode 2</code>, to the elements <code>&lt;street&gt;</code> and <code>&lt;zipCode&gt;</code>  in the XML <code>&lt;address&gt;</code> element. To do this, we will use mapping levels as shown in the image below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/outline-levels.png" alt="outline levels">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/intro-element-mapping.png" alt="intro-element.mapping">
</div>
</div>
<div class="paragraph">
<p>The image above shows the three mapping levels, visible when you click <strong>Element Mapping</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="creating-the-example"><a class="anchor" href="#creating-the-example"></a>Creating the Example</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First, create a new DataMapper transformer of <strong>Input Type</strong> CSV and <strong>Output Type</strong> XML, using the files provided <a href="#files-used-for-this-example">Files Used For This Example</a>.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/dm-initial1.png" alt="DM_initial1">
</div>
</div>
</li>
<li>
<p>In the <strong>Input</strong> pane, select Type <code>CSV</code>, and provide the sample CSV file.</p>
</li>
<li>
<p>In the <strong>Output</strong> pane, select Type <code>XML</code>, and provide the sample XML file.</p>
</li>
<li>
<p>After assigning the input and output files, click Create mapping. The Data Mapping View should look like the image below.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/dm-initiala1.png" alt="DM_initialA1">
</div>
</div>
<div class="paragraph">
<p>As you can see, Anypoint DataMapper has automatically created a top-level mapping called <code>Foreach 'CSV' &#8594; 'employees'</code>, and mapped the field <code>Name</code> since it is identical in the input and output panes. You can now map additional elements, such as <code>Street 1</code> to <code>street</code> and <code>Zipcode 1</code> to <code>zipCode</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/dm-intial2.png" alt="DM_intial2">
</div>
</div>
</li>
<li>
<p>Now, map the input fields <code>Street 2</code> to <code>street</code>, and <code>ZipCode 2</code> to <code>zipCode</code>. The final mapping should look like the image below.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/dm-intial3.png" alt="DM_intial3">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To test your mapping, use the <a href="previewing-datamapper-results-on-sample-data.html">Preview</a> feature by completing the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <strong>Preview</strong> to access the Preview pane.</p>
</li>
<li>
<p>Click <strong>Run</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The resulting output XML is listed below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;employees&gt;
  &lt;employee&gt;
    &lt;name&gt;John&lt;/name&gt;
    &lt;lastName&gt;Doe&lt;/lastName&gt;
    &lt;addresses&gt;
      &lt;address&gt;
        &lt;street&gt;123 Main Street&lt;/street&gt;
        &lt;zipCode&gt;111&lt;/zipCode&gt;
      &lt;/address&gt;
      &lt;address&gt;
        &lt;street&gt;987 Cypress Avenue&lt;/street&gt;
        &lt;zipCode&gt;222&lt;/zipCode&gt;
      &lt;/address&gt;
    &lt;/addresses&gt;
  &lt;/employee&gt;
  &lt;employee&gt;
    &lt;name&gt;Jane&lt;/name&gt;
    &lt;lastName&gt;Doe&lt;/lastName&gt;
    &lt;addresses&gt;
      &lt;address&gt;
        &lt;street&gt;345 Main Street&lt;/street&gt;
        &lt;zipCode&gt;111&lt;/zipCode&gt;
      &lt;/address&gt;
      &lt;address&gt;
        &lt;street&gt;654 Sunset Boulevard&lt;/street&gt;
        &lt;zipCode&gt;333&lt;/zipCode&gt;
      &lt;/address&gt;
    &lt;/addresses&gt;
  &lt;/employee&gt;
&lt;/employees&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="xml-to-csv"><a class="anchor" href="#xml-to-csv"></a>XML to CSV</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="files-used-for-this-example-2"><a class="anchor" href="#files-used-for-this-example-2"></a>Files Used For This Example</h3>
<div class="listingblock">
<div class="title">Input XML File</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;employees&gt;
    &lt;employee&gt;
        &lt;name&gt;John&lt;/name&gt;
        &lt;lastName&gt;Doe&lt;/lastName&gt;
        &lt;addresses&gt;
            &lt;address&gt;
                &lt;street&gt;123 Main Street&lt;/street&gt;
                &lt;zipCode&gt;111&lt;/zipCode&gt;
            &lt;/address&gt;
            &lt;address&gt;
                &lt;street&gt;987 Cypress Avenue&lt;/street&gt;
                &lt;zipCode&gt;222&lt;/zipCode&gt;
            &lt;/address&gt;
        &lt;/addresses&gt;
    &lt;/employee&gt;
    &lt;employee&gt;
        &lt;name&gt;Jane&lt;/name&gt;
        &lt;lastName&gt;Doe&lt;/lastName&gt;
        &lt;addresses&gt;
            &lt;address&gt;
                &lt;street&gt;345 Main Street&lt;/street&gt;
                &lt;zipCode&gt;111&lt;/zipCode&gt;
            &lt;/address&gt;
            &lt;address&gt;
                &lt;street&gt;654 Sunset Boulevard&lt;/street&gt;
                &lt;zipCode&gt;333&lt;/zipCode&gt;
            &lt;/address&gt;
        &lt;/addresses&gt;
    &lt;/employee&gt;
&lt;/employees&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example CSV File For Output</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">Name,Last Name,Street 1,ZipCode 1, Street 2, ZipCode 2</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to map from XML to CSV we will use rules, which we define in DataMapper. These rules use the <a href="http://en.wikipedia.org/wiki/XPath">XPath</a> query language for obtaining nodes in an XML document.</p>
</div>
<div class="paragraph">
<p>Using XPath, the rules fetch the values of the XML elements that you want, and feed them to DataMapper. DataMapper maps the values to whatever output fields you define in the CSV output file.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/diagram.png" alt="diagram">
</div>
</div>
<div class="paragraph">
<p>The image above shows how XPath retrieves values stored in XML structures. The XPath expression <code>/addresses/address[1]/street</code> retrieves the contents of the <code>street</code> element in the first <code>address</code> element of <code>addresses</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="creating-the-example-2"><a class="anchor" href="#creating-the-example-2"></a>Creating the Example</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First, create a new DataMapper transformer of <strong>Input Type</strong> XML and <strong>Output Type</strong> CSV, using the files provided <a href="#files-used-for-this-example">Files Used For This Example</a>.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/xml-initial1.png" alt="XML_initial1">
</div>
</div>
</li>
<li>
<p>In the <strong>Input</strong> pane, select Type <code>XML</code>. Click <strong>Generate schema from xml</strong>, and provide the sample XML file.</p>
</li>
<li>
<p>In the <strong>Output</strong> pane, select Type <code>CSV</code>, and provide the sample CSV file.</p>
</li>
<li>
<p>After assigning the input and output files, click Create mapping. The Data Mapping View should look like the image below.</p>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/xml-initial2.png" alt="XML_initial2">
</div>
</div>
<div class="paragraph">
<p>As you can see, DataMapper has automatically created a top-level mapping called <code>Foreach 'employees' &#8594; 'contacts'</code>. Because there are no top-level elements in the source XML document that populate rows in the output CSV document, this mapping is not needed, and in fact it will generate an extra row of output in the CSV if left in place.</p>
</div>
</li>
<li>
<p>Delete this top-level mapping by clicking the <span class="image"><img src="../_images/datamapper/remove-map-icon.png" alt="remove.map.icon"></span> icon. Then, create a new mapping by clicking the <span class="image"><img src="../_images/datamapper/add-map-icon.png" alt="add.map.icon"></span> icon.</p>
</li>
<li>
<p>Studio will display the <strong>Add Mapping</strong> window. Configure the window as outlined in the table below.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Window: <strong>Add Mapping</strong></p>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Remarks</th>
<th class="tableblock halign-left valign-top">Configuration window image</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Employees</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Suggested value</p></td>
<td class="tableblock halign-left valign-top" rowspan="3"><p class="tableblock"><span class="image"><img src="../_images/datamapper/xmladdmap1.png" alt="XMLaddmap1"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Source</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>employee : employee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click <code>employee : employee</code> in the <strong>Source</strong> pane to select</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Target</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>contacts</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click <code>contacts</code> in the <strong>Target</strong> pane to select</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>After creating the new mapping, the DataMapper view should look like the image below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/xml-initial3.png" alt="XML_initial3">
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>As you can see, DataMapper mapped the top-level input element <code>employee : employee</code> to <code>contacts</code>, enabling you to map child elements between the two. DataMapper also mapped the field <code>Name</code>, because the name of this field is exactly the same in the input and output.</p>
</div>
<div class="paragraph">
<p>You now have to manually map the input field <code>lastName</code> to the output field <code>Last Name</code>. Click the input field, drag it to the output field, and release.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/xmlmapping-3.png" alt="XMLmapping_3">
</div>
</div>
<div class="paragraph">
<p>To map the addresses in the input XML file to the output CSV fields <code>Street 1</code>, <code>Street 2</code>, etc., you need to create a rule for the input element <code>address : address</code>. To create the rule, right-click <code>address : address</code> in the Input pane, then select <strong>Create Rule based on this element</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/create-rule.png" alt="create.rule">
</div>
</div>
<div class="paragraph">
<p>DataMapper will display the <strong>Create a new xpath rule</strong> window. Configure the window as outlined in the table below.</p>
</div>
<div class="paragraph">
<p>Window: <strong>Create xpath rule</strong></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Remarks</th>
<th class="tableblock halign-left valign-top">Configuration window image</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Street1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Suggested value</p></td>
<td class="tableblock halign-left valign-top" rowspan="5"><p class="tableblock"><span class="image"><img src="../_images/datamapper/configure-rule-1.png" alt="configure.rule.1"></span></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Context</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/employees/employee</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>XPath</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/addresses/address[1]/street</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Target Field</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Street 1 : string</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>After creating the rule, the DataMapper view should look like the image below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/xml-initial4.png" alt="XML_initial4">
</div>
</div>
<div class="paragraph">
<p>As you can see, DataMapper indicates that the rule <code>Street1</code> is in effect for mapping to the output field <code>Street 1</code>.</p>
</div>
<div class="paragraph">
<p>At this point, the output CSV file would be the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">"John","Doe","123 Main Street","","",""
"Jane","Doe","345 Main Street","","",""</code></pre>
</div>
</div>
<div class="paragraph">
<p>We have mapped the street of the first address of the first employee in the input XML file. We now have to create additional rules to map the remaining addresses and their child elements.</p>
</div>
<div class="paragraph">
<p>Following the procedure outlined above to create XPath rules, create additional rules for the <code>address : address</code> input element, using the values provided in the table below.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 60%;">
<colgroup>
<col>
<col>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name (suggested)</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Context</th>
<th class="tableblock halign-left valign-top">XPath</th>
<th class="tableblock halign-left valign-top">Target field</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>zipCode1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/employee/employee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/addresses/address[1]/zipCode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ZipCode 1</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Street2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/employee/employee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/addresses/address[2]/street</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Street 2</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>zipCode2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>string</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/employee/employee</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/addresses/address[2]/zipCode</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>ZipCode 2</strong></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Once you have created the rules, you have mapped all of the input elements to their corresponding output elements. The DataMapper view should look like the image below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/datamapper/xml-initial5.png" alt="XML_initial5">
</div>
</div>
<div class="paragraph">
<p>To test your mapping, use the <a href="previewing-datamapper-results-on-sample-data.html">Preview</a> feature by completing the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <strong>Preview</strong> to go to the Preview pane.</p>
</li>
<li>
<p>In the <strong>Input data</strong> field, type the path of the input XML file you prepared for this example, or use the ellipsis (<strong>&#8230;&#8203;</strong>) button to select the file.</p>
</li>
<li>
<p>Click <strong>Run</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The resulting output CSV file should be the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">"Name","Last Name","Street 1","ZipCode 1","Street 2","ZipCode 2"
"John","Doe","123 Main Street","111","987 Cypress Avenue","222"
"Jane","Doe","345 Main Street","111","654 Sunset Boulevard","333"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>See Also</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Read about using in-memory databases for flat-file integration in our <a href="https://blogs.mulesoft.com/dev/mule-dev/using-in-memory-database-to-help-with-flat-file-integration/">MuleSoft Blog</a>.</p>
</li>
</ul>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../../_theme/scripts/menu.js"></script>
<script src="../../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
