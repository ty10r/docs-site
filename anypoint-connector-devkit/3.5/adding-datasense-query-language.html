<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/anypoint-connector-devkit/3.8/adding-datasense-query-language.html">
  <link rel="stylesheet" href="../../_theme/stylesheets/theme.css">
  <title>Adding DataSense Query Language // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="index.html">Anypoint Connector DevKit</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="index.html">Anypoint Connector DevKit</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="setup.html">Setup</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="setting-up-your-dev-environment.html">Setting Up Your Development Environment</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="setting-up-your-api-access.html">Setting up your API access</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-an-anypoint-connector-project.html">Creating an Anypoint Connector Project</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-an-anypoint-connector-project.html">Creating an Anypoint Connector Project</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="authentication.html">Authentication</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="basic-auth.html">Basic Auth</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="oauth-v1.html">OAuth V1</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="oauth-v2.html">OAuth V2</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="authentication-methods.html">Authentication Method</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="defining-attributes-operations-and-data-model.html">Defining Attributes Operations and Data Model</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-message-sources.html">Defining Message Sources</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-message-processors.html">Creating Message Processors</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-connector-attributes.html">Defining Connector Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="complex-data-types-attributes.html">Complex Data Types Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-datasense.html">Adding DataSense</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-datasense-query-language.html">Adding DataSense Query Language</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-query-pagination-support.html">Adding Query Pagination Support</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="building-a-batch-enabled-connector.html">Building a Batch Enabled Connector</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="installing-and-testing-your-connector-in-studio.html">Installing and Testing Your Connector</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="developing-devkit-connector-tests.html">Developing DevKit Connector Tests</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="creating-reference-documentation.html">Creating Reference Documentation</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="packaging-your-connector-for-release.html">Packaging Your Connector for Release</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="implementing-a-rest-connector.html">Implementing a REST Connector</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="annotation-reference.html">Annotation Reference</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="anypoint-connector-examples.html">Anypoint Connector Examples</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="barn-connector.html">Barn Connector</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-a-connector-using-a-java-client-library.html">Creating a Connector Using a Java Client Library</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-a-connector-for-a-soap-service-via-cxf-client.html">Creating a Connector for a SOAP Service Via CXF Client</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-a-connector-for-a-restful-api-using-jersey.html">Creating a Connector for a RESTful API Using Jersey</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-a-connector-for-a-restful-api-using-restcall-annotations.html">Creating a Connector for a RESTful API using @RESTCall Annotations</a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">Adding DataSense Query Language</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/anypoint-connector-devkit-docs/edit/v3.5/modules/ROOT/content/adding-datasense-query-language.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>Adding DataSense Query Language</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Many SaaS applications either implement a proper query language (such as SOQL, Salesforce Object Query Language) or support selecting resources through their API in a way that corresponds to querying. DataSense Query Language (DSQL) provides a uniform query language that can be used to query data in any application with a compatible Anypoint&#8482; Connector.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/6-package.png" alt="6 package">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can find the source code for the example below <a href="https://github.com/mulesoft/example-connector/tree/basic-dsql">here</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assumption"><a class="anchor" href="#assumption"></a>Assumption</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>You have familiarity with Anypoint Connectors, <a href="../../mule-runtime/3.5/datasense.html">DataSense</a>, <a href="../../mule-runtime/3.5/datasense-query-editor.html">DataSense Query Editor</a>, and <a href="#">Adding DataSense Query Language</a> from a user level.</p>
</li>
<li>
<p>You have experience with implementing a basic connector with <a href="index.html">Anypoint DevKit</a>.</p>
</li>
<li>
<p>You have an understanding of the visitor pattern fundamental to the workings of DSQL-to-native-query language translation.</p>
<div class="paragraph">
<p>Read more:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://java.dzone.com/articles/design-patterns-visitor">Design Patterns Uncovered: the Visitor Pattern</a></p>
</li>
<li>
<p>Wikipedia&#8217;s <a href="http://en.wikipedia.org/wiki/Visitor_pattern">Visitor pattern</a> article</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enabling-dsql-on-your-connector"><a class="anchor" href="#enabling-dsql-on-your-connector"></a>Enabling DSQL on Your Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to have DSQL enabled on your connector, you must do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="adding-datasense.html">Enable DataSense</a> (including <code>@MetaDataKeyRetriever</code> and <code>@MetaDataRetriever</code> annotated methods).</p>
</li>
<li>
<p>Create a new method, annotated with <code>@QueryTranslator</code>, responsible for doing the translation. This method must receive an <code>org.mule.common.query.DsqlQuery</code> object as its input.</p>
</li>
<li>
<p>Annotate a parameter with <code>@Query</code>, where users will input their DSQL statements.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The last two items on this list are explained below in this document.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="familiarizing-yourself-with-dsql-structure"><a class="anchor" href="#familiarizing-yourself-with-dsql-structure"></a>Familiarizing Yourself with DSQL Structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Out of the standard SQL operations (Select, Delete, Update, Insert) the only one supported in DSQL is SELECT.</p>
</div>
<div class="paragraph">
<p>Every DSQL statement must follow the structure below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">SELECT [selectedFieldName, ]
FROM [Type]
WHERE ( [ fieldName OPERATION value, AND ] )
{ ORDER BY [fieldName, ] { DESC | ASC } }
{ OFFSET [offset_number] }
{ LIMIT [max_number_total_of_items_in_query] }

-- KEY:
-- {} Optional value
-- [] Dynamic value
-- [, ] Dynamic list of values</code></pre>
</div>
</div>
<div class="paragraph">
<p>Consider the DSQL query example from the <a href="#">Adding DataSense Query Language</a> documentation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">SELECT AccountID,FirstName,Lastname
FROM Contact
WHERE (AccountID &gt; '500' AND IsDeleted = false) OR Employee_Current = false
ORDER BY LastName
OFFSET 250
LIMIT 1000</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mule uses an internal query model to represent the different semantics elements that make up a query:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Object</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SELECT AccountID, FirstName, LastName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A list of Fields. Each field represents metadata - field name and datatype.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FROM Contact</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An object exposed by the application. This is always a List of exactly one Type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filter expression</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WHERE (AccountID &gt; '500' AND IsDeleted = false) OR Employee_Current = false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Boolean condition defined over the fields on the object type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of sort order fields</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ORDER BY LastName</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Offset</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>OFFSET 250</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of items to skip from the beginning of the result set. Used for paging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LIMIT 100</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of items to include in the result set. Used for paging.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Similarly, the filter expression is represented internally by a set of field names, data literals, delimiters, operators for comparison, and grouping, etc.</p>
</div>
<div class="paragraph">
<p>More details about the query model and accessing it from your code emerge as you build out your new native query language translator that transform the query model into a query language.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="translating-from-a-dsql-structure"><a class="anchor" href="#translating-from-a-dsql-structure"></a>Translating From a DSQL Structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first step is to create a new method on your <code>@Connector</code>, annotated with <code>@QueryTranslator</code>. This method will receive a DSQL query (an <code>org.mule.common.query.DsqlQuery</code> object) as its input.</p>
</div>
<div class="paragraph">
<p>To easily do this translation, there are a set of visitor classes you can take great advantage of.</p>
</div>
<div class="sect2">
<h3 id="visitor-classes-and-query-languages"><a class="anchor" href="#visitor-classes-and-query-languages"></a>Visitor Classes and Query Languages</h3>
<div class="paragraph">
<p>A set of visitor classes implements the mapping between query model elements and specific query language syntax - classes that implement the <a href="http://java.dzone.com/articles/design-patterns-visitor">Visitor design pattern</a>, traverse the query model, and generate corresponding statements in the needed native query language.</p>
</div>
<div class="paragraph">
<p>Package <code>org.mule.common.query</code> defines Visitor interfaces that represent different parts of the DSQL query language, then provides default implementations of those Visitors that implement DSQL syntax.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Visitor Interface</th>
<th class="tableblock halign-left valign-top">Implementation Classes</th>
<th class="tableblock halign-center valign-top">Syntax Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QueryVisitor</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="https://github.com/mulesoft/mule-common/tree/3.x/src/main/java/org/mule/common/query/DefaultQueryVisitor.java">DefaultQueryVisitor</a></p>
</div>
<div class="paragraph">
<p><a href="https://github.com/mulesoft/mule-common/blob/c66595981f02fbed7b357d93010c84a0cacf704e/src/main/java/org/mule/common/query/DsqlQueryVisitor.java">DSQLQueryVisitor</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>"Beginning of an expression"</p>
<div class="paragraph">
<p>(i.e. the word "WHERE" before a filter expression)</p>
</div>
</li>
<li>
<p>Field lists</p>
</li>
<li>
<p>Types</p>
</li>
<li>
<p>Limit and Offset clauses</p>
</li>
<li>
<p>Precedence operators</p>
</li>
<li>
<p>Order By fields</p>
</li>
<li>
<p>Comparisons</p>
</li>
<li>
<p>Boolean operators</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OperatorVisitor</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><a href="https://github.com/mulesoft/mule-common/blob/c66595981f02fbed7b357d93010c84a0cacf704e/src/main/java/org/mule/common/query/DefaultOperatorVisitor.java">DefaultOperatorVisitor</a></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>Specific comparison operators</p>
<div class="paragraph">
<p>(equals, not-equals, greater/less than/ LIKE, etc)</p>
</div>
</li>
</ul>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To implement support for a new query language, define classes that extend DefaultQueryVisitor and DefaultOperatorVisitor and use them to construct native query language statements from the query model. You can name your new classes MyAppQueryVisitor and MyAppOperatorVisitor. The following sections describe how to construct them.</p>
</div>
</div>
<div class="sect2">
<h3 id="implementing-your-operation-visitor-class"><a class="anchor" href="#implementing-your-operation-visitor-class"></a>Implementing Your Operation Visitor Class</h3>
<div class="paragraph">
<p>Creating a new operator visitor class lets you define the comparison operator syntax (including LIKE) for your native query language.</p>
</div>
<div class="paragraph">
<p>Define a new class in your connector that extends <a href="https://github.com/mulesoft/mule-common/blob/c66595981f02fbed7b357d93010c84a0cacf704e/src/main/java/org/mule/common/query/DefaultOperatorVisitor.java">DefaultOperatorVisitor</a>, which implements all the DSQL comparison operator</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top">Class DefaultOperatorVistor</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class DefaultOperatorVisitor implements OperatorVisitor {
    public static final String LIKE = " like ";
    public static final String GREATER_OR_EQUALS = " &gt;= ";
    public static final String NOT_EQUALS = " &lt;&gt; ";
    public static final String EQUALS = " = ";
    public static final String LESS_OR_EQUALS = " &lt;= ";
    public static final String GREATER = " &gt; ";
    public static final String LESS = " &lt; ";
    @Override public String lessOperator() {
        return LESS;
    }
    @Override public String greaterOperator() {
        return GREATER;
    }
    @Override public String lessOrEqualsOperator() {
        return LESS_OR_EQUALS;
    }
    @Override public String equalsOperator() {
        return EQUALS;
    }
    @Override public String notEqualsOperator() {
        return NOT_EQUALS;
    }
    @Override public String greaterOrEqualsOperator() {
        return GREATER_OR_EQUALS;
    }
    @Override public String likeOperator() {
        return LIKE;
    }
}</code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Most languages will mostly use similar operators. To implement operations in your own language, the shortest path is to create a new class that extends <code>DefaultOperatorVisitor</code>, and then override the methods that return those operators where your language differs from DSQL.</p>
</div>
<div class="paragraph">
<p>For example, in the Salesforce.com connector, class <code>SfdcOperatorVisitor</code> overrides <code>notEqualsOperator()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.mule.common.query.DefaultOperatorVisitor;


public class SfdcOperatorVisitor extends DefaultOperatorVisitor {
 @Override public java.lang.String notEqualsOperator() {
        return " != ";
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because the rest of the operators are the same SOQL and DSQL, there are no other changes needed.</p>
</div>
</div>
<div class="sect2">
<h3 id="implementing-your-query-visitor-class"><a class="anchor" href="#implementing-your-query-visitor-class"></a>Implementing Your Query Visitor Class</h3>
<div class="paragraph">
<p>Creating a new query visitor class lets you define the query syntax for expressing the core query model constructs in your native query language.</p>
</div>
<div class="paragraph">
<p>In order to do so, create a new class in your connector project that extends <a href="https://github.com/mulesoft/mule-common/tree/3.x/src/main/java/org/mule/common/query/DefaultQueryVisitor.java">DefaultQueryVisitor</a> class.</p>
</div>
<div class="paragraph">
<p>Suppose that your service uses the following syntax:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">S [selectedFieldName, ]
F [Type]
W ( [ fieldName OPERATION value, &amp; ] )</code></pre>
</div>
</div>
<div class="paragraph">
<p>Below is an example of a visitor made for translating DSQL into a syntax that is show above:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">public class SimpleSyntaxVisitor extends DefaultQueryVisitor {

    private StringBuilder stringBuilder;

    public SimpleSyntaxVisitor()
    {
        stringBuilder = new StringBuilder();
    }

    @Override
    public void visitFields(java.util.List&lt;org.mule.common.query.Field&gt; fields) {
        StringBuilder select = new StringBuilder();
        select.append("S ");
        Iterator&lt;Field&gt; fieldIterable = fields.iterator();
        while (fieldIterable.hasNext())
        {
            String fieldName = addQuotesIfNeeded(fieldIterable.next().getName());
            select.append(fieldName);
            if (fieldIterable.hasNext())
            {
                select.append(",");
            }
        }

        stringBuilder.insert(0, select);
    }

    @Override
    public void visitTypes(List&lt;Type&gt; types)
    {
        stringBuilder.append(" F ");
        Iterator&lt;Type&gt; typeIterator = types.iterator();
        while (typeIterator.hasNext())
        {
            String typeName = addQuotesIfNeeded(typeIterator.next().getName());
            stringBuilder.append(typeName);
            if (typeIterator.hasNext())
            {
                stringBuilder.append(",");
            }
        }
    }

    //(...)


    @Override
    public void visitBeginExpression()
    {
        stringBuilder.append(" W ");
    }


    public String toSimpleQuery()
    {
        return stringBuilder.toString();
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For a complete connector that includes this functionality, view the <a href="https://github.com/mulesoft/example-connector/tree/basic-dsql">GitHub Repo</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="adding-your-query-visitor-into-you-querytranslator-method"><a class="anchor" href="#adding-your-query-visitor-into-you-querytranslator-method"></a>Adding Your Query Visitor into you @QueryTranslator Method</h3>
<div class="paragraph">
<p>In your <code>@Connector</code> class, implement a method annotated with <code>@QueryTranslator</code> that instances the visitor class and calls the method that returns your query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@QueryTranslator
public String toNativeQuery(DsqlQuery query){
    SimpleSyntaxVisitor visitor = new SimpleSyntaxVisitor();
    query.accept(visitor);
    return visitor.dsqlQuery();
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="how-users-of-your-connector-will-see-dsql"><a class="anchor" href="#how-users-of-your-connector-will-see-dsql"></a>How Users of your Connector Will See DSQL</h3>
<div class="paragraph">
<p>After you have built you connector and installed it in Studio, it will be available for use in Mule projects. Add it to a flow, and open its property editor:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/qb2.png" alt="qb2">
</div>
</div>
<div class="paragraph">
<p>You can select a language for your query, in this case, you can choose between the service&#8217;s Native Query Language or DSQL. When having DSQL selected, you can use the <strong>Query Builder tool</strong> to automatically generate a query by simply selecting amongst the existing fields.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/query-builder.png" alt="query+builder">
</div>
</div>
<div class="paragraph">
<p>The query you build here will be populated into the connector&#8217;s "Query Text" field. You are also free to edit the text in this field once again.</p>
</div>
<div class="paragraph">
<p>Once you have created a Query in DSQL, you can change the query language to the service&#8217;s Native Query Language to verify that the translation is being correctly executed:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/qb3.png" alt="qb3">
</div>
</div>
<div class="paragraph">
<p>Thanks to DataSense, if you include a DataMapper element after your connector, DataMapper will interpret your query and only present the fields that are returned by it:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/dm.png" alt="dm">
</div>
</div>
<div class="paragraph">
<p>In this case, DataMapper knows that it will deal with a list of Authors that only have a <code>firstName</code> field.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>See Also</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>NEXT</strong>: Add support for <a href="adding-query-pagination-support.html">pagination</a> to your query operation.</p>
</li>
<li>
<p>Learn how to add <a href="developing-devkit-connector-tests.html">tests</a> to your Connector.</p>
</li>
<li>
<p>Generate the <a href="creating-reference-documentation.html">Reference Documentation</a>.</p>
</li>
</ul>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../_theme/scripts/menu.js"></script>
<script src="../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
