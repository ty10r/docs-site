<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="devkit, connection, authentication, annotations, test connectivity, pooling, disconnect, validate, identify, reconnect on">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/anypoint-connector-devkit/3.8/connection-management.html">
  <link rel="stylesheet" href="../../_theme/stylesheets/theme.css">
  <title>Connection Management // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="index.html">Anypoint Connector DevKit</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="anypoint-connector-development.html">Anypoint Connector Development</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="setting-up-your-dev-environment.html">Setting Up Your Development Environment</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="creating-an-anypoint-connector-project.html">Creating an Anypoint Connector Project</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="implementing-a-rest-connector.html">Implementing a REST Connector</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="connector-project-structure.html">Connector Project Structure</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="setting-up-api-access.html">Setting Up API Access</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="authentication.html">Authentication</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="authentication-methods.html">Authentication Method</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="connector-connection-strategies.html">Connector Connection Strategies</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="connection-management.html">Connection Management</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="oauth-v1.html">OAuth V1</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="oauth-v2.html">OAuth V2</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="http-basic-authentication.html">HTTP Basic Authentication</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="no-authentication.html">No Authentication</a>
                                      </li>
                                  </ul>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="defining-attributes-operations-and-data-model.html">Defining Attributes Operations and Data Model</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-message-sources.html">Defining Message Sources</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-message-processors.html">Creating Message Processors</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-connector-attributes.html">Defining Connector Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="complex-data-types-attributes.html">Complex Data Types Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-datasense.html">Adding DataSense</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-datasense-query-language.html">Adding DataSense Query Language</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-query-pagination-support.html">Adding Query Pagination Support</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="building-a-batch-enabled-connector.html">Building a Batch Enabled Connector</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="shading-libraries.html">Shading Libraries</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="developing-devkit-connector-tests.html">Developing DevKit Connector Tests</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-testing-framework.html">Connector Testing Framework</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="installing-and-testing-your-connector-in-studio.html">Installing and Testing Your Connector in Studio</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="connector-reference-documentation.html">Connector Reference Documentation</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="packaging-your-connector-for-release.html">Packaging Your Connector for Release</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="anypoint-connector-examples.html">Anypoint Connector Examples</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="tutorial-barn-connector.html">Tutorial - Barn Connector</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-a-connector-using-a-java-sdk.html">Creating a Connector Using a Java SDK</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-a-connector-for-a-soap-service-via-cxf-client.html">Creating a Connector for a SOAP Service Via CXF Client</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-a-connector-for-a-restful-api-using-restcall-annotations.html">Creating a Connector for a RESTful API using @RestCall Annotations</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="annotation-reference.html">Annotation Reference</a>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">Connection Management</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/anypoint-connector-devkit-docs/edit/v3.6/modules/ROOT/content/connection-management.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>Connection Management</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Connection Management framework provides multi-tenancy capabilities for a connector (managing multiple simultaneous connections with different credentials for each connector within your application), as well as connection pooling and instance pooling. These benefits are available for most authentication schemes other than OAuth, and for APIs that do not require authentication. Basic Authentication is designated in a connector with the @ConnectionManagement attribute.</p>
</div>
<div class="paragraph">
<p>This document describes the Connection Management framework, the Java annotations through which it is exposed, and how to implement Basic Authentication support in your connector to authenticate with your service. Examples in this discussion show the use of Basic Authentication with basic username and password authentication (most common), but they can easily be generalized to other non-OAuth protocols such as SAML, Kerberos, LDAP, NTLM, or to create a custom connection.</p>
</div>
<div class="paragraph">
<p>For OAuth-based authentication DevKit provides functionality using OAuth-related annotations. See <a href="oauth-v1.html">OAuth V1</a> and <a href="oauth-v2.html">OAuth V2</a> for details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document assumes you are familiar with the <a href="index.html">Anypoint Connector DevKit</a>, have already <a href="creating-an-anypoint-connector-project.html">created a connector project</a>, and are ready to implement authentication on your connector. Further, it assumes you are familiar with the various <a href="authentication-methods.html">authentication methods</a>, have compared the different <a href="authentication.html">authentication support options in Devkit</a>, and chosen Basic Authentication to connect to your API.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about-connection-management"><a class="anchor" href="#about-connection-management"></a>About Connection Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Connection Management framework provides the following benefits with minimal effort on the part of the connector developer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Transparent multi-tenancy</strong> – A Mule application can open many connections to a single target using different credentials to connect on behalf of many users simultaneously.</p>
</li>
<li>
<p><strong>Connection pooling</strong> – Automated management of a pool of instances of the connector class to manage connection resources effectively.</p>
</li>
<li>
<p><strong>Exceptions</strong> - The ability to automatically invalidate connections on exceptions and to reconnect as needed.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="connection-management-framework-and-authentication-protocols"><a class="anchor" href="#connection-management-framework-and-authentication-protocols"></a>Connection Management Framework and Authentication Protocols</h3>
<div class="paragraph">
<p>You can use the Connection Management framework in conjunction with most authentication protocols, such as username and password authentication (most common), SAML, Kerberos, LDAP, and NTLM.</p>
</div>
<div class="paragraph">
<p>For OAuth-based authentication DevKit provides functionality using OAuth-related annotations. See <a href="oauth-v1.html">OAuth V1</a> and <a href="oauth-v2.html">OAuth V2</a> for details.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connection-management-annotation"><a class="anchor" href="#connection-management-annotation"></a>Connection Management Annotation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Anypoint DevKit makes it easy to add Connection Management functionality to connectors by creating a new <code>@ConnectionStrategy</code>, just create a new class and annotate it with <code>@ConnectionManagement</code>.</p>
</div>
<div class="paragraph">
<p>The following table describes the parameters for the <code>@ConnectionManagement</code> annotation.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Required?</th>
<th class="tableblock halign-left valign-top">Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><strong>friendlyName</strong></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the name that is going to be displayed in the connector configuration pop up.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><strong>configElementName</strong></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the name for the configuration that is going to be used in the Mule app.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">config</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="connection-management-devkit-annotations"><a class="anchor" href="#connection-management-devkit-annotations"></a>Connection Management DevKit Annotations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use Connection Management in a connector, define and annotate the following methods in the <code>@ConnectionManagement</code> annotated class:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@Connect</code> method - Creates a connection</p>
</li>
<li>
<p><code>@Disconnect</code> method - Explicitly closes a connection</p>
</li>
<li>
<p><code>@ValidateConnection</code> method - Returns true if a connection is still valid, false otherwise</p>
</li>
<li>
<p><code>@ConnectionIdentifier</code> method - Returns a prefix used in generating unique identifiers for connector instances in the connection pool</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The specific implementation of these methods depends on the target. For more information on annotations, see the <a href="annotation-reference.html">Annotation Reference</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ConnectionManagement(friendlyName="Connector Connection")
public class ConnectionManagementStrategy{
   @Connect
   @TestConnectivity
   public void connect(@ConnectionKey String username, @Password String password){
      ...
   }

   @Disconnect
   public void disconnect() {
       client = null;
   }

   @ValidateConnection
   public boolean isConnected() {
       return client != null;
   }

   @ConnectionIdentifier
   public String connectionId() {
       return client.toString();
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The methods are called automatically as needed by the DevKit framework; you never call them directly from your code.</p>
</div>
<div class="sect2">
<h3 id="adding-connectionmanagement-annotation-to-the-connector-class"><a class="anchor" href="#adding-connectionmanagement-annotation-to-the-connector-class"></a>Adding @ConnectionManagement Annotation to the @Connector Class</h3>
<div class="paragraph">
<p>Given the <code>@ConnectionManagement</code> class, this is the way to add it in the <code>@Connector</code> Class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Connector(name = "connector")
public class MyConnectorWithConnectionManagement
{
    @ConnectionStrategy
    private ConnectionManagementStrategy strategy;

    /**
    * Processors
    */
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ensure that strategy has a public getter and setter (not shown).</p>
</div>
</div>
<div class="sect2">
<h3 id="connect-method"><a class="anchor" href="#connect-method"></a>@Connect Method</h3>
<div class="paragraph">
<p>This method is responsible for creating a connection to the target. The <code>@Connect</code> method is called automatically by Mule when the connector starts up, or if the connection to the API has been lost and must be reestablished. When this method finishes, if authentication is successful, the connector instance is ready to make operations.</p>
</div>
<div class="paragraph">
<p>A method annotated with <code>@Connect</code> must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be public</p>
</li>
<li>
<p>Throw <code>org.mule.api.ConnectionException</code> (and no other exceptions)</p>
</li>
<li>
<p>Have a <code>void</code> return type</p>
</li>
<li>
<p>Annotate only one method with <code>@Connect</code></p>
</li>
<li>
<p>Annotate <code>@Connect</code> method with <code>@TestConnectivity</code></p>
</li>
<li>
<p>Annotate at least one parameter with <code>@ConnectionKey</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The specific code that implements the actual connection depends on the API. Here is an example implementation of a <code>@Connect</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Connect
@TestConnectivity
   public void connect(@ConnectionKey String username, @Password String password)
     throws ConnectionException {
        try{
           setClient(new SendGrid(username, password));
        }catch(Exception e){
           throw new ConnectionException(INCORRECT_CREDENTIALS,”” , e.getMessage());
        }
      }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameters required by this method are the credentials needed for authentication, in this case username and password. Since this method is annotated with <code>@Connect</code>, Anypoint DevKit makes these parameters available both in the configuration element for this connector (as occurs with <code>@Configurable</code> fields), as well as in the message processor whenever it is dragged into a flow. Specified credentials override those that are set in the configuration element.</p>
</div>
</div>
<div class="sect2">
<h3 id="testconnectivity"><a class="anchor" href="#testconnectivity"></a>@TestConnectivity</h3>
<div class="paragraph">
<p><code>@TestConnectivity</code> annotation displays a button in Anypoint Studio when configuring the Connector, this button allows the user to test if the connection is successful with his configuration.</p>
</div>
<div class="paragraph">
<p><code>@TestConnectivity</code> runs the <code>@Connect</code> method and expects an <code>org.mule.api.ConnectionException</code>, if this exception occurs, then the test fails, if not the connection is assumed successful.</p>
</div>
<div class="paragraph">
<p><code>@TestConnectivity</code> can be easily disabled by setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@TestConnectivity(active = false)</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="connectionkey-and-connection-pooling"><a class="anchor" href="#connectionkey-and-connection-pooling"></a>@ConnectionKey and Connection Pooling</h3>
<div class="paragraph">
<p>In the Example above, the username parameter in the <code>@Connect</code> method is annotated with <code>@ConnectionKey</code>. If pools are enabled, Mule keeps a pool of simultaneous connections which are used as needed to make calls.</p>
</div>
<div class="paragraph">
<p>The <code>@ConnectionKey</code> annotation marks that this field is used as the key for this particular connection within the connection pool, so once a connection for this username has been created and added to the pool, it is reused rather than recreated for each request.</p>
</div>
<div class="sect3">
<h4 id="choosing-a-connection-key"><a class="anchor" href="#choosing-a-connection-key"></a>Choosing a Connection Key</h4>
<div class="paragraph">
<p>For username and password authentication, the username is the obvious choice for <code>@ConnectionKey</code>. For other protocols, identify the value that is most obviously associated with different users and access privileges that connect to your service, and use this value as your <code>@ConnectionKey</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="disconnect-method"><a class="anchor" href="#disconnect-method"></a>@Disconnect Method</h3>
<div class="paragraph">
<p>This annotation indicates the method inside a <code>@ConnectionManagement</code> class that is responsible for disposal of a connection. This method is called when the connector is shut down or the connection is explicitly terminated.</p>
</div>
<div class="paragraph">
<p>A method annotated with <code>@Disconnect</code> must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be public</p>
</li>
<li>
<p>Take no input parameters</p>
</li>
<li>
<p>Have a <code>void</code> return type</p>
</li>
<li>
<p>The class must have exactly one annotated <code>@Disconnect</code> method</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Disconnect
public void disconnect()
{
   if (connection != null)
   {
     try
         {
         connection.logout();
         }
     catch (ConnectionException e)
         {
         e.printStackTrace();
         }
     finally
         {
         connection = null;
         }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the connector currently has a connection open, this code calls <code>connection.logout()</code>,  a client method that explicitly de-authenticates and closes the connection. The finally block ensures that, if the logout fails for any reason, the connection is still set to null, so the connector does not again try to reference that connector instance.</p>
</div>
</div>
<div class="sect2">
<h3 id="validateconnection-method"><a class="anchor" href="#validateconnection-method"></a>@ValidateConnection Method</h3>
<div class="paragraph">
<p>This method is called by Mule to check whether the connection is actually open or not.</p>
</div>
<div class="paragraph">
<p>A method annotated with <code>@ValidateConnection</code> must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be public</p>
</li>
<li>
<p>Take no input parameters</p>
</li>
<li>
<p>Return <code>boolean</code> or <code>java.lang.Boolean</code></p>
</li>
<li>
<p>Only one method on the class can be annotated with <code>@ValidateConnection</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ValidateConnection
public boolean isConnected()
{
    return connection != null;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, to determine whether the connection is active the code simply checks if the connection parameter is null. A different implementation may be required for other connectors, depending on the protocol.</p>
</div>
</div>
<div class="sect2">
<h3 id="connectionidentifier-method"><a class="anchor" href="#connectionidentifier-method"></a>@ConnectionIdentifier Method</h3>
<div class="paragraph">
<p>This annotation identifies a method inside the <code>@ConnectionManagement</code> class that returns a unique identifier for the connection, used for logging and debugging.</p>
</div>
<div class="paragraph">
<p>A method annotated with <code>@ConnectionIdentifier</code> must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be public</p>
</li>
<li>
<p>Not be static</p>
</li>
<li>
<p>Not take arguments</p>
</li>
<li>
<p>Return <code>java.lang.String</code></p>
</li>
<li>
<p>Annotate only one method with <code>@ConnectionIdentifier</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This code returns the connection SessionId as an identifier (if available). The SessionHeader object in this case contains header information about the current connection to the API, including the session ID.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ConnectionIdentifier
public String connectionId() {
if (connection != null){
    return connection.getSessionHeader().getSessionId();
    } else {
        return  null;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reconnecton-annotation"><a class="anchor" href="#reconnecton-annotation"></a>@ReconnectOn Annotation</h3>
<div class="paragraph">
<p>This annotation deprecates <code>@InvalidateConnectionOn</code> annotation. It now receives a list of exceptions instead of just a single exception, and can be used at both the class and processor levels.</p>
</div>
<div class="paragraph">
<p>This annotation is used for exception handling related to connections. It can be used at class level or at a method level. If the Connector or Processor throws an exception of this class, <code>@ReconnectOn</code> automatically invalidates the connection. <code>@ReconnectOn</code> receives a list containing the classes of the exceptions to be caught (see below for an example). When an exception occurs, the <code>@ReconnectOn</code> behavior is based on the configured reconnection strategy. See <a href="../3.8/connector-connection-strategies.html">Configuring Reconnection Strategies</a> for more details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Processor
@ReconnectOn(exceptions = {InvalidSessionFault.class, PasswordChangedException.class})
public void myOperation(@Optional String source,
                        @Optional Object destination) throws InvalidSessionFault, PasswordChangedException, InvalidParameterException
{
    /**
    * CODE FOR MY OPERATION
    */
}</code></pre>
</div>
</div>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../_theme/scripts/menu.js"></script>
<script src="../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
