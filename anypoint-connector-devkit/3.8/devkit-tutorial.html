<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="devkit tutorial, features, cookbook">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/anypoint-connector-devkit/3.8/devkit-tutorial.html">
  <link rel="stylesheet" href="../../_theme/stylesheets/theme.css">
  <title>Anypoint Connector DevKit Tutorial // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="index.html">Anypoint Connector DevKit</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="anypoint-connector-development.html">Getting Started with Anypoint Connector Development</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="setting-up-your-dev-environment.html">Setting Up Your Development Environment</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="devkit-tutorial.html">Anypoint Connector DevKit Tutorial</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-project-structure.html">Connector Project Structure</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="annotation-reference.html">DevKit Java Annotation Reference</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="creating-an-anypoint-connector-project.html">Creating an Anypoint Connector Project</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="setting-up-api-access.html">Setting up API Access</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-connection-strategies.html">Configuring Connection Strategies</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="authentication.html">Supporting Authentication</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="authentication-methods.html">Authentication Methods</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="oauth-v1.html">OAuth V1</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="oauth-v2.html">OAuth V2</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="http-basic-authentication.html">HTTP Basic Authentication</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="connection-management.html">Connection Management</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="no-authentication.html">No Authentication</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="creating-a-java-sdk-based-connector.html">Creating a Java SDK-Based Connector</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="creating-a-connector-using-a-java-sdk.html">Java SDK-Based Connector Example</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="creating-a-soap-connector.html">Creating a SOAP Connector</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="soap-connect-session-management.html">SOAP Session Management</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="creating-a-connector-for-a-soap-service-via-cxf-client.html">Creating a Connector for a SOAP Service Via CXF Client - Legacy</a>
                                      </li>
                                  </ul>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="connector-attributes-and-operations.html">Adding Connector Functionality</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-message-sources.html">Defining Message Sources</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-message-processors.html">Creating Message Processors</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-connector-attributes.html">Defining Connector Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="complex-data-types-attributes.html">Complex Data Types Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="mime-type-and-encoding.html">MIME Type and Encoding</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="extending-connector-functionality.html">Extending Connector Functionality</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-datasense.html">Adding DataSense</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="multiple-level-datasense-support.html">Multiple Level DataSense Support</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-datasense-query-language.html">Adding DataSense Query Language</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-query-pagination-support.html">Adding Query Pagination Support</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="building-a-batch-enabled-connector.html">Building a Batch Enabled Connector</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="shading-libraries.html">Shading Libraries</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-libraries.html">Adding Libraries or JARs to Connector Build</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="developing-devkit-connector-tests.html">Developing DevKit Connector Tests</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-testing-framework.html">Connector Testing Framework</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="installing-and-testing-your-connector-in-studio.html">Installing and Testing Your Connector in Studio</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="connector-reference-documentation.html">Creating Connector Reference Documentation</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="packaging-your-connector-for-release.html">Packaging Your Connector for Release</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="connector-certification-program-guidelines.html">Connector Certification Program Guidelines</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="certified-connector-license-management.html">MuleSoft Certified Connector License Management</a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">Anypoint Connector DevKit Tutorial</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/anypoint-connector-devkit-docs/edit/v3.8/modules/ROOT/content/devkit-tutorial.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>Anypoint Connector DevKit Tutorial</h1>
    <div class="sect1">
<h2 id="tutorial-goals"><a class="anchor" href="#tutorial-goals"></a>Tutorial Goals</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Learn how to create a connector to a web service using the Anypoint Connector DevKit.</p>
</div>
<div class="paragraph">
<p>DevKit helps you build <a href="../../mule-runtime/3.8/connectors/anypoint-connectors.html">Anypoint Connectors</a>. This tutorial shows you how to code a connector to support authentication, connections, service operations and more. This is functionality that you as the connector developer expose to the end user of the connector, who is the Mule application developer.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-the-anypoint-connector-devkit"><a class="anchor" href="#what-is-the-anypoint-connector-devkit"></a>What is the Anypoint Connector DevKit?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="index.html">Anypoint Connector DevKit</a> is an essential development tool in the Anypoint Platform that makes coding Anypoint Connectors easier. DevKit is a Maven-based tool that lets you build reusable components that can be run as part of a Mule application, and can be easily configured from <a href="http://www.mulesoft.com/platform/mule-studio">Anypoint Studio</a>.</p>
</div>
<div class="paragraph">
<p>DevKit exposes connector developers to <a href="http://docs.oracle.com/javase/tutorial/java/annotations/">Java annotations</a> that generate code and files to interact with Mule runtime, as well as Anypoint Studio. The generated code provides the interface between the connector and Mule that would otherwise require each connector developer to include extensive boilerplate code, as well as the code and files required to interact with your connector in Anypoint Studio.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="what-is-a-connector"><a class="anchor" href="#what-is-a-connector"></a>What is a Connector?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An Anypoint Connector is a reusable component that interacts with Mule runtime and Anypoint Studio. A connector communicates with a target resource and conveys information between a resource and Mule, and transforms the data into a Mule message.</p>
</div>
<div class="paragraph">
<p>Anypoint Connector DevKit abstracts the communication that happens between Mule and the external service or API, and generates a user interface to help simplify usage of the connector by the developer who would eventually use it in their application.</p>
</div>
<div class="paragraph">
<p>A well-developed connector makes Mule app development much simpler for users when handling tasks like pagination, session expirations, and input and output metadata. This tutorial shows you how to create a well-designed connector.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="why-build-a-connector-using-devkit"><a class="anchor" href="#why-build-a-connector-using-devkit"></a>Why Build a Connector Using DevKit?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here is why you might want to build your own connector:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You need to consume an API from a Mule application and you want to make sure your developers maintain consistency by employing the same connector.</p>
</li>
<li>
<p>You have an API and want to add strategic value to your business by providing developers with a connector that provides an interface into your web service.</p>
</li>
<li>
<p>You want to facilitate integration with SaaS and on-premises Web services, applications, and data sources.</p>
</li>
<li>
<p>The API you consume supports Pagination, Batch, and/or has a SQL capability.</p>
</li>
<li>
<p>The API you consume has different entity types and/or its structure changes depending on API/service operation.</p>
</li>
<li>
<p>You want to extend Mule core.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before developing a connector you should have a working knowledge of <a href="../../solutions/getting-started/index.html">Mule</a>, <a href="../../anypoint-studio/6/download-and-launch-anypoint-studio.html">Anypoint Studio</a>, and Java development in general, specifically the use of <a href="https://docs.oracle.com/javase/tutorial/java/annotations/basics.html">Java annotations</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For information on software setup and DevKit, see <a href="setting-up-your-dev-environment.html">Setting Up Your Development Environment</a> and <a href="index.html">Anypoint Connector DevKit</a>.</p>
</div>
<div class="paragraph">
<p><strong>You can develop a connector on a Windows, Mac, or Linux machine.</strong></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="get-cookbook"><a class="anchor" href="#get-cookbook"></a>Get the Cookbook</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Get the cookbook tutorial, which is stored on GitHub:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Clone the <a href="https://github.com/mulesoft/mule-cookbook">https://github.com/mulesoft/mule-cookbook</a> repository into your local machine. For example, to clone to your desired development folder, run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">cd ~/dev
git clone https://github.com/mulesoft/mule-cookbook.git</code></pre>
</div>
</div>
</li>
<li>
<p>Enter your newly created <code>mule-cookbook</code> directory and run the following Maven command:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">mvn install eclipse:eclipse</code></pre>
</div>
</div>
</li>
<li>
<p>When done, open Anypoint Studio, import the <code>mule-cookbook</code> directory as an existing project. <strong>File</strong> &gt; <strong>Import</strong> &gt; <strong>Existing Projects into Workspace</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/devkit-tutorial-30756.png" alt="import existing - mule-cookbook">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This should create the several folders you see on the above screen in your workspace in Studio, which is visible in the <strong>Package Explorer</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cookbook-description"><a class="anchor" href="#cookbook-description"></a>Cookbook Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we move on, let us briefly mention that the Cookbook service is a web service that helps users organize ingredients and recipes they might like to access, store or update from the web.</p>
</div>
<div class="sect2">
<h3 id="cookbook-api-description"><a class="anchor" href="#cookbook-api-description"></a>Cookbook API Description</h3>
<div class="paragraph">
<p>This API allows users to use the create, read, update, and delete (CRUD) operations for single and multiple recipes and ingredients. The API also allows you to view recently added recipes.</p>
</div>
<div class="paragraph">
<p>The API is exposed as a:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SOAP Service using a  <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/resources/wsdl/IMuleCookBookService.wsdl">WSDL</a> file</p>
</li>
<li>
<p>REST API with a <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/api.raml">RAML</a> file, and</p>
</li>
<li>
<p>a Java <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/IMuleCookBookClient.java">SDK</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="authentication"><a class="anchor" href="#authentication"></a>Authentication</h3>
<div class="paragraph">
<p>This connector supports the following authentication mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Custom authentication with a username and password that provides a token to send with each request as part of the request.</p>
</li>
<li>
<p><a href="http://oauth.net/2/">OAuthV2</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="credentials"><a class="anchor" href="#credentials"></a>Credentials</h4>
<div class="sect4">
<h5 id="custom-authentication"><a class="anchor" href="#custom-authentication"></a>Custom Authentication:</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Username</th>
<th class="tableblock halign-left valign-top">Password</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">admin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">admin</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="oauth"><a class="anchor" href="#oauth"></a>OAuth:</h5>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Client ID</th>
<th class="tableblock halign-left valign-top">Client Secret</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ePU9CxyEVFIXF9nMoGH16s1lUGe5JYPPzClnnVBG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">YeKAsQCdr264tNmDdvTdJUAh9TQraJqZpwbEoTuz</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="connecting-to-service"><a class="anchor" href="#connecting-to-service"></a>Connecting to the Service</h3>
<div class="paragraph">
<p>The web service is available online.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To consume the SOAP version and the SDK just make the request to the address: <code>http://devkit-cookbook.cloudhub.io/soap</code></p>
</li>
<li>
<p>The rest base url is <code>http://devkit-cookbook.cloudhub.io/rest</code></p>
<div class="ulist">
<ul>
<li>
<p>The OAuth Authorize url is <strong>/oauth/authorize</strong></p>
</li>
<li>
<p>The Access Token url is <strong>/oauth/accessToken</strong></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can also run it locally since we provide the source code for the servers already ready to start.</p>
</div>
<div class="paragraph">
<p>The local SOAP Server can be run from the soap-server project by simply executing the com.cookbook.tutorial.service.MuleStoreServer class.</p>
</div>
<div class="paragraph">
<p>By default it starts the server at address <code>http://localhost:9090/cook-book</code></p>
</div>
<div class="paragraph">
<p>The local REST Server can be run from the rest-server project by simply executing the com.cookbook.tutorial.Main class.</p>
</div>
<div class="paragraph">
<p>By default it starts the server at address <code>http://localhost/9091</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="steps-to-build-the-cookbook-connector"><a class="anchor" href="#steps-to-build-the-cookbook-connector"></a>Steps to Build the Cookbook Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To build a basic connector for the Cookbook service, we need to perform the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a Connector Project.</p>
</li>
<li>
<p>Add the dependency that contains the client we will use to connect to the service.</p>
</li>
<li>
<p>Add a configurable URL so that users can specify the URL where the service is hosted.</p>
</li>
<li>
<p>Add an operation that users can consume in Anypoint Studio.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="create-the-cookbook-connector"><a class="anchor" href="#create-the-cookbook-connector"></a>Create the Cookbook Connector</h3>
<div class="paragraph">
<p>With the <code>mule-cookbook</code> directory imported as an existing project into your workspace as instructed <a href="#get-cookbook">above</a>, you can begin to create the connector project and start coding.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In Anypoint Studio, click <strong>File</strong> &gt; <strong>New</strong> &gt; <strong>Anypoint Connector Project</strong> or right-click your project name in Package Explorer and click <strong>New</strong> &gt; <strong>Anypoint Connector Project</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new-connector-1.png" alt="new connector 1" width="500">
</div>
</div>
</li>
<li>
<p>Select the project type you want to create. In this case, select <strong>SDK Based</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new0.png" alt="new0" width="500">
</div>
</div>
</li>
<li>
<p>Specify the name of your connector and don&#8217;t forget to uncheck the default generation before clicking <strong>Finish</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new1.png" alt="new1" width="550">
</div>
</div>
<div class="paragraph">
<p>This generates a project containing the structure and all required elements including a skeleton connector, icons, sample docs file, but no basic tests for your connector.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/new-connector-3.png" alt="new connector 3" width="new-connector-3">
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can enable the DevKit view by clicking from the top bar <strong>Window</strong> &gt; <strong>Show View</strong> &gt; <strong>Other</strong>, and look for DevKit in the <strong>MuleSoft</strong> dropdown.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/enable-view.png" alt="enable view" width="300">
</div>
<div class="title">Figure 1. DevKit View shows a compact view of the connector.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-config"><a class="anchor" href="#using-config"></a>Connection Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When consuming a service, you may need to configure different values to establish a connection.</p>
</div>
<div class="paragraph">
<p>To facilitate developing connection configuration strategies, DevKit provides a pair of annotations that let you modularize these definitions inside several classes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The behavior you expose to users, using the <code>@Connector</code> annotation.</p>
</li>
<li>
<p>Code related to the connection configuration is injected where you add the <code>@Config</code> annotation. There are several types of configuration you can use as we will see in this tutorial.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you mark a class with <code>@Config</code>, DevKit ensures that you have an initialized object set when the Mule app runs and that requests are made to your connector.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="add-dependencies-in-pom-xml"><a class="anchor" href="#add-dependencies-in-pom-xml"></a>Add Dependencies in pom.xml</h3>
<div class="paragraph">
<p>Let&#8217;s start coding by creating a connector that allows you to get the recently added items from the Cookbook service.</p>
</div>
<div class="paragraph">
<p>Since we don&#8217;t need any kind of authentication to consume the recently added recipes, this is the best operation we can use to start learning how to build our connector.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add our client dependency so that we can use it in our connector. This way we can use the Java API to connect to the Cookbook.</p>
<div class="paragraph">
<p>In your pom.xml file add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;org.mule.modules&lt;/groupId&gt;
    &lt;artifactId&gt;sdk-client&lt;/artifactId&gt;
    &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="adding-code-to-support-configurable-fields"><a class="anchor" href="#adding-code-to-support-configurable-fields"></a>Adding Code to Support Configurable Fields</h3>
<div class="paragraph">
<p>In the <code>ConnectorConfig.java</code> file add the @Configurable annotation for the address where the Cookbook service is hosted:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Type <strong>conf</strong> at the editor of your connector config and use <code>control</code> + <code>space</code> to display the templates.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/config-field.png" alt="config field" width="600">
</div>
</div>
</li>
<li>
<p>Define a configurable field inside the <code>@Configuration</code>-annotated class with a default value for the endpoint our client connects to, for example, <code>@Default("http://devkit-cookbook.cloudhub.io/soap")</code></p>
</li>
<li>
<p>Any field marked with the <code>@Configurable</code> annotation must have a getter and a setter for that field.</p>
<div class="paragraph">
<p>See full <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v1/ConnectorConfig.java">Config</a> source code.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="initialize-the-client"><a class="anchor" href="#initialize-the-client"></a>Initialize the Client</h3>
<div class="paragraph">
<p>In your <code>@Connector</code>-annotated class in the <code>Connector.java</code> file use the <code>@Start</code> annotation on a method to initialize the client.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.lifecycle.Start;
import org.mule.modules.cookbook.config.ConnectorConfig;

import com.cookbook.tutorial.client.MuleCookBookClient;
import com.cookbook.tutorial.service.Recipe;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
public class CookbookConnector {

	@Config
	ConnectorConfig config;

	private MuleCookBookClient client;

	@Start
	public void initialize() {
		client = new MuleCookBookClient(config.getAddress());
	}

	/**
	 * Returns the list of recently added recipes
	 *
	 * {@sample.xml ../../../doc/cookbook-connector.xml.sample
	 * cook-book:getRecentlyAdded}
	 *
	 * @return A list of the recently added recipes
	 */
	@Processor
	public List&lt;Recipe&gt; getRecentlyAdded() {
		return client.getRecentlyAdded();
	}

	public ConnectorConfig getConfig() {
		return config;
	}

	public void setConfig(ConnectorConfig config) {
		this.config = config;
	}

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Anypoint Connectors are made to be fully aware of Mule runtime&#8217;s lifecycle without implementing any Mule-specific interface.</p>
</div>
<div class="paragraph">
<p>There is an annotation method for each of the four phases of the lifecycle.</p>
</div>
<div class="paragraph">
<p>When a method is annotated with one of these annotations, DevKit invokes it during the lifecycle phase that the annotation represents.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="processor"><a class="anchor" href="#processor"></a>Adding @Processor Methods</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Remove the dummy <code>@Processor</code> operation from the <code>Connector.java</code> file.</p>
</li>
<li>
<p>To add a processor simply type <code>proc</code> in the Studio code editor and use <code>ctrl</code> + <code>space</code> to display the templates and pick the simple processor.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/processor1.png" alt="processor1" width="600">
</div>
</div>
</li>
<li>
<p>Change it to reflect the <code>getRecentlyAdded</code> method signature (see example implementation <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v1/CookbookConnector.java#L46">here</a>), and at this point you have the code in place to build your first connector, which should then be ready for testing.</p>
</li>
<li>
<p>Run the <a href="creating-a-java-sdk-based-connector.html#generating-sources">Generate Sources</a> Action.</p>
<div class="paragraph">
<p>See full <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v1/CookbookConnector.java">Connector</a> source code.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Resolve any package import errors by right-clicking your connector project in the Package Explorer of Studio. <strong>Build Path</strong> &gt; <strong>Add External Archives</strong>. Add the applicable .jar files, for example, so your project can reference the cookbook <code>sdk-client</code>. This should stop any import errors on:
<code>import com.cookbook.tutorial.client.MuleCookBookClient;</code>
<code>import com.cookbook.tutorial.service.Recipe;</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can check references in the properties for your project.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/devkit-tutorial-af283.png" alt="properties for cookbook connector project">
</div>
</div>
<div class="paragraph">
<p>At this point you can <a href="#install-guide">install</a> this Connector and try it in Studio if you want.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As you modify your connector, you may start seeing error markers on the generated folder.</p>
</div>
<div class="paragraph">
<p>Just ignore them.</p>
</div>
<div class="paragraph">
<p>Once you regenerate the sources, the errors will go away as the generated code will be refreshed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="defining-example-code-for-connector-processors"><a class="anchor" href="#defining-example-code-for-connector-processors"></a>Defining Example Code for Connector Processors</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Connectors built with DevKit 3.8 support specification of examples in a different format. See the new specification and generation format at <a href="connector-reference-documentation.html">Connector Reference Documentation</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Follow along to add an example use for an operation (annotated with <code>@Processor</code>).</p>
</div>
<div class="paragraph">
<p>Create the file referenced in the code block in the <code>Connector.java</code> file following <code>{@sample &#8230;&#8203;}</code> if the file does not exist already.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/**
 * Returns the list of recently added recipes
 *
 * {@sample.xml ../../../doc/cookbook-connector.xml.sample
 * cook-book:getRecentlyAdded}
 *
 * @return A list of the recently added recipes
 */</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When you add an example, use the same name as the one that specifies the example in the file. Inside of it you have to put an example of the <code>@Processor</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have the "Javadoc check" enabled, the DevKit plugin marks the missing example as an error and provides a quick fix for us to easily add the example.</p>
</div>
<div class="paragraph">
<p>Otherwise, open the file and type <strong>&lt;</strong> at the editor and use <code>control</code> + <code>space</code> to display the templates and pick the one that best suits our operation.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/sample1.png" alt="sample1" width="600">
</div>
</div>
<div class="paragraph">
<p>Our example in this case looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;!-- BEGIN_INCLUDE(cook-book:getRecentlyAdded) --&gt;
	&lt;cook-book:get-recently-added/&gt;
&lt;!-- END_INCLUDE(cook-book:getRecentlyAdded) --&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-the-connector-in-a-mule-app"><a class="anchor" href="#using-the-connector-in-a-mule-app"></a>Using the Connector in a Mule App</h3>
<div class="paragraph">
<p>Make a simple app that listens at an HTTP endpoint; when the endpoint is hit, the app retrieves the list of recently added items from the cookbook service using the connector.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a Mule application in Studio and add an HTTP listener and specify <code>/get-recently</code> for the path. If this is your first Mule app, take a look at our <a href="../../solutions/getting-started/build-a-hello-world-application.html">Hello World Application</a>.</p>
</li>
<li>
<p>Drop the connector onto the canvas and configure using <code>admin</code> and <code>admin</code> as the credentials (this is for non-OAuth configuration).</p>
<div class="imageblock">
<div class="content">
<img src="./_images/devkit-tutorial-4cb84.png" alt="devkit tutorial 4cb84">
</div>
</div>
</li>
<li>
<p>Drag and drop an <strong>Object to JSON</strong> transformer after the connector, and run the app. (Play icon or <strong>Run As</strong> &gt; <strong>Mule Application</strong>)</p>
<div class="imageblock">
<div class="content">
<img src="./_images/devkit-tutorial-1c0f8.png" alt="devkit tutorial 1c0f8">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;mule xmlns:cookbook="http://www.mulesoft.org/schema/mule/cookbook" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/cookbook http://www.mulesoft.org/schema/mule/cookbook/current/mule-cookbook.xsd"&gt;
    &lt;http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration"/&gt;
    &lt;cookbook:config name="Cookbook__Configuration" doc:name="Cookbook: Configuration"/&gt;
    &lt;flow name="mule-appFlow"&gt;
        &lt;http:listener config-ref="HTTP_Listener_Configuration" path="/get-recently" doc:name="HTTP"/&gt;
        &lt;cookbook:get-recently-added config-ref="Cookbook__Configuration" doc:name="Cookbook"/&gt;
        &lt;json:object-to-json-transformer doc:name="Object to JSON"/&gt;
    &lt;/flow&gt;
&lt;/mule&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you hit the url <code>http://localhost:8081/get-recently</code> you will see a reply similar to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">[
   {
      "created":1428678371866,
      "id":2,
      "lastModified":null,
      "name":"Baked Apples",
      "cookTime":20.0,
      "directions":[
         "Cut the Apples",
         "Put them in the oven",
         "Remove from the oven after 20.0 minutes"
      ],
      "ingredients":[
         {
            "created":1428678371866,
            "id":1,
            "lastModified":null,
            "name":"Apple",
            "quantity":0.0,
            "unit":"UNIT"
         }
      ],
      "prepTime":30.0
   }
]</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To learn how to create tests for your connector see:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://mulesoft.github.io/connector-certification-docs/advanced/index.html#_functional_tests_automation">Tests Automation</a> documentation.</p>
</li>
<li>
<p>The full <a href="developing-devkit-connector-tests.html">testing documentation</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="adding-connection-management"><a class="anchor" href="#adding-connection-management"></a>Adding Connection Management</h3>
<div class="paragraph">
<p>The <code>getRecentlyAdded</code> call doesn&#8217;t require authentication&#8201;&#8212;&#8201;all other Cookbook operations require that you set a token on each request.</p>
</div>
<div class="paragraph">
<p>The client you are using provides a login call that initializes the token and uses it in subsequent requests.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Take into account that the session can expire and cause the connector to make a login request again.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>DevKit provides a set of annotations to keep your code clean and handle the connection.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>Config.java</code> file, change <code>@Configuration</code> to <code>@ConnectionManagement</code></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook.config;

import org.mule.api.ConnectionException;
import org.mule.api.ConnectionExceptionCode;
import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Connect;
import org.mule.api.annotations.ConnectionIdentifier;
import org.mule.api.annotations.Disconnect;
import org.mule.api.annotations.TestConnectivity;
import org.mule.api.annotations.ValidateConnection;
import org.mule.api.annotations.components.ConnectionManagement;
import org.mule.api.annotations.display.Password;
import org.mule.api.annotations.param.ConnectionKey;
import org.mule.api.annotations.param.Default;

import com.cookbook.tutorial.client.MuleCookBookClient;
import com.cookbook.tutorial.service.InvalidCredentialsException;

/**
 * Configuration type Config
 *
 * @author MuleSoft, Inc.
 */
@ConnectionManagement(friendlyName = "Configuration")
public class ConnectorConfig {

    /**
     * Connect
     *
     * @param username
     *            A username
     * @param password
     *            A password
     * @throws ConnectionException
     */
    @Connect
    @TestConnectivity
    public void connect(@ConnectionKey String username, @Password String password) throws ConnectionException {
        setClient(new MuleCookBookClient(getAddress()));
        try {
            getClient().login(username, password);
        } catch (InvalidCredentialsException e) {
            throw new ConnectionException(ConnectionExceptionCode.INCORRECT_CREDENTIALS, e.getMessage(), "Invalid credentials");
        }
    }

    /**
     * Disconnect
     */
    @Disconnect
    public void disconnect() {
        setClient(null);
    }

    /**
     * Are we connected
     */
    @ValidateConnection
    public boolean isConnected() {
        return getClient() != null;
    }

    /**
     * Id used only when debuging.
     */
    @ConnectionIdentifier
    public String connectionId() {
        return "001";
    }

    /**
     * Description for address
     */
    @Configurable
    @Default("http://devkit-cookbook.cloudhub.io/soap")
    private String address;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    private MuleCookBookClient client;

    public MuleCookBookClient getClient() {
        return client;
    }

    public void setClient(MuleCookBookClient client) {
        this.client = client;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>Make sure you have equipped the <code>MuleCookbookClient</code> in the <code>ConnectorConfig.java</code> with a getter and a setter.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook.config;

import org.mule.api.ConnectionException;
import org.mule.api.ConnectionExceptionCode;
import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Connect;
import org.mule.api.annotations.ConnectionIdentifier;
import org.mule.api.annotations.Disconnect;
import org.mule.api.annotations.TestConnectivity;
import org.mule.api.annotations.ValidateConnection;
import org.mule.api.annotations.components.ConnectionManagement;
import org.mule.api.annotations.display.Password;
import org.mule.api.annotations.param.ConnectionKey;
import org.mule.api.annotations.param.Default;

import com.cookbook.tutorial.client.MuleCookBookClient;
import com.cookbook.tutorial.service.InvalidCredentialsException;

/**
 * Configuration type Config
 *
 * @author MuleSoft, Inc.
 */
@ConnectionManagement(friendlyName = "Configuration")
public class ConnectorConfig {

    /**
     * Connect
     *
     * @param username
     *            A username
     * @param password
     *            A password
     * @throws ConnectionException
     */
    @Connect
    @TestConnectivity
    public void connect(@ConnectionKey String username, @Password String password) throws ConnectionException {
        setClient(new MuleCookBookClient(getAddress()));
        try {
            getClient().login(username, password);
        } catch (InvalidCredentialsException e) {
            throw new ConnectionException(ConnectionExceptionCode.INCORRECT_CREDENTIALS, e.getMessage(), "Invalid credentials");
        }
    }

    /**
     * Disconnect
     */
    @Disconnect
    public void disconnect() {
        setClient(null);
    }

    /**
     * Are we connected
     */
    @ValidateConnection
    public boolean isConnected() {
        return getClient() != null;
    }

    /**
     * Id used only when debuging.
     */
    @ConnectionIdentifier
    public String connectionId() {
        return "001";
    }

    /**
     * Description for address
     */
    @Configurable
    @Default("http://devkit-cookbook.cloudhub.io/soap")
    private String address;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    private MuleCookBookClient client;

    public MuleCookBookClient getClient() {
        return client;
    }

    public void setClient(MuleCookBookClient client) {
        this.client = client;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>Implement these four methods as shown:</p>
<div class="ulist">
<ul>
<li>
<p><strong><code>@Connect</code></strong> - Initialize the client, and if the login does not succeed, throw an exception.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook.config;

import org.mule.api.ConnectionException;
import org.mule.api.ConnectionExceptionCode;
import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Connect;
import org.mule.api.annotations.ConnectionIdentifier;
import org.mule.api.annotations.Disconnect;
import org.mule.api.annotations.TestConnectivity;
import org.mule.api.annotations.ValidateConnection;
import org.mule.api.annotations.components.ConnectionManagement;
import org.mule.api.annotations.display.Password;
import org.mule.api.annotations.param.ConnectionKey;
import org.mule.api.annotations.param.Default;

import com.cookbook.tutorial.client.MuleCookBookClient;
import com.cookbook.tutorial.service.InvalidCredentialsException;

/**
 * Configuration type Config
 *
 * @author MuleSoft, Inc.
 */
@ConnectionManagement(friendlyName = "Configuration")
public class ConnectorConfig {

    /**
     * Connect
     *
     * @param username
     *            A username
     * @param password
     *            A password
     * @throws ConnectionException
     */
    @Connect
    @TestConnectivity
    public void connect(@ConnectionKey String username, @Password String password) throws ConnectionException {
        setClient(new MuleCookBookClient(getAddress()));
        try {
            getClient().login(username, password);
        } catch (InvalidCredentialsException e) {
            throw new ConnectionException(ConnectionExceptionCode.INCORRECT_CREDENTIALS, e.getMessage(), "Invalid credentials");
        }
    }

    /**
     * Disconnect
     */
    @Disconnect
    public void disconnect() {
        setClient(null);
    }

    /**
     * Are we connected
     */
    @ValidateConnection
    public boolean isConnected() {
        return getClient() != null;
    }

    /**
     * Id used only when debuging.
     */
    @ConnectionIdentifier
    public String connectionId() {
        return "001";
    }

    /**
     * Description for address
     */
    @Configurable
    @Default("http://devkit-cookbook.cloudhub.io/soap")
    private String address;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    private MuleCookBookClient client;

    public MuleCookBookClient getClient() {
        return client;
    }

    public void setClient(MuleCookBookClient client) {
        this.client = client;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p><strong><code>@Disconnect</code></strong> - Release a connection.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook.config;

import org.mule.api.ConnectionException;
import org.mule.api.ConnectionExceptionCode;
import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Connect;
import org.mule.api.annotations.ConnectionIdentifier;
import org.mule.api.annotations.Disconnect;
import org.mule.api.annotations.TestConnectivity;
import org.mule.api.annotations.ValidateConnection;
import org.mule.api.annotations.components.ConnectionManagement;
import org.mule.api.annotations.display.Password;
import org.mule.api.annotations.param.ConnectionKey;
import org.mule.api.annotations.param.Default;

import com.cookbook.tutorial.client.MuleCookBookClient;
import com.cookbook.tutorial.service.InvalidCredentialsException;

/**
 * Configuration type Config
 *
 * @author MuleSoft, Inc.
 */
@ConnectionManagement(friendlyName = "Configuration")
public class ConnectorConfig {

    /**
     * Connect
     *
     * @param username
     *            A username
     * @param password
     *            A password
     * @throws ConnectionException
     */
    @Connect
    @TestConnectivity
    public void connect(@ConnectionKey String username, @Password String password) throws ConnectionException {
        setClient(new MuleCookBookClient(getAddress()));
        try {
            getClient().login(username, password);
        } catch (InvalidCredentialsException e) {
            throw new ConnectionException(ConnectionExceptionCode.INCORRECT_CREDENTIALS, e.getMessage(), "Invalid credentials");
        }
    }

    /**
     * Disconnect
     */
    @Disconnect
    public void disconnect() {
        setClient(null);
    }

    /**
     * Are we connected
     */
    @ValidateConnection
    public boolean isConnected() {
        return getClient() != null;
    }

    /**
     * Id used only when debuging.
     */
    @ConnectionIdentifier
    public String connectionId() {
        return "001";
    }

    /**
     * Description for address
     */
    @Configurable
    @Default("http://devkit-cookbook.cloudhub.io/soap")
    private String address;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    private MuleCookBookClient client;

    public MuleCookBookClient getClient() {
        return client;
    }

    public void setClient(MuleCookBookClient client) {
        this.client = client;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p><strong><code>@ValidateConnection</code></strong> - Check if your connection is alive.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook.config;

import org.mule.api.ConnectionException;
import org.mule.api.ConnectionExceptionCode;
import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Connect;
import org.mule.api.annotations.ConnectionIdentifier;
import org.mule.api.annotations.Disconnect;
import org.mule.api.annotations.TestConnectivity;
import org.mule.api.annotations.ValidateConnection;
import org.mule.api.annotations.components.ConnectionManagement;
import org.mule.api.annotations.display.Password;
import org.mule.api.annotations.param.ConnectionKey;
import org.mule.api.annotations.param.Default;

import com.cookbook.tutorial.client.MuleCookBookClient;
import com.cookbook.tutorial.service.InvalidCredentialsException;

/**
 * Configuration type Config
 *
 * @author MuleSoft, Inc.
 */
@ConnectionManagement(friendlyName = "Configuration")
public class ConnectorConfig {

    /**
     * Connect
     *
     * @param username
     *            A username
     * @param password
     *            A password
     * @throws ConnectionException
     */
    @Connect
    @TestConnectivity
    public void connect(@ConnectionKey String username, @Password String password) throws ConnectionException {
        setClient(new MuleCookBookClient(getAddress()));
        try {
            getClient().login(username, password);
        } catch (InvalidCredentialsException e) {
            throw new ConnectionException(ConnectionExceptionCode.INCORRECT_CREDENTIALS, e.getMessage(), "Invalid credentials");
        }
    }

    /**
     * Disconnect
     */
    @Disconnect
    public void disconnect() {
        setClient(null);
    }

    /**
     * Are we connected
     */
    @ValidateConnection
    public boolean isConnected() {
        return getClient() != null;
    }

    /**
     * Id used only when debuging.
     */
    @ConnectionIdentifier
    public String connectionId() {
        return "001";
    }

    /**
     * Description for address
     */
    @Configurable
    @Default("http://devkit-cookbook.cloudhub.io/soap")
    private String address;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    private MuleCookBookClient client;

    public MuleCookBookClient getClient() {
        return client;
    }

    public void setClient(MuleCookBookClient client) {
        this.client = client;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p><strong><code>@ConnectionIdentifier</code></strong> - Return a string value. This will only be used when debugging.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook.config;

import org.mule.api.ConnectionException;
import org.mule.api.ConnectionExceptionCode;
import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Connect;
import org.mule.api.annotations.ConnectionIdentifier;
import org.mule.api.annotations.Disconnect;
import org.mule.api.annotations.TestConnectivity;
import org.mule.api.annotations.ValidateConnection;
import org.mule.api.annotations.components.ConnectionManagement;
import org.mule.api.annotations.display.Password;
import org.mule.api.annotations.param.ConnectionKey;
import org.mule.api.annotations.param.Default;

import com.cookbook.tutorial.client.MuleCookBookClient;
import com.cookbook.tutorial.service.InvalidCredentialsException;

/**
 * Configuration type Config
 *
 * @author MuleSoft, Inc.
 */
@ConnectionManagement(friendlyName = "Configuration")
public class ConnectorConfig {

    /**
     * Connect
     *
     * @param username
     *            A username
     * @param password
     *            A password
     * @throws ConnectionException
     */
    @Connect
    @TestConnectivity
    public void connect(@ConnectionKey String username, @Password String password) throws ConnectionException {
        setClient(new MuleCookBookClient(getAddress()));
        try {
            getClient().login(username, password);
        } catch (InvalidCredentialsException e) {
            throw new ConnectionException(ConnectionExceptionCode.INCORRECT_CREDENTIALS, e.getMessage(), "Invalid credentials");
        }
    }

    /**
     * Disconnect
     */
    @Disconnect
    public void disconnect() {
        setClient(null);
    }

    /**
     * Are we connected
     */
    @ValidateConnection
    public boolean isConnected() {
        return getClient() != null;
    }

    /**
     * Id used only when debuging.
     */
    @ConnectionIdentifier
    public String connectionId() {
        return "001";
    }

    /**
     * Description for address
     */
    @Configurable
    @Default("http://devkit-cookbook.cloudhub.io/soap")
    private String address;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    private MuleCookBookClient client;

    public MuleCookBookClient getClient() {
        return client;
    }

    public void setClient(MuleCookBookClient client) {
        this.client = client;
    }

}</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Remove the declaration of <code>MuleCookBookClient</code> from  <code>CookbookConnector.java</code> and remove the method where a new <code>MuleCookBookClient</code> client is instantiated.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">	private MuleCookBookClient client;

	@Start
	public void initialize() {
		client = new MuleCookBookClient(config.getAddress());
	}</code></pre>
</div>
</div>
</li>
<li>
<p>In our <code>getRecentlyAdded</code> method (annotated as a <code>@Processor</code>) call the <code>getclient</code> method, which should be defined in <code>ConnectorConfig.java</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.Processor;
import org.mule.modules.cookbook.config.ConnectorConfig;

import com.cookbook.tutorial.service.Recipe;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cookbook-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>See:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v2/CookbookConnector.java">Connector</a> source code.</p>
</li>
<li>
<p><a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v2/ConnectorConfig.java">Config</a> source code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you install this version and try to run the Mule app we created earlier, you will see that it fails with a "SAXParseException" because we need to add a username and password to our configuration.</p>
</div>
<div class="paragraph">
<p>Just open the global configuration of your connector and check that there are two new fields, username and password. Configure them and you can run the app again.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/connection-management.png" alt="connection management" width="600">
</div>
</div>
<div class="paragraph">
<p>This is the updated Mule app XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;mule xmlns:cookbook="http://www.mulesoft.org/schema/mule/cookbook" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/cookbook http://www.mulesoft.org/schema/mule/cookbook/current/mule-cookbook.xsd"&gt;
    &lt;http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration"/&gt;
    &lt;cookbook:config name="Cookbook__Configuration" doc:name="Cookbook: Configuration type config" password="admin" username="admin"/&gt;
    &lt;flow name="mule-appFlow"&gt;
        &lt;http:listener config-ref="HTTP_Listener_Configuration" path="/get-recently" doc:name="HTTP"/&gt;
        &lt;cookbook:get-recently-added config-ref="Cookbook__Configuration" doc:name="Cookbook"/&gt;
        &lt;json:object-to-json-transformer doc:name="Object to JSON"/&gt;
    &lt;/flow&gt;
&lt;/mule&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Understand <a href="http://mulesoft.github.io/connector-certification-docs/advanced/index.html#_test_connectivity">Testing Connectivity</a>.</p>
</li>
<li>
<p>See documentation on setting up <a href="authentication.html">Authentication</a> using DevKit.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="improving-exception-and-error-handling"><a class="anchor" href="#improving-exception-and-error-handling"></a>Improving Exception and Error Handling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section explains how to improve exception handling and reconnecting.</p>
</div>
<div class="sect2">
<h3 id="exception-handling-with-handler"><a class="anchor" href="#exception-handling-with-handler"></a>Exception Handling with @Handler</h3>
<div class="paragraph">
<p>The <code>@Handler</code> feature is useful for avoiding duplicate code for handling exceptions, and makes your code easier to read.</p>
</div>
<div class="paragraph">
<p>When handling messages retrieved from the API, if you see the message is uninformative and you know how to improve it, use the <code>@Handler</code> mechanism to enrich the error information provided to the user.</p>
</div>
<div class="paragraph">
<p>To see how it works, let&#8217;s create a handler in the connector code for the <code>InvalidEntityException</code> thrown by the Cookbook SDK <code>create()</code> call:</p>
</div>
<div class="listingblock">
<div class="title">This <code>create()</code> call from <code>MuleCookBookClient.java</code> throws <code>InvalidEntityException</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Override
   public CookBookEntity create(CookBookEntity entity) throws InvalidEntityException,
           SessionExpiredException {
       Create request = factory.createCreate();
       request.setEntity(entity);
       try {
           return port.create(request, token).getReturn();
       } catch (InvalidTokenException e) {
           logger.warn("Should never happen.", e);
           throw new RuntimeException(e);
       }
     }</code></pre>
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new <strong>Anypoint Connector Component</strong> by right-clicking and navigating to that item in the menu, or via <strong>New</strong> &gt; <strong>Other</strong>, selecting this option in the wizard.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new-component.png" alt="new component" width="600">
</div>
</div>
</li>
<li>
<p>Select the package, component type and class name and click on Finish.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new-component-2.png" alt="new component 2" width="600">
</div>
</div>
</li>
<li>
<p>Improve the error message when <code>InvalidEntityException</code> is thrown.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.mule.modules.cookbook.handler;

import org.mule.api.annotations.Handle;
import org.mule.api.annotations.components.Handler;

import com.cookbook.tutorial.service.InvalidEntityException;

@Handler
public class CookbookHandler {

    @Handle
    public void handleException(Exception ex) throws Exception {
        if (ex instanceof InvalidEntityException) {
            throw new RuntimeException("You cannot provide an Id when creating an Ingredient");
        } else {
            // Just let it go
            throw ex;
        }
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the full <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v3/CookbookHandler.java">source code</a>.</p>
</div>
</li>
<li>
<p>Add a new processor to create Ingredients, noticing how it references the exception handler we included.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cookbook-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for createIngredient
     *
     * {@sample.xml ../../../doc/cookbook-connector.xml.sample cook-book:createIngredient}
     *
     * @param Ingredient
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    public Ingredient createIngredient(@Default("#[payload]") Ingredient Ingredient) throws InvalidEntityException, SessionExpiredException {
        return (Ingredient) config.getClient().create(Ingredient);
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the full <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v3/CookbookConnector.java">source code</a>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="handling-session-expiration"><a class="anchor" href="#handling-session-expiration"></a>Handling Session Expiration</h3>
<div class="paragraph">
<p>There is no need for users to add custom code in their Mule apps to handle session expiration. DevKit provides a mechanism to do this cleanly.</p>
</div>
<div class="paragraph">
<p>Just annotate your <code>@Processor</code> method with the <code>@ReconnectOn</code> exception.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for createIngredient
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:createIngredient}
     *
     * @param Ingredient
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Ingredient createIngredient(@Default("#[payload]") Ingredient Ingredient) throws InvalidEntityException, SessionExpiredException {
        return (Ingredient) config.getClient().create(Ingredient);
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the full <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v3/CookbookConnector2.java">source code</a>.</p>
</div>
<div class="paragraph">
<p>In our Mule app, you can configure a reconnection strategy so that our Mule app is ready to  handle session expirations.</p>
</div>
<div class="paragraph">
<p>Global Configuration for the Cookbook connector dialog window:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/reconnect.png" alt="reconnect" width="500">
</div>
</div>
<div class="paragraph">
<p>The generated XML for the Cookbook connector configuration element looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;cookbook:config-type doc:name="config" name="config" password="admin" username="admin"&gt;
    &lt;reconnect/&gt;
&lt;/cookbook:config-type&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-datasense"><a class="anchor" href="#adding-datasense"></a>Adding DataSense</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="what-is-it"><a class="anchor" href="#what-is-it"></a>What is it?</h3>
<div class="paragraph">
<p>DataSense improves the user experience at design time when creating Mule applications by enabling your connector to determine the API of your target resource.</p>
</div>
<div class="paragraph">
<p>Even though DataSense is optional, its use enables connector users to acquire metadata of the entities in a service.</p>
</div>
<div class="paragraph">
<p>See:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="adding-datasense.html">Adding DataSense</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this tutorial, we use a static DataSense model, which means that the entities are fixed and known upfront, and do not change. The fields that this model supports are also fixed.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-datasense"><a class="anchor" href="#using-datasense"></a>Using DataSense</h3>
<div class="paragraph">
<p>To use DataSense in the cookbook:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Analyze the entities in {mule} service. We only have two simple entities, Recipe and Ingredient that both extend from CookBookEntity.</p>
</li>
<li>
<p>Look at how our createIngredient operation looks inside Anypoint Studio, and how it interacts with other components.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for createIngredient
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:createIngredient}
     *
     * @param Ingredient
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Ingredient createIngredient(@Default("#[payload]") Ingredient Ingredient) throws InvalidEntityException, SessionExpiredException {
        return (Ingredient) config.getClient().create(Ingredient);
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="handling-ingredients"><a class="anchor" href="#handling-ingredients"></a>Handling Ingredients</h4>
<div class="paragraph">
<p>We defined the operation so that it receives an Ingredient, and it returns an Ingredient with the extra fields populated from the server.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s handle the ingredients:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the input metadata to see that the expected output is a POJO, with the expected fields our Ingredient has:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/datasense-expected-ingredients.png" alt="datasense expected ingredients" width="800">
</div>
</div>
</li>
<li>
<p>Verify that the output metadata is expected:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/datasense-ingredients.png" alt="datasense ingredients" width="800">
</div>
</div>
</li>
<li>
<p>Drag and drop a Transform Message element either behind or after our connector. The input/output structure is collected automatically:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/datasense-input.png" alt="datasense input" width="800">
</div>
<div class="title">Figure 2. Transform Message Receiving Connector Output</div>
</div>
<div class="paragraph">
<p>Because DevKit auto-generates static metadata, DevKit automatically ensures that your connector knows how to propagate metadata information.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="handling-recipes"><a class="anchor" href="#handling-recipes"></a>Handling Recipes</h4>
<div class="paragraph">
<p>We don&#8217;t have just Ingredients, we also have Recipes, so we don&#8217;t want one method for each entity we have in our model.</p>
</div>
<div class="paragraph">
<p>Modify your connector to just work with the CookBookEntity class:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create an operation:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.RefOnly;
import org.mule.modules.cookbook.handler.CookbookHandler;
import org.mule.modules.cookbook.config.ConnectorConfig;

import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.InvalidTokenException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
public class CookbookConnector {

	@Config
	private
    ConnectorConfig config;

    /**
     * Get a list of the most recently added Ingredients
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return List of recently added Ingredients.
     *
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

	/**
	 * Description for create
	 *
	 * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
	 *
	 * @param entity Ingredient to be created
	 * @return return Ingredient with Id from the system.
	 *
	 * @throws InvalidTokenException
	 * @throws SessionExpiredException
	 * @throws InvalidEntityException
	 */
	@Processor
	@OnException (handler=CookbookHandler.class)
	@ReconnectOn(exceptions = { SessionExpiredException.class })
	public CookBookEntity create(@Default("#[payload]") @RefOnly CookBookEntity entity) throws InvalidEntityException, SessionExpiredException {
		return config.getClient().create(entity);
	}

	/**
	 * Description for update
	 *
	 * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
	 *
	 * @param entity Ingredient to be updated
	 * @return return Ingredient with Id from the system.
	 *
	 * @throws SessionExpiredException
	 * @throws InvalidEntityException
	 * @throws NoSuchEntityException
	 */
	@Processor
	@OnException (handler=CookbookHandler.class)
	@ReconnectOn(exceptions = { SessionExpiredException.class })
	public CookBookEntity update(@Default("#[payload]") @RefOnly CookBookEntity entity) throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
		return config.getClient().update(entity);
	}

	/**
	 * Description for get
	 *
	 * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
	 *
	 * @param id Id of the entity to retrieve
	 * @return return Ingredient with Id from the system.
	 *
	 * @throws SessionExpiredException
	 * @throws InvalidEntityException
	 * @throws NoSuchEntityException
	 */
	@Processor
	@OnException (handler=CookbookHandler.class)
	@ReconnectOn(exceptions = { SessionExpiredException.class })
	public CookBookEntity get(@Default("1") Integer id) throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
		return config.getClient().get(id);
	}

	/**
	 * Description for get
	 *
	 * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
	 *
	 * @param id Id of the entity to retrieve
	 * @return return Ingredient with Id from the system.
	 *
	 * @throws SessionExpiredException
	 * @throws NoSuchEntityException
	 */
	@Processor
	@OnException (handler=CookbookHandler.class)
	@ReconnectOn(exceptions = { SessionExpiredException.class })
	public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
		config.getClient().delete(id);
	}

	public ConnectorConfig getConfig() {
		return config;
	}

	public void setConfig(ConnectorConfig config) {
		this.config = config;
	}

}</code></pre>
</div>
</div>
</li>
<li>
<p>The <strong>@RefOnly</strong> annotation is used to tell DevKit that the input can only be specified as a reference (due to a DevKit limitations on handling Abstract classes).</p>
<div class="paragraph">
<p>Let&#8217;s see how this affects the UI and user experience.</p>
</div>
<div class="paragraph">
<p>Studio, can no longer determine input or output type:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/ref-only-input.png" alt="ref only input" width="900">
</div>
<div class="title">Figure 3. Connector Input with @RefOnly</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/ref-only-output.png" alt="ref only output" width="900">
</div>
<div class="title">Figure 4. Connector Output with Abstract Class</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the next section we get back our DataSense-friendly user experience.</p>
</div>
<div class="paragraph">
<p>The full source code of our connector with a create, update, get and delete operation is available <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v4/CookbookConnector.java">here</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="implementing-a-metadatacategory"><a class="anchor" href="#implementing-a-metadatacategory"></a>Implementing a MetaDataCategory</h3>
<div class="paragraph">
<p>To implement DataSense using a @MetaDataCategory, you need to separate your implementation in two steps, retrieving the keys and describing the keys.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the Anypoint DevKit Component wizard to create a new MetaDataCategory</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new-metadatacategory.png" alt="new metadatacategory" width="600">
</div>
</div>
</li>
<li>
<p>Modify the method annotate with @MetaDataKeyRetriever to retrieve two keys, one for Recipe and another for Ingredient.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.mule.modules.cookbook.datasense;

import java.util.ArrayList;
import java.util.List;

import javax.inject.Inject;

import org.mule.api.annotations.MetaDataKeyRetriever;
import org.mule.api.annotations.MetaDataRetriever;
import org.mule.api.annotations.components.MetaDataCategory;
import org.mule.common.metadata.DefaultMetaData;
import org.mule.common.metadata.DefaultMetaDataKey;
import org.mule.common.metadata.MetaData;
import org.mule.common.metadata.MetaDataKey;
import org.mule.common.metadata.MetaDataModel;
import org.mule.common.metadata.builder.DefaultMetaDataBuilder;
import org.mule.common.metadata.builder.PojoMetaDataBuilder;

import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.Recipe;

@MetaDataCategory
public class DataSenseResolver {

    /**
     * Retrieves the list of keys
     */
    @MetaDataKeyRetriever
    public List&lt;MetaDataKey&gt; getMetaDataKeys() throws Exception {
        List&lt;MetaDataKey&gt; keys = new ArrayList&lt;MetaDataKey&gt;();

        // Generate the keys
        keys.add(new DefaultMetaDataKey("id1", "Ingredient"));
        keys.add(new DefaultMetaDataKey("id2", "Recipe"));

        return keys;
    }

    /**
     * Get MetaData given the Key the user selects
     *
     * @param key
     *            The key selected from the list of valid keys
     * @return The MetaData model of that corresponds to the key
     * @throws Exception
     *             If anything fails
     */
    @MetaDataRetriever
    public MetaData getMetaData(MetaDataKey key) throws Exception {
        DefaultMetaDataBuilder builder = new DefaultMetaDataBuilder();
        // Since our model is static and we can simply create the pojo model.
        PojoMetaDataBuilder&lt;?&gt; pojoObject = null;
        if ("id1".equals(key.getId())) {
            pojoObject = builder.createPojo(Ingredient.class);
        } else if ("id2".equals(key.getId())) {
            pojoObject = builder.createPojo(Recipe.class);
        } else {
            throw new RuntimeException("Invalid key:" + key.getId());
        }
        MetaDataModel model = pojoObject.build();
        MetaData metaData = new DefaultMetaData(model);

        return metaData;
    }


    @Inject
    private CookbookConnector connector;


    public CookbookConnector getConnector() {
        return connector;
    }

    public void setConnector(CookbookConnector connector) {
        this.connector = connector;
    }
}</code></pre>
</div>
</div>
</li>
<li>
<p>Modify the method annotate with @MetaDataRetriever, to retrieve the description. Because we use a static model, we can just create a POJO model:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.mule.modules.cookbook.datasense;

import java.util.ArrayList;
import java.util.List;

import javax.inject.Inject;

import org.mule.api.annotations.MetaDataKeyRetriever;
import org.mule.api.annotations.MetaDataRetriever;
import org.mule.api.annotations.components.MetaDataCategory;
import org.mule.common.metadata.DefaultMetaData;
import org.mule.common.metadata.DefaultMetaDataKey;
import org.mule.common.metadata.MetaData;
import org.mule.common.metadata.MetaDataKey;
import org.mule.common.metadata.MetaDataModel;
import org.mule.common.metadata.builder.DefaultMetaDataBuilder;
import org.mule.common.metadata.builder.PojoMetaDataBuilder;

import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.Recipe;

@MetaDataCategory
public class DataSenseResolver {

    /**
     * Retrieves the list of keys
     */
    @MetaDataKeyRetriever
    public List&lt;MetaDataKey&gt; getMetaDataKeys() throws Exception {
        List&lt;MetaDataKey&gt; keys = new ArrayList&lt;MetaDataKey&gt;();

        // Generate the keys
        keys.add(new DefaultMetaDataKey("id1", "Ingredient"));
        keys.add(new DefaultMetaDataKey("id2", "Recipe"));

        return keys;
    }

    /**
     * Get MetaData given the Key the user selects
     *
     * @param key
     *            The key selected from the list of valid keys
     * @return The MetaData model of that corresponds to the key
     * @throws Exception
     *             If anything fails
     */
    @MetaDataRetriever
    public MetaData getMetaData(MetaDataKey key) throws Exception {
        DefaultMetaDataBuilder builder = new DefaultMetaDataBuilder();
        // Since our model is static and we can simply create the pojo model.
        PojoMetaDataBuilder&lt;?&gt; pojoObject = null;
        if ("id1".equals(key.getId())) {
            pojoObject = builder.createPojo(Ingredient.class);
        } else if ("id2".equals(key.getId())) {
            pojoObject = builder.createPojo(Recipe.class);
        } else {
            throw new RuntimeException("Invalid key:" + key.getId());
        }
        MetaDataModel model = pojoObject.build();
        MetaData metaData = new DefaultMetaData(model);

        return metaData;
    }


    @Inject
    private CookbookConnector connector;


    public CookbookConnector getConnector() {
        return connector;
    }

    public void setConnector(CookbookConnector connector) {
        this.connector = connector;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the full <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v5/DataSenseResolver.java">source code</a>.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To use this in our connector, modify our @Processors so that a user can pick the entities.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Annotate our @Connector class with the @MetaDataScope annotation. This sets the default MetaDataCategory that&#8217;s used every time users choose a @Processor that has a @MetaDataKeyParam.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param type
     *            Object Type
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly CookBookEntity entity)
            throws InvalidEntityException, SessionExpiredException {
        return config.getClient().create(entity);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param type
     *            Object Type
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly CookBookEntity entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        return config.getClient().update(entity);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param type
     *            Object Type
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        return config.getClient().get(id);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        config.getClient().delete(id);
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>To describe input and output, add a String annotated with <strong>@MetaDataKeyParam</strong>, and specify that it affects input and output by adding the <strong>affects=MetaDataKeyParamAffectsType.BOTH</strong> :</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param type
     *            Object Type
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly CookBookEntity entity)
            throws InvalidEntityException, SessionExpiredException {
        return config.getClient().create(entity);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param type
     *            Object Type
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly CookBookEntity entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        return config.getClient().update(entity);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param type
     *            Object Type
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        return config.getClient().get(id);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        config.getClient().delete(id);
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>In your get operation you need specify that the affect only applies to the output so we modify it just a little:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param type
     *            Object Type
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly CookBookEntity entity)
            throws InvalidEntityException, SessionExpiredException {
        return config.getClient().create(entity);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param type
     *            Object Type
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly CookBookEntity entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        return config.getClient().update(entity);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param type
     *            Object Type
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public CookBookEntity get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        return config.getClient().get(id);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        config.getClient().delete(id);
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>Check our new connector looks in Studio. We have a combo after we select the entity type and save it. This automatically refreshes our metadata.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/datasense-static.png" alt="datasense static" width="800">
</div>
</div>
<div class="paragraph">
<p>Now even the {dataWeave} knows how to interact with our @Connector:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/datasense-static2.png" alt="datasense static2" width="800">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>View connector full source code <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v5/CookbookConnector.java">here</a>.</p>
</div>
<div class="sect3">
<h4 id="dynamic-datasense"><a class="anchor" href="#dynamic-datasense"></a>Dynamic DataSense</h4>
<div class="paragraph">
<p>In the previous section we covered the scenario when your model is static. Let&#8217;s take a look into a much more complex scenario.</p>
</div>
<div class="paragraph">
<p>There are APIs that provide a way to get entity definitions dynamically. Salesforce, NetSuite are just some examples of these.</p>
</div>
<div class="paragraph">
<p>In our case, our Cookbook provides an operation that describes our entities, so let&#8217;s use that instead to get the entities and structure:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get the supported entities, and generate a key that we can use later:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.mule.modules.cookbook.datasense;

import java.util.ArrayList;
import java.util.List;

import javax.inject.Inject;

import org.mule.api.annotations.MetaDataKeyRetriever;
import org.mule.api.annotations.MetaDataRetriever;
import org.mule.api.annotations.components.MetaDataCategory;
import org.mule.common.metadata.DefaultMetaData;
import org.mule.common.metadata.DefaultMetaDataKey;
import org.mule.common.metadata.MetaData;
import org.mule.common.metadata.MetaDataKey;
import org.mule.common.metadata.MetaDataModel;
import org.mule.common.metadata.builder.DefaultMetaDataBuilder;
import org.mule.common.metadata.builder.DynamicObjectBuilder;
import org.mule.common.metadata.datatype.DataType;
import org.mule.modules.cookbook.CookbookConnector;

import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.Description;
import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.InvalidTokenException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.SessionExpiredException;
import com.cookbook.tutorial.service.UnitType;

@MetaDataCategory
public class DataSenseResolver {

    @Inject
    private CookbookConnector connector;

    /**
     * Retrieves the list of keys
     */
    @MetaDataKeyRetriever
    public List&lt;MetaDataKey&gt; getMetaDataKeys() throws Exception {
        List&lt;MetaDataKey&gt; keys = new ArrayList&lt;MetaDataKey&gt;();
        List&lt;CookBookEntity&gt; entities = getConnector().getConfig()
                .getClient().getEntities();
        // Generate the keys
        for (CookBookEntity entity : entities) {
            keys.add(new DefaultMetaDataKey(entity.getClass().getName() + "#"
                    + entity.getId(), entity.getName()));
        }

        return keys;
    }

    /**
     * Get MetaData given the Key the user selects
     *
     * @param key The key selected from the list of valid keys
     * @return The MetaData model of that corresponds to the key
     * @throws Exception If anything fails
     */
    @MetaDataRetriever
    public MetaData getMetaData(MetaDataKey key) throws Exception {
        DefaultMetaDataBuilder builder = new DefaultMetaDataBuilder();
        // Since our model is static and we can simply create the pojo model.
        String[] keyParts = key.getId().split("#");
        if (keyParts.length != 2) {
            throw new RuntimeException(
                    "Invalid key. Format should be 'entityType#id'");
        }
        Integer id = Integer.valueOf(keyParts[1]);
        CookBookEntity entity = (CookBookEntity) Class.forName(keyParts[0])
                .newInstance();
        entity.setId(id);
        Description description = getConnector().getConfig().getClient()
                .describeEntity(entity);

        DynamicObjectBuilder&lt;?&gt; dynamicObject = builder.createDynamicObject(key
                .getId());

        for (Description fields : description.getInnerFields()) {
            addFields(fields, dynamicObject);
        }

        MetaDataModel model = builder.build();
        MetaData metaData = new DefaultMetaData(model);

        return metaData;
    }

    private void addFields(Description description,
            DynamicObjectBuilder&lt;?&gt; dynamicObject) {
        switch (description.getDataType()) {
        case DATE:
            dynamicObject.addSimpleField(description.getName(),
                    DataType.DATE_TIME);
            break;
        case DOUBLE:
            dynamicObject
                    .addSimpleField(description.getName(), DataType.DOUBLE);
            break;
        case INTEGER:
            dynamicObject.addSimpleField(description.getName(),
                    DataType.INTEGER);
            break;
        case LIST:
            if (description.getInnerType().equals("String")) {
                dynamicObject.addList(description.getName()).ofSimpleField(
                        DataType.STRING);
            } else if (description.getInnerType().equals("Ingredient")) {
                DynamicObjectBuilder&lt;?&gt; innerObject = dynamicObject.addList(
                        description.getName()).ofDynamicObject("ingredients");
                try {
                    Description ingredientDescription = getConnector()
                            .getConfig().getClient()
                            .describeEntity(new Ingredient());
                    for (Description desc : ingredientDescription.getInnerFields()) {
                        addFields(desc, innerObject);
                    }
                } catch (InvalidTokenException e) {
                    e.printStackTrace();
                } catch (InvalidEntityException e) {
                    e.printStackTrace();
                } catch (NoSuchEntityException e) {
                    e.printStackTrace();
                } catch (SessionExpiredException e) {
                    e.printStackTrace();
                }
            }
            break;
        case OBJECT:
            DynamicObjectBuilder&lt;?&gt; innerObject = dynamicObject
                    .addDynamicObjectField(description.getName());
            for (Description field : description.getInnerFields()) {
                addFields(field, innerObject);
            }
            break;
        case STRING:
            dynamicObject
                    .addSimpleField(description.getName(), DataType.STRING);
            break;
        case UNIT_TYPE:
            dynamicObject.addEnumField(description.getName(),
                    UnitType.class.getName());
            break;
        default:
            break;
        }

    }

    public CookbookConnector getConnector() {
        return connector;
    }

    public void setConnector(CookbookConnector connector) {
        this.connector = connector;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>Use a structure that we can dynamically modify, and the way to do this in Mule is by using a Map&lt;String,Object&gt; as parameters and/or return types of our connector.</p>
<div class="paragraph">
<p>Mule provides a builder that helps us generate the MetaData for the entities.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.mule.modules.cookbook.datasense;

import java.util.ArrayList;
import java.util.List;

import javax.inject.Inject;

import org.mule.api.annotations.MetaDataKeyRetriever;
import org.mule.api.annotations.MetaDataRetriever;
import org.mule.api.annotations.components.MetaDataCategory;
import org.mule.common.metadata.DefaultMetaData;
import org.mule.common.metadata.DefaultMetaDataKey;
import org.mule.common.metadata.MetaData;
import org.mule.common.metadata.MetaDataKey;
import org.mule.common.metadata.MetaDataModel;
import org.mule.common.metadata.builder.DefaultMetaDataBuilder;
import org.mule.common.metadata.builder.DynamicObjectBuilder;
import org.mule.common.metadata.datatype.DataType;
import org.mule.modules.cookbook.CookbookConnector;

import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.Description;
import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.InvalidTokenException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.SessionExpiredException;
import com.cookbook.tutorial.service.UnitType;

@MetaDataCategory
public class DataSenseResolver {

    @Inject
    private CookbookConnector connector;

    /**
     * Retrieves the list of keys
     */
    @MetaDataKeyRetriever
    public List&lt;MetaDataKey&gt; getMetaDataKeys() throws Exception {
        List&lt;MetaDataKey&gt; keys = new ArrayList&lt;MetaDataKey&gt;();
        List&lt;CookBookEntity&gt; entities = getConnector().getConfig()
                .getClient().getEntities();
        // Generate the keys
        for (CookBookEntity entity : entities) {
            keys.add(new DefaultMetaDataKey(entity.getClass().getName() + "#"
                    + entity.getId(), entity.getName()));
        }

        return keys;
    }

    /**
     * Get MetaData given the Key the user selects
     *
     * @param key The key selected from the list of valid keys
     * @return The MetaData model of that corresponds to the key
     * @throws Exception If anything fails
     */
    @MetaDataRetriever
    public MetaData getMetaData(MetaDataKey key) throws Exception {
        DefaultMetaDataBuilder builder = new DefaultMetaDataBuilder();
        // Since our model is static and we can simply create the pojo model.
        String[] keyParts = key.getId().split("#");
        if (keyParts.length != 2) {
            throw new RuntimeException(
                    "Invalid key. Format should be 'entityType#id'");
        }
        Integer id = Integer.valueOf(keyParts[1]);
        CookBookEntity entity = (CookBookEntity) Class.forName(keyParts[0])
                .newInstance();
        entity.setId(id);
        Description description = getConnector().getConfig().getClient()
                .describeEntity(entity);

        DynamicObjectBuilder&lt;?&gt; dynamicObject = builder.createDynamicObject(key
                .getId());

        for (Description fields : description.getInnerFields()) {
            addFields(fields, dynamicObject);
        }

        MetaDataModel model = builder.build();
        MetaData metaData = new DefaultMetaData(model);

        return metaData;
    }

    private void addFields(Description description,
            DynamicObjectBuilder&lt;?&gt; dynamicObject) {
        switch (description.getDataType()) {
        case DATE:
            dynamicObject.addSimpleField(description.getName(),
                    DataType.DATE_TIME);
            break;
        case DOUBLE:
            dynamicObject
                    .addSimpleField(description.getName(), DataType.DOUBLE);
            break;
        case INTEGER:
            dynamicObject.addSimpleField(description.getName(),
                    DataType.INTEGER);
            break;
        case LIST:
            if (description.getInnerType().equals("String")) {
                dynamicObject.addList(description.getName()).ofSimpleField(
                        DataType.STRING);
            } else if (description.getInnerType().equals("Ingredient")) {
                DynamicObjectBuilder&lt;?&gt; innerObject = dynamicObject.addList(
                        description.getName()).ofDynamicObject("ingredients");
                try {
                    Description ingredientDescription = getConnector()
                            .getConfig().getClient()
                            .describeEntity(new Ingredient());
                    for (Description desc : ingredientDescription.getInnerFields()) {
                        addFields(desc, innerObject);
                    }
                } catch (InvalidTokenException e) {
                    e.printStackTrace();
                } catch (InvalidEntityException e) {
                    e.printStackTrace();
                } catch (NoSuchEntityException e) {
                    e.printStackTrace();
                } catch (SessionExpiredException e) {
                    e.printStackTrace();
                }
            }
            break;
        case OBJECT:
            DynamicObjectBuilder&lt;?&gt; innerObject = dynamicObject
                    .addDynamicObjectField(description.getName());
            for (Description field : description.getInnerFields()) {
                addFields(field, innerObject);
            }
            break;
        case STRING:
            dynamicObject
                    .addSimpleField(description.getName(), DataType.STRING);
            break;
        case UNIT_TYPE:
            dynamicObject.addEnumField(description.getName(),
                    UnitType.class.getName());
            break;
        default:
            break;
        }

    }

    public CookbookConnector getConnector() {
        return connector;
    }

    public void setConnector(CookbookConnector connector) {
        this.connector = connector;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>Check the full <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v6/DataSenseResolver.java">source code</a>.</p>
</li>
<li>
<p>In our @Connector now we need to add the code to generate the entities from the Map, and return Map in all our operations. Why is this important? To maintain consistency in our API.</p>
<div class="paragraph">
<p>This is how our new Create looks:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;
import java.util.Map;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.Transformer;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().create(input), Map.class);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().update(input), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        return m.convertValue(this.getConfig().getClient().get(id), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        this.getConfig().getClient().delete(id);
    }

    @Transformer(sourceTypes = { List.class })
    public static List&lt;Map&lt;String, Object&gt;&gt; transformJsonToComments(List&lt;Recipe&gt; list) {
        ObjectMapper mapper = new ObjectMapper();
        List&lt;Map&lt;String, Object&gt;&gt; result = mapper.convertValue(list, new TypeReference&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;() {
        });
        return result;
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that now the UI is a different form before, because the input is now a map.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/datasense-ui.png" alt="datasense ui" width="900">
</div>
</div>
</li>
<li>
<p>In our Mule app, we cannot update the metadata and use our connector. And, as you can see, note that we have a map structure instead of a POJO:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/datasense-map.png" alt="datasense map" width="900">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To see how to test DataSense check our <a href="http://mulesoft.github.io/connector-certification-docs/advanced/index.html#_testing_metadata">Testing DataSense</a> guide.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-pagination"><a class="anchor" href="#adding-pagination"></a>Adding Pagination</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="implement-pagination"><a class="anchor" href="#implement-pagination"></a>Implement Pagination</h3>
<div class="paragraph">
<p>In order to show this feature you are going to add a processor that will call the searchWithQuery operation of the SDK.</p>
</div>
<div class="paragraph">
<p>You need to do 3 things in order to have a paginated operation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;
import java.util.Map;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Paged;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.Source;
import org.mule.api.annotations.SourceStrategy;
import org.mule.api.annotations.Transformer;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.api.callback.SourceCallback;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;
import org.mule.modules.cookbook.pagination.CookbookPagingDelegate;
import org.mule.streaming.PagingConfiguration;
import org.mule.streaming.ProviderAwarePagingDelegate;

import com.cookbook.tutorial.client.ICookbookCallback;
import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for getRecentlyAddedSource
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAddedSource}
     *
     * @param callback
     *            The callback that will hook the result into mule event.
     * @throws Exception
     *             When the source fails.
     */
    @Source(sourceStrategy = SourceStrategy.POLLING, pollingPeriod = 10000)
    public void getRecentlyAddedSource(final SourceCallback callback) throws Exception {

        if (this.getConfig().getClient() != null) {
            // Every 5 seconds our callback will be executed
            this.getConfig().getClient().getRecentlyAdded(new ICookbookCallback() {

                @Override
                public void execute(List&lt;Recipe&gt; recipes) throws Exception {
                    callback.process(recipes);
                }
            });

            if (Thread.interrupted()) {
                throw new InterruptedException();
            }
        }
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().create(input), Map.class);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().update(input), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        return m.convertValue(this.getConfig().getClient().get(id), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        this.getConfig().getClient().delete(id);
    }

    /**
     * Description for queryPaginated
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:query-paginated}
     *
     *  @param query The query
     *  @param pagingConfiguration the paging configuration
     *  @return return comment
     */
    @Processor
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    @Paged <i class="conum" data-value="1"></i><b>(1)</b>
    public ProviderAwarePagingDelegate&lt;Map&lt;String, Object&gt;, CookbookConnector&gt; queryPaginated( <i class="conum" data-value="2"></i><b>(2)</b>
            final String query, final PagingConfiguration pagingConfiguration) <i class="conum" data-value="3"></i><b>(3)</b>
            throws SessionExpiredException {
        return new CookbookPagingDelegate(query, pagingConfiguration.getFetchSize());
    }

    @Transformer(sourceTypes = { List.class })
    public static List&lt;Map&lt;String, Object&gt;&gt; recipesToMaps(List&lt;Recipe&gt; list) {
        ObjectMapper mapper = new ObjectMapper();
        List&lt;Map&lt;String, Object&gt;&gt; result = mapper.convertValue(list, new TypeReference&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;() {
        });
        return result;
    }

    @Transformer(sourceTypes = { Recipe.class })
    public static Map&lt;String, Object&gt; recipeToMap(Recipe recipe) {
        ObjectMapper mapper = new ObjectMapper();
        Map&lt;String, Object&gt; result = mapper.convertValue(recipe, new TypeReference&lt;Map&lt;String, Object&gt;&gt;() {
        });
        return result;
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Annotated your processor with @Paged.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Return a ProviderAwarePagingDelegate</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Receive as one of your parameters a PagingConfiguration</td>
</tr>
</table>
</div>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>When implementing your ProviderAwarePagingDelegate you need to specify two elements:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The type of the list you will return in each page. In your case a Map&lt;String,Object&gt;</p>
</li>
<li>
<p>The type of the Connector.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>To create it use the Anypoint DevKit Component wizard and:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Specify the package were you want to create it. In this example <strong>org.mule.cookbook.pagination</strong></p>
</li>
<li>
<p>Specify you want to create a ProviderAwarePagingDelegate.</p>
</li>
<li>
<p>Set the class name as CookbookPagingDelegate</p>
<div class="imageblock">
<div class="content">
<img src="./_images/pagination-component.png" alt="pagination component" width="600">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>After that you just need to implement the methods required for you to handle the new page request.</p>
</div>
<div class="paragraph">
<p>You can find the full source code of the <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v8/CookbookPagingDelegate.java">CookbookPagingDelegate</a>.</p>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you have a reconnection strategy, DevKit will automatically reconnect and retry to get a page. It is important that you handle the state of your PagingDelegate to make sure you retry the last page that was not retrieved.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="adding-query-pagination-support.html">Adding Query Pagination Support</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="using-pagination-in-your-mule-app"><a class="anchor" href="#using-pagination-in-your-mule-app"></a>Using Pagination In Your Mule App</h3>
<div class="paragraph">
<p>You can for example use a foreach in front of your paged processor:</p>
</div>
<div class="exampleblock ex">
<div class="content">
<h3 id="mule-app" class="discrete view">Mule App</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/pagination-example.png" alt="pagination example" width="600">
</div>
</div>
<h3 id="xml" class="discrete view">XML</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;mule xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:cookbook="http://www.mulesoft.org/schema/mule/cookbook" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans" version="EE-3.6.1"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/cookbook http://www.mulesoft.org/schema/mule/cookbook/current/mule-cookbook.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd"&gt;
    &lt;cookbook:config name="CookBook__Connection_Management_Config" username="admin" password="admin" doc:name="CookBook: Connection Management Config"&gt;
        &lt;reconnect/&gt;
    &lt;/cookbook:config&gt;
    &lt;http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration"/&gt;
    &lt;flow name="mule-appFlow1"&gt;
        &lt;http:listener config-ref="HTTP_Listener_Configuration" path="/page" doc:name="HTTP"/&gt;
        &lt;cookbook:query-paginated config-ref="CookBook__Connection_Management_Config" query="GET ALL FROM INGREDIENT" fetchSize="5" doc:name="CookBook"/&gt;
        &lt;foreach doc:name="For Each"&gt;
            &lt;logger message="#[payload]" level="INFO" doc:name="Logger"/&gt;
        &lt;/foreach&gt;
        &lt;set-payload value="Finished Processing" doc:name="Set Payload"/&gt;
    &lt;/flow&gt;
&lt;/mule&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="install-guide"><a class="anchor" href="#install-guide"></a>Installing a Connector</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="using-the-anypoint-devkit-plugin"><a class="anchor" href="#using-the-anypoint-devkit-plugin"></a>Using the Anypoint DevKit plugin</h3>
<div class="paragraph">
<p>Installing the connector is basically the same as installing any Eclipse plugin.</p>
</div>
<div id="steps-to-install" class="paragraph">
<p>To install your connector from the DevKit plugin:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Right-click your project name in Package Explorer, and click <strong>Anypoint Connector</strong> &gt; <strong>Install Or Update</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/install1.png" alt="install1" width="500">
</div>
</div>
<div class="paragraph">
<p>This triggers the DevKit Maven build tool, which generates an <a href="http://help.eclipse.org/luna/index.jsp?topic=%2Forg.eclipse.pde.doc.user%2Fconcepts%2Fupdate_site.htm">update site</a> folder.</p>
</div>
<div class="paragraph">
<p>The files will be copied under the <strong>dropins</strong> folder located in the same directory as the AnypointStudio executable, and installed without the need of rebooting your AnypointStudio.</p>
</div>
</li>
<li>
<p>You can now use your connector in a Mule app.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/install2.png" alt="install2" width="600">
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To uninstall the connectors you can either use the shortcut from the UI or remove the folder from the <strong>dropins</strong> directory and reboot your AnypointStudio</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/uninstall.png" alt="uninstall" width="400">
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="installing-from-an-updatesite-zip"><a class="anchor" href="#installing-from-an-updatesite-zip"></a>Installing from an UpdateSite.zip</h3>
<div class="paragraph">
<p>Connectors can be installed manually by selecting the update site generated by DevKit:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a command prompt or terminal and change directory to where the pom.xml file is for your project (in the Eclipse workspace).</p>
</li>
<li>
<p>Run <strong>mvn clean package</strong>. This builds the connector. If the build succeeded, you should see the directory where the connector&#8217;s "UpdateSite.zip" was generated, which is usually what you point Studio.</p>
</li>
<li>
<p>Click <strong>Help</strong> &gt; <strong>Install New Software&#8230;&#8203;</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/install-updatesite.png" alt="install updatesite" width="600">
</div>
</div>
</li>
<li>
<p>Click <strong>Add</strong> and in the new dialog look for the folder.</p>
</li>
<li>
<p>Click the UpdateSite file, generated under your project&#8217;s target folder.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/install-updatesite2.png" alt="install updatesite2" width="600">
</div>
</div>
<div class="paragraph">
<p>You can either select the zip file named UpdateSite.zip or the folder update-site.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/install-updatesite3.png" alt="install updatesite3" width="600">
</div>
</div>
<div class="paragraph">
<p>A popup will open showing the task that is performed.</p>
</div>
<div id="install-dialog" class="imageblock">
<div class="content">
<img src="./_images/install12.png" alt="install12" width="500">
</div>
</div>
</li>
<li>
<p>Review the installation and update items, and accept the license agreement.</p>
</li>
<li>
<p>Click <strong>Finish</strong> and restart Studio for the changes to be recognized, and your palette updated.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
JAR files are not signed during this run, so you will see a popup.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/security-warning.png" alt="security warning" width="600">
</div>
</div>
</li>
<li>
<p>You can now use your connector in a Mule app.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/install2.png" alt="install2" width="600">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="updating-a-connector"><a class="anchor" href="#updating-a-connector"></a>Updating a Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To update your connector you can repeat the steps made for <a href="#steps-to-install">installing</a> it.</p>
</div>
<div class="paragraph">
<p>AnypointStudio will detect it is an update and perform the corresponding actions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="debugging-your-connector"><a class="anchor" href="#debugging-your-connector"></a>Debugging Your Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After successfully installing your connector, you can start using your connector in a Mule application.
You can add breakpoints in the source code of the connector to debug it.
If your connector is a Community connector, the source code ships automatically in the installed connector.
If your connector is an Enterprise connector, you need to manually attach the source code of your JAR.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
To correctly debug your code, take into account that the Mule app you are running is using the latest installed version, so if you make changes, and you want to debug the Mule app, you need to re-install the connector.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Debugging your connector when running your test is as simple as debugging any Java class.</p>
</div>
<div class="paragraph">
<p>You just need to set a breakpoint in your connector code.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sharing-my-connector"><a class="anchor" href="#sharing-my-connector"></a>Sharing My Connector</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A connector can be installed in Anypoint Studio as an "update site".</p>
</div>
<div class="paragraph">
<p>Update sites are used to organize and export features so they can be installed as a component/package into Eclipse applications.</p>
</div>
<div class="paragraph">
<p>Update site generation means the included features (along with all plug-ins part of those features) are exported into an installable form. The exported plug-ins and features are put into two folders: "plug-ins" and "features". Two other files, "content.xml" and "artifacts.xml" are also generated and contain metadata for the exported files that make installation easier. These files, along with "site.xml", collectively form an Eclipse update site. To make the update site available to others you must make all these files available in a shared directory or website.</p>
</div>
<div class="paragraph">
<p>When building a connector, DevKit generates the necessary resources for you, so that you don&#8217;t need to worry about generating it yourself.</p>
</div>
<div class="paragraph">
<p>You can use the Anypoint DevKit plugin to either install the connector on your current Studio, or export it as an update-site for others to use.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connector-structure"><a class="anchor" href="#connector-structure"></a>Connector Structure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to see how all the components are related, let&#8217;s create a Hello World connector:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In Anypoint Studio, click <strong>File</strong> &gt; <strong>New</strong> &gt; <strong>Anypoint Connector Project</strong> or right-click your project name in Package Explorer and click <strong>New</strong> &gt; <strong>Anypoint Connector Project</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new-connector-1.png" alt="new connector 1" width="500">
</div>
</div>
</li>
<li>
<p>Select the Connector Type you want to create. In this case, select <strong>SDK Based</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new0.png" alt="new0" width="500">
</div>
</div>
</li>
<li>
<p>Specify the name of your connector and click <strong>Finish</strong>:</p>
<div class="imageblock">
<div class="content">
<img src="./_images/new-connector-2.png" alt="new connector 2" width="500">
</div>
</div>
<div class="paragraph">
<p>This generates a project containing the structure and all required elements including a skeleton connector, images, sample docs, and basic tests for your connector.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/new-connector-3.png" alt="new connector 3" width="600">
</div>
</div>
</li>
<li>
<p>Enable the DevKit view by clicking from the top bar <strong>Window</strong> &gt; <strong>Show view</strong> &gt; <strong>Other</strong>, and look for DevKit in the list.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/enable-view.png" alt="enable view" width="300" height="400">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Your connector initially consists of message processors and user interface elements. Users can configure the UI elements in Anypoint Studio.</p>
</div>
<div class="paragraph">
<p>The DevKit makes it easy to install a connector in Studio. After you install it in Studio, users can search for your connector and drag it into a Mule flow.</p>
</div>
<div class="paragraph">
<p>Installing only requires right-clicking the name of the connector in Studio&#8217;s Package Explorer, and clicking <strong>Anypoint Connector</strong> &gt; <strong>Install or Update</strong>, completing the prompts, and restarting Studio, as you can see at the <a href="#install-guide">install section</a>. You can install at any time during coding. You can even install the starting skeleton connector.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s check the structure of the skeleton connector.</p>
</div>
<div class="paragraph">
<p>In this image you can see how most of the code maps into UI elements.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/split-1-high.png" alt="Image1" width="800">
</div>
<div class="title">Figure 1: View Structure and UI</div>
</div>
<div class="paragraph">
<p>In this example, you can check how the code matches to XML and other UI elements.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/split-2-high.png" alt="Image2" width="800">
</div>
<div class="title">Figure 2: View configuration and XML</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>@ConnectionStrategy</code> annotation is deprecated. Users instead should use <code>@Config</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configurable"><a class="anchor" href="#configurable"></a>@Configurable and Parameter Modifiers</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Optional parameters or configurable ones are elements that are not required, and therefore, there is no need for users to specify a value.</p>
</div>
<div class="paragraph">
<p>You can specify configurable fields (using <code>@Configurable</code>) inside your Connector Configuration classes, or as parameters of <code>@Processor</code> methods inside a <code>@Connector</code> class.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.param.Optional;

//Inside the Configuration class

/**
 * Optional Field documentation
 */
@Configurable
@Optional
private String  optionalField;
//Getter and Setter of the field are required

//Inside your @Connector

/**
 * Optional parameter
 */
@Processor
public String sayHi(String firstName,@Optional String lastName ) {
    return "Hi "+firstName+" "+((lastName==null) ? "":lastName);
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="default"><a class="anchor" href="#default"></a>@Default</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you want an optional parameter or configurable you can avoid the use of <code>@Optional</code> and just use the <code>@Default</code> annotation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.param.Default;

//Inside the Configuration class

/**
 *  Field with Default
 */
@Configurable
@Default("Hi")
private String  greeting;
//Getter and Setter of the field are required

//Inside your @Connector

/**
 * Default parameter
 */
@Processor
public String sayHi(String firstName,@Default("Unknown") String lastName ) {
    return greeting+" "+firstName+" "+lastName;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another very important use of the <code>@Default</code> annotation is when building a connector that has DataSense.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-oauthv2"><a class="anchor" href="#adding-oauthv2"></a>Adding OAuthV2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Server can also provide the token using OAuth 2.0, instead of doing a login request.</p>
</div>
<div class="paragraph">
<p>In order to use OAuth in you connector you just need to annotate your strategy with the <code>@OAuth2</code> annotation.</p>
</div>
<div class="paragraph">
<p>If you only had the OAuth2 Configuration your <code>Config.java</code> would look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.mule.modules.cookbook.config;

import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.oauth.*;
import org.mule.api.annotations.param.Default;

import com.cookbook.tutorial.client.MuleCookBookClient;

@OAuth2(configElementName = "oauth2", friendlyName = "OAuth 2.0", authorizationUrl = "http://devkit-cookbook.cloudhub.io/rest/oauth/authorize", accessTokenUrl = "http://devkit-cookbook.cloudhub.io/rest/oauth/accessToken")
public class OAuthConfig {

    private MuleCookBookClient client;

    @OAuthAccessToken
    private String accessToken;

    @Configurable
    @OAuthConsumerKey
    private String consumerKey;

    @Configurable
    @OAuthConsumerSecret
    private String consumerSecret;

    /**
     * URL used to connect to the service
     */
    @Configurable
    @Default("http://devkit-cookbook.cloudhub.io/soap")
    private String address;

    @OAuthPostAuthorization
    public void postAuthorize() {
        setClient(new MuleCookBookClient(getAddress()));
        getClient().setToken(getAccessToken());
    }

    public void setAccessToken(String accessToken) {
        this.accessToken = accessToken;
    }

    public String getAccessToken() {
        return this.accessToken;
    }

    public void setConsumerKey(String consumerKey) {
        this.consumerKey = consumerKey;
    }

    public String getConsumerKey() {
        return this.consumerKey;
    }

    public void setConsumerSecret(String consumerSecret) {
        this.consumerSecret = consumerSecret;
    }

    public String getConsumerSecret() {
        return this.consumerSecret;
    }

    public MuleCookBookClient getClient() {
        return client;
    }

    public void setClient(MuleCookBookClient client) {
        this.client = client;
    }

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>All our operations now need to be marked with the @OAuthProtected, even our @Source.</p>
</div>
<div class="paragraph">
<p>In our Connector for example you will see:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;
import java.util.Map;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Paged;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.Source;
import org.mule.api.annotations.SourceStrategy;
import org.mule.api.annotations.Transformer;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.oauth.OAuthProtected;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.api.callback.SourceCallback;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;
import org.mule.modules.cookbook.pagination.CookbookPagingDelegate;
import org.mule.streaming.PagingConfiguration;
import org.mule.streaming.ProviderAwarePagingDelegate;

import com.cookbook.tutorial.client.ICookbookCallback;
import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @OAuthProtected
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for getRecentlyAddedSource
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAddedSource}
     *
     * @param callback
     *            The callback that will hook the result into mule event.
     * @throws Exception
     *             When the source fails.
     */
    @OAuthProtected
    @Source(sourceStrategy = SourceStrategy.POLLING, pollingPeriod = 10000)
    public void getRecentlyAddedSource(final SourceCallback callback) throws Exception {

        if (this.getConfig().getClient() != null) {
            // Every 5 seconds our callback will be executed
            this.getConfig().getClient().getRecentlyAdded(new ICookbookCallback() {

                @Override
                public void execute(List&lt;Recipe&gt; recipes) throws Exception {
                    callback.process(recipes);
                }
            });

            if (Thread.interrupted()) {
                throw new InterruptedException();
            }
        }
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @SuppressWarnings("unchecked")
    @OAuthProtected
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().create(input), Map.class);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @OAuthProtected
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().update(input), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @OAuthProtected
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        return m.convertValue(this.getConfig().getClient().get(id), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @OAuthProtected
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        this.getConfig().getClient().delete(id);
    }

    /**
     * Description for queryPaginated
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:query-paginated}
     *
     *  @param query The query
     *  @param pagingConfiguration the paging configuration
     *  @return return comment
     */
    @OAuthProtected
    @Processor
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    @Paged                                                                                       <i class="conum" data-value="1"></i><b>(1)</b>
    public ProviderAwarePagingDelegate&lt;Map&lt;String, Object&gt;, CookbookConnector&gt; queryPaginated(   <i class="conum" data-value="2"></i><b>(2)</b>
            final String query, final PagingConfiguration pagingConfiguration)                   <i class="conum" data-value="3"></i><b>(3)</b>
            throws SessionExpiredException {
        return new CookbookPagingDelegate(query, pagingConfiguration.getFetchSize());
    }

    @Transformer(sourceTypes = { List.class })
    public static List&lt;Map&lt;String, Object&gt;&gt; recipesToMaps(List&lt;Recipe&gt; list) {
        ObjectMapper mapper = new ObjectMapper();
        List&lt;Map&lt;String, Object&gt;&gt; result = mapper.convertValue(list, new TypeReference&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;() {
        });
        return result;
    }

    @Transformer(sourceTypes = { Recipe.class })
    public static Map&lt;String, Object&gt; recipeToMap(Recipe recipe) {
        ObjectMapper mapper = new ObjectMapper();
        Map&lt;String, Object&gt; result = mapper.convertValue(recipe, new TypeReference&lt;Map&lt;String, Object&gt;&gt;() {
        });
        return result;
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check <a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v9/CookbookConnector.java">full source</a> code.</p>
</div>
<div class="paragraph">
<p>See:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="authentication.html">Authentication</a> documentation.</p>
</li>
<li>
<p><a href="oauth-v2.html">OAuth V2</a>.</p>
</li>
<li>
<p><a href="#mutiple-connection-strategies">Supporting Multiple Connection Strategies</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mutiple-connection-strategies"><a class="anchor" href="#mutiple-connection-strategies"></a>Multiple Configurations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to have multiple connection configurations there are two things to take into account:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>All Configurations either need to implement the same interface or have a common parent class.</p>
</li>
<li>
<p>The connector Config field needs to be declared either as the interface or as the common parent class.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If your configuration has common fields, they can be defined at a parent class.</p>
</div>
<div class="paragraph">
<p>In our connector, after the refactor the classes would look like this:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/model.png" alt="uml-model">
</div>
</div>
<div class="paragraph">
<p>See:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v9/CookbookConnector.java">Connector</a> source code.</p>
</li>
<li>
<p><a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v9/ConnectorConfig.java">Base Config</a> source code.</p>
</li>
<li>
<p><a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v9/ConnectionManagementConfig.java">Connection Management Config</a> source code.</p>
</li>
<li>
<p><a href="https://github.com/mulesoft/mule-cookbook-tutorial/blob/master/src/main/asciidoc/resources/java/v9/OAuthConfig.java">OAuth2 Config</a> source code.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="adding-source"><a class="anchor" href="#adding-source"></a>Adding @Source</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="what-is-a-source"><a class="anchor" href="#what-is-a-source"></a>What is a Source?</h3>
<div class="paragraph">
<p>In some cases it is necessary to create Message Sources instead of Message Processors.</p>
</div>
<div class="paragraph">
<p>Basically, a Message Source receives or generates new messages to be processed by Mule.
One of the use cases for a Message Source is implementing Streaming APIs. The <code>@Source</code> annotation marks a method inside a <code>@Connector</code> annotated class as callable from a Mule flow and capable of generating Mule events. Each marked method will have a Message Source generated. The method must receive a SourceCallback as one of its arguments that represents the next message processor in the chain. It does not matter the order in which this parameter appears as long it is present in the method signature.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementing-a-message-source"><a class="anchor" href="#implementing-a-message-source"></a>Implementing a Message Source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As an example, we are going to use the GetRecentlyAdded method.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Inside your <code>@Connector</code> type source and use Ctrl + Space bar to display the templates.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/source-template.png" alt="source template" width="600">
</div>
</div>
</li>
<li>
<p>Create a <code>@Source</code> that consumes the Get Recently Updated on the Connector using a callback</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;
import java.util.Map;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.Source;
import org.mule.api.annotations.SourceStrategy;
import org.mule.api.annotations.Transformer;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.api.callback.SourceCallback;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.client.ICookbookCallback;
import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for getRecentlyAddedSource
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAddedSource}
     *
     * @param callback
     *            The callback that will hook the result into mule event.
     * @throws Exception
     *             When the source fails.
     */
    @Source(sourceStrategy = SourceStrategy.POLLING, pollingPeriod = 10000)
    public void getRecentlyAddedSource(final SourceCallback callback) throws Exception {

        if (this.getConfig().getClient() != null) {
            // Every 10 seconds our callback will be executed
            this.getConfig().getClient().getRecentlyAdded(new ICookbookCallback() {

                @Override
                public void execute(List&lt;Recipe&gt; recipes) throws Exception {
                    callback.process(recipes);
                }
            });

            if (Thread.interrupted()) {
                throw new InterruptedException();
            }
        }
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().create(input), Map.class);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().update(input), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        return m.convertValue(this.getConfig().getClient().get(id), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        this.getConfig().getClient().delete(id);
    }

    @Transformer(sourceTypes = { List.class })
    public static List&lt;Map&lt;String, Object&gt;&gt; transformJsonToRecipeList(List&lt;Recipe&gt; list) {
        ObjectMapper mapper = new ObjectMapper();
        List&lt;Map&lt;String, Object&gt;&gt; result = mapper.convertValue(list, new TypeReference&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;() {
        });
        return result;
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>Install this new version</p>
</li>
<li>
<p>On your flow now just drag and drop the Cookbook Connector, and you will see that is automatically while generate a flow.</p>
<div class="imageblock">
<div class="content">
<img src="./_images/source-example.png" alt="source example" width="600">
</div>
</div>
</li>
<li>
<p>Add a logger and debug to see that the payload now has your recipes.</p>
<div class="exampleblock ex">
<div class="content">
<h3 id="mule-app-2" class="discrete view">Mule App</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/source-debug.png" alt="source debug" width="600">
</div>
</div>
<h3 id="xml-2" class="discrete view">XML</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;mule xmlns:tracking="http://www.mulesoft.org/schema/mule/ee/tracking" xmlns:cookbook="http://www.mulesoft.org/schema/mule/cookbook" xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans" version="EE-3.6.1"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/cookbook http://www.mulesoft.org/schema/mule/cookbook/current/mule-cookbook.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd
http://www.mulesoft.org/schema/mule/ee/tracking http://www.mulesoft.org/schema/mule/ee/tracking/current/mule-tracking-ee.xsd"&gt;
    &lt;cookbook:config name="CookBook__Connection_Management_Config" username="admin" password="admin" doc:name="CookBook: Connection Management Config"/&gt;
    &lt;flow name="source-get-recently-added"&gt;
        &lt;cookbook:get-recently-added-source config-ref="CookBook__Connection_Management_Config" doc:name="CookBook (Streaming)"/&gt;
        &lt;logger message="#[payload]" level="INFO" doc:name="Logger"/&gt;
    &lt;/flow&gt;
&lt;/mule&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about-adding-a-transformer"><a class="anchor" href="#about-adding-a-transformer"></a>About Adding a Transformer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Transformers convert message payloads to formats expected by their destinations. Mule ESB provides many standard transformers, which users can configure using elements and attributes in a Mule XML configuration file.</p>
</div>
<div class="paragraph">
<p>Sometimes it&#8217;s useful to build your own custom transformers.</p>
</div>
<div class="paragraph">
<p>Annotating a method with @Transformer signals the DevKit to export a method functionality as a transformer. You need to declare Transformers in classes annotated with @Module or @Connector and you can declare more than one transformer in a single class. It is possible to declare transformers, message processors, and message sources all in the same class.</p>
</div>
<div class="paragraph">
<p>A <code>@Transformer</code> annotated method must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Be static</p>
</li>
<li>
<p>Be public</p>
</li>
<li>
<p>Not return void</p>
</li>
<li>
<p>Not return java.lang.Object</p>
</li>
<li>
<p>Receive exactly one argument</p>
</li>
<li>
<p>Be inside a class annotated with <code>@Connector</code></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="creating-a-transformer"><a class="anchor" href="#creating-a-transformer"></a>Creating a Transformer</h3>
<div class="paragraph">
<p>In our case, we are creating a transformer that converts a List&lt;Recipe&gt; into a List&lt;Map&lt;String,Object&gt;&gt;, that way we don&#8217;t need to modify our existing operation, and yet we can use the output of it in operations that receive a List&lt;Map&lt;String,Object&gt;&gt;.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;
import java.util.Map;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.Transformer;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;

import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().create(input), Map.class);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().update(input), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        return m.convertValue(this.getConfig().getClient().get(id), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        this.getConfig().getClient().delete(id);
    }

    @Transformer(sourceTypes = { List.class })
    public static List&lt;Map&lt;String, Object&gt;&gt; transformJsonToComments(List&lt;Recipe&gt; list) {
        ObjectMapper mapper = new ObjectMapper();
        List&lt;Map&lt;String, Object&gt;&gt; result = mapper.convertValue(list, new TypeReference&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;() {
        });
        return result;
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-your-transformer-in-a-mule-app"><a class="anchor" href="#using-your-transformer-in-a-mule-app"></a>Using Your Transformer in a Mule App</h3>
<div class="paragraph">
<p>To use your transformer, just drag and drop it from the palette and build a flow.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Here we are using it explicitly to map transform the recipes into a Map.</p>
<div class="exampleblock ex">
<div class="content">
<h3 id="mule-app-3" class="discrete view">Mule App</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/transformer-explicit.png" alt="transformer explicit" width="600">
</div>
</div>
<h3 id="xml-3" class="discrete view">XML</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;mule xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:cookbook="http://www.mulesoft.org/schema/mule/cookbook" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans" version="EE-3.6.1"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/cookbook http://www.mulesoft.org/schema/mule/cookbook/current/mule-cookbook.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd"&gt;
    &lt;cookbook:config name="CookBook__Connection_Management_Config" username="admin" password="admin" doc:name="CookBook: Connection Management Config"&gt;
        &lt;reconnect/&gt;
    &lt;/cookbook:config&gt;
    &lt;http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration"/&gt;

    &lt;flow name="mule-appFlow"&gt;
        &lt;http:listener config-ref="HTTP_Listener_Configuration" path="/transform" doc:name="HTTP"/&gt;
        &lt;cookbook:get-recently-added config-ref="CookBook__Connection_Management_Config" doc:name="CookBook"/&gt;
        &lt;cookbook:recipes-to-maps doc:name="CookBook"/&gt;
        &lt;json:object-to-json-transformer doc:name="Object to JSON"/&gt;
    &lt;/flow&gt;
&lt;/mule&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Transformers can also be used implicitly as long as only one transformer is found to resolve the type.</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Define another transformer that can transform Recipe object into Map&lt;String,Object&gt;</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook;

import java.util.List;
import java.util.Map;

import org.mule.api.annotations.Config;
import org.mule.api.annotations.Connector;
import org.mule.api.annotations.MetaDataScope;
import org.mule.api.annotations.Paged;
import org.mule.api.annotations.Processor;
import org.mule.api.annotations.ReconnectOn;
import org.mule.api.annotations.Source;
import org.mule.api.annotations.SourceStrategy;
import org.mule.api.annotations.Transformer;
import org.mule.api.annotations.lifecycle.OnException;
import org.mule.api.annotations.param.Default;
import org.mule.api.annotations.param.MetaDataKeyParam;
import org.mule.api.annotations.param.MetaDataKeyParamAffectsType;
import org.mule.api.annotations.param.RefOnly;
import org.mule.api.callback.SourceCallback;
import org.mule.modules.cookbook.config.ConnectorConfig;
import org.mule.modules.cookbook.datasense.DataSenseResolver;
import org.mule.modules.cookbook.handler.CookbookHandler;
import org.mule.modules.cookbook.pagination.CookbookPagingDelegate;
import org.mule.streaming.PagingConfiguration;
import org.mule.streaming.ProviderAwarePagingDelegate;

import com.cookbook.tutorial.client.ICookbookCallback;
import com.cookbook.tutorial.service.CookBookEntity;
import com.cookbook.tutorial.service.Ingredient;
import com.cookbook.tutorial.service.InvalidEntityException;
import com.cookbook.tutorial.service.NoSuchEntityException;
import com.cookbook.tutorial.service.Recipe;
import com.cookbook.tutorial.service.SessionExpiredException;
import com.fasterxml.jackson.core.type.TypeReference;
import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * Anypoint Connector
 *
 * @author MuleSoft, Inc.
 */
@Connector(name = "cookbook", friendlyName = "Cookbook")
@MetaDataScope(DataSenseResolver.class)
public class CookbookConnector {

    @Config
    ConnectorConfig config;

    /**
     * Returns the list of recently added recipes
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAdded}
     *
     * @return A list of the recently added recipes
     */
    @Processor
    public List&lt;Recipe&gt; getRecentlyAdded() {
        return config.getClient().getRecentlyAdded();
    }

    /**
     * Description for getRecentlyAddedSource
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:getRecentlyAddedSource}
     *
     * @param callback
     *            The callback that will hook the result into mule event.
     * @throws Exception
     *             When the source fails.
     */
    @Source(sourceStrategy = SourceStrategy.POLLING, pollingPeriod = 10000)
    public void getRecentlyAddedSource(final SourceCallback callback) throws Exception {

        if (this.getConfig().getClient() != null) {
            // Every 5 seconds our callback will be executed
            this.getConfig().getClient().getRecentlyAdded(new ICookbookCallback() {

                @Override
                public void execute(List&lt;Recipe&gt; recipes) throws Exception {
                    callback.process(recipes);
                }
            });

            if (Thread.interrupted()) {
                throw new InterruptedException();
            }
        }
    }

    /**
     * Description for create
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:create}
     *
     * @param entity
     *            Ingredient to be created
     * @return return Ingredient with Id from the system.
     *
     * @throws InvalidTokenException
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; create(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().create(input), Map.class);
    }

    /**
     * Description for update
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:update}
     *
     * @param entity
     *            Ingredient to be updated
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; update(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.BOTH) String type, @Default("#[payload]") @RefOnly Map&lt;String, Object&gt; entity)
            throws InvalidEntityException, SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        CookBookEntity input = null;
        if (type.contains("com.cookbook.tutorial.service.Recipe")) {
            input = m.convertValue(entity, Recipe.class);
        } else if (type.contains("com.cookbook.tutorial.service.Ingredient")) {
            input = m.convertValue(entity, Ingredient.class);
        } else {
            throw new InvalidEntityException("Don't know how to handle type:" + type);
        }
        return m.convertValue(this.getConfig().getClient().update(input), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws InvalidEntityException
     * @throws NoSuchEntityException
     */
    @SuppressWarnings("unchecked")
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public Map&lt;String, Object&gt; get(@MetaDataKeyParam(affects = MetaDataKeyParamAffectsType.OUTPUT) String type, @Default("1") Integer id) throws InvalidEntityException,
            SessionExpiredException, NoSuchEntityException {
        ObjectMapper m = new ObjectMapper();
        return m.convertValue(this.getConfig().getClient().get(id), Map.class);
    }

    /**
     * Description for get
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:get}
     *
     * @param id
     *            Id of the entity to retrieve
     * @return return Ingredient with Id from the system.
     *
     * @throws SessionExpiredException
     * @throws NoSuchEntityException
     */
    @Processor
    @OnException(handler = CookbookHandler.class)
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    public void delete(@Default("1") Integer id) throws NoSuchEntityException, SessionExpiredException {
        this.getConfig().getClient().delete(id);
    }

    /**
     * Description for queryPaginated
     *
     * {@sample.xml ../../../doc/cook-book-connector.xml.sample cook-book:query-paginated}
     *
     *  @param query The query
     *  @param pagingConfiguration the paging configuration
     *  @return return comment
     */
    @Processor
    @ReconnectOn(exceptions = { SessionExpiredException.class })
    @Paged <i class="conum" data-value="1"></i><b>(1)</b>
    public ProviderAwarePagingDelegate&lt;Map&lt;String, Object&gt;, CookbookConnector&gt; queryPaginated( <i class="conum" data-value="2"></i><b>(2)</b>
            final String query, final PagingConfiguration pagingConfiguration) <i class="conum" data-value="3"></i><b>(3)</b>
            throws SessionExpiredException {
        return new CookbookPagingDelegate(query, pagingConfiguration.getFetchSize());
    }

    @Transformer(sourceTypes = { List.class })
    public static List&lt;Map&lt;String, Object&gt;&gt; recipesToMaps(List&lt;Recipe&gt; list) {
        ObjectMapper mapper = new ObjectMapper();
        List&lt;Map&lt;String, Object&gt;&gt; result = mapper.convertValue(list, new TypeReference&lt;List&lt;Map&lt;String, Object&gt;&gt;&gt;() {
        });
        return result;
    }

    @Transformer(sourceTypes = { Recipe.class })
    public static Map&lt;String, Object&gt; recipeToMap(Recipe recipe) {
        ObjectMapper mapper = new ObjectMapper();
        Map&lt;String, Object&gt; result = mapper.convertValue(recipe, new TypeReference&lt;Map&lt;String, Object&gt;&gt;() {
        });
        return result;
    }

    public ConnectorConfig getConfig() {
        return config;
    }

    public void setConfig(ConnectorConfig config) {
        this.config = config;
    }

}</code></pre>
</div>
</div>
</li>
<li>
<p>Install the connector.</p>
</li>
<li>
<p>In your mule app create a flow that takes the first item of the list and add an update operation after it. Don&#8217;t use the transformer.</p>
<div class="exampleblock ex">
<div class="content">
<h3 id="mule-app-4" class="discrete view">Mule App</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/transformer-implicitly.png" alt="transformer implicitly" width="600">
</div>
</div>
<h3 id="xml-4" class="discrete view">XML</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;mule xmlns:json="http://www.mulesoft.org/schema/mule/json" xmlns:cookbook="http://www.mulesoft.org/schema/mule/cookbook" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
      xmlns:spring="http://www.springframework.org/schema/beans" version="EE-3.6.1"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd
http://www.mulesoft.org/schema/mule/cookbook http://www.mulesoft.org/schema/mule/cookbook/current/mule-cookbook.xsd
http://www.mulesoft.org/schema/mule/json http://www.mulesoft.org/schema/mule/json/current/mule-json.xsd"&gt;
    &lt;cookbook:config name="CookBook__Connection_Management_Config" username="admin" password="admin" doc:name="CookBook: Connection Management Config"&gt;
        &lt;reconnect/&gt;
    &lt;/cookbook:config&gt;
    &lt;http:listener-config name="HTTP_Listener_Configuration" host="0.0.0.0" port="8081" doc:name="HTTP Listener Configuration"/&gt;

    &lt;flow name="mule-appFlow"&gt;
        &lt;http:listener config-ref="HTTP_Listener_Configuration" path="/transform" doc:name="HTTP"/&gt;
        &lt;cookbook:get-recently-added config-ref="CookBook__Connection_Management_Config" doc:name="CookBook"/&gt;
        &lt;!-- Get the first item of the list --&gt;
        &lt;set-payload value="#[payload.get(0)]" doc:name="Set Payload"/&gt;
        &lt;!-- This operation is expecting a Map. Not a Recipe, but we are not using the transformer in the flow. The transformer will be called automatically --&gt;
        &lt;cookbook:update config-ref="CookBook__Connection_Management_Config" type="com.cookbook.tutorial.service.Recipe#0" doc:name="CookBook"&gt;
            &lt;!-- Take the payload as input for the connector --&gt;
            &lt;cookbook:entity ref="#[payload]"/&gt;
        &lt;/cookbook:update&gt;
        &lt;json:object-to-json-transformer doc:name="Object to JSON"/&gt;
    &lt;/flow&gt;
&lt;/mule&gt;</code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Run the example and see that the flow will execute successfully.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-password"><a class="anchor" href="#using-password"></a>Using @Password</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When using the <code>@Password</code> in a @<code>Connect</code> parameters, it generates a masked input field in the UI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">/**
 * (c) 2003-2015 MuleSoft, Inc. The software in this package is published under the terms of the CPAL v1.0 license,
 * a copy of which has been included with this distribution in the LICENSE.md file.
 */

package org.mule.modules.cookbook.config;

import org.mule.api.ConnectionException;
import org.mule.api.ConnectionExceptionCode;
import org.mule.api.annotations.Configurable;
import org.mule.api.annotations.Connect;
import org.mule.api.annotations.ConnectionIdentifier;
import org.mule.api.annotations.Disconnect;
import org.mule.api.annotations.TestConnectivity;
import org.mule.api.annotations.ValidateConnection;
import org.mule.api.annotations.components.ConnectionManagement;
import org.mule.api.annotations.display.Password;
import org.mule.api.annotations.param.ConnectionKey;
import org.mule.api.annotations.param.Default;

import com.cookbook.tutorial.client.MuleCookBookClient;
import com.cookbook.tutorial.service.InvalidCredentialsException;

/**
 * Configuration type Config
 *
 * @author MuleSoft, Inc.
 */
@ConnectionManagement(friendlyName = "Configuration")
public class ConnectorConfig {

    /**
     * Connect
     *
     * @param username
     *            A username
     * @param password
     *            A password
     * @throws ConnectionException
     */
    @Connect
    @TestConnectivity
    public void connect(@ConnectionKey String username, @Password String password) throws ConnectionException {
        setClient(new MuleCookBookClient(getAddress()));
        try {
            getClient().login(username, password);
        } catch (InvalidCredentialsException e) {
            throw new ConnectionException(ConnectionExceptionCode.INCORRECT_CREDENTIALS, e.getMessage(), "Invalid credentials");
        }
    }

    /**
     * Disconnect
     */
    @Disconnect
    public void disconnect() {
        setClient(null);
    }

    /**
     * Are we connected
     */
    @ValidateConnection
    public boolean isConnected() {
        return getClient() != null;
    }

    /**
     * Id used only when debuging.
     */
    @ConnectionIdentifier
    public String connectionId() {
        return "001";
    }

    /**
     * Description for address
     */
    @Configurable
    @Default("http://devkit-cookbook.cloudhub.io/soap")
    private String address;

    public String getAddress() {
        return address;
    }

    public void setAddress(String address) {
        this.address = address;
    }

    private MuleCookBookClient client;

    public MuleCookBookClient getClient() {
        return client;
    }

    public void setClient(MuleCookBookClient client) {
        this.client = client;
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Studio this translates into:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/password.png" alt="password" width="500">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="build-a-connector-for-an-api"><a class="anchor" href="#build-a-connector-for-an-api"></a>Build a Connector for an API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>APIs are exposed in several ways. To start using your API, you should set up a few things before you can use it inside your connector.</p>
</div>
<div class="sect2">
<h3 id="sdk-client"><a class="anchor" href="#sdk-client"></a>SDK Client</h3>
<div class="paragraph">
<p>If you have an SDK all you need to do is to include the Maven dependency for your jar in the pom.xml</p>
</div>
<div class="paragraph">
<p>For example in our case, to consume the SDK for the Cookbook we can add the dependency.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
  &lt;dependency&gt;
    &lt;groupId&gt;foo.sdk.group.id&lt;/groupId&gt;
    &lt;artifactId&gt;foo.sdk.artifact.id&lt;/artifactId&gt;
    &lt;version&gt;${sdk.version}&lt;/version&gt;
  &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="soap-api"><a class="anchor" href="#soap-api"></a>SOAP API</h3>
<div class="paragraph">
<p>If you have a wsdl, the easiest way to build a connector is to create a client using CXF <a href="http://cxf.apache.org/docs/wsdl-to-java.html">wsdl2java</a>.</p>
</div>
<div class="paragraph">
<p>You can configure the CXF goal in your <code>pom.xml</code> file very easily. The full documentation is at the Apache  <a href="http://cxf.apache.org/docs/maven-cxf-codegen-plugin-wsdl-to-java.html">CXF site</a>.</p>
</div>
<div class="paragraph">
<p>For example, in your <code>pom.xml</code> file, you can add the following plus all required dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;build&gt;
  &lt;plugins&gt;
    &lt;!-- CXF Code generation --&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;
      &lt;artifactId&gt;cxf-codegen-plugin&lt;/artifactId&gt;
      &lt;version&gt;${cxf.version}&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;phase&gt;clean&lt;/phase&gt; &lt;!-- This is required for it to work with DevKit --&gt;
          &lt;goals&gt;
            &lt;goal&gt;wsdl2java&lt;/goal&gt;
          &lt;/goals&gt;
          &lt;configuration&gt;
            &lt;wsdlOptions&gt;
              &lt;wsdlOption&gt;
                &lt;wsdl&gt;${basedir}/src/main/resources/wsdl/IMuleCookBookService.wsdl&lt;/wsdl&gt;
                &lt;autoNameResolution&gt;true&lt;/autoNameResolution&gt;
                &lt;extendedSoapHeaders&gt;false&lt;/extendedSoapHeaders&gt;
                &lt;extraargs&gt;
                  &lt;extraarg&gt;-xjc-Xbg&lt;/extraarg&gt;
                   &lt;extraarg&gt;-xjc-Xcollection-setter-injector&lt;/extraarg&gt;
                  &lt;extraarg&gt;-p&lt;/extraarg&gt;
                  &lt;extraarg&gt;org.mule.modules.wsdl.api&lt;/extraarg&gt;
                &lt;/extraargs&gt;
              &lt;/wsdlOption&gt;
            &lt;/wsdlOptions&gt;
          &lt;/configuration&gt;
         &lt;/execution&gt;
      &lt;/executions&gt;
      &lt;dependencies&gt;
        &lt;!-- Boolean Getters --&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;org.apache.cxf.xjcplugins&lt;/groupId&gt;
          &lt;artifactId&gt;cxf-xjc-boolean&lt;/artifactId&gt;
          &lt;version&gt;${cxf.version.boolean}&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;!-- Collection Setters --&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;net.java.dev.vcc.thirdparty&lt;/groupId&gt;
          &lt;artifactId&gt;collection-setter-injector&lt;/artifactId&gt;
          &lt;version&gt;0.5.0-1&lt;/version&gt;
        &lt;/dependency&gt;
      &lt;/dependencies&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you use the DevKit plugin it generates everything for you to get started, you just need to specify the WSDL location on your computer.</p>
</div>
</div>
<div class="sect2">
<h3 id="rest-api"><a class="anchor" href="#rest-api"></a>REST API</h3>
<div class="paragraph">
<p>Write the request using any library that helps you make HTTP Requests.</p>
</div>
<div class="paragraph">
<p>We recommend using Jersey 2.11, which is provided in Mule version 3.6.0 and later.</p>
</div>
<div class="paragraph">
<p>To make sure you always use the right version, add the following dependency to your connector <code>pom.xml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mule.modules&lt;/groupId&gt;
        &lt;artifactId&gt;mule-module-jersey&lt;/artifactId&gt;
        &lt;version&gt;${mule.version}&lt;/version&gt;
        &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example GET request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">ClientConfig clientConfig = new ClientConfig();
Client client = ClientBuilder.newClient(clientConfig);
WebTarget webTarget = client.target("http://example.com/rest"); // <i class="conum" data-value="1"></i><b>(1)</b>
WebTarget resourceWebTarget = webTarget.path("resource");
WebTarget helloworldWebTarget = resourceWebTarget.path("helloworld"); // <i class="conum" data-value="2"></i><b>(2)</b>
WebTarget helloworldWebTargetWithQueryParam =
        helloworldWebTarget.queryParam("greeting", "Hi World!"); // <i class="conum" data-value="3"></i><b>(3)</b>

Invocation.Builder invocationBuilder =
        helloworldWebTargetWithQueryParam.request(MediaType.APPLICATION_JSON_TYPE); // <i class="conum" data-value="4"></i><b>(4)</b>

Response response = invocationBuilder.get(); // <i class="conum" data-value="5"></i><b>(5)</b>
System.out.println(response.getStatus());
System.out.println(response.readEntity(String.class));</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The client is ready to make a request to URL <code>http://example.com/rest</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add paths for <code>http://example.com/rest/resource/helloworld</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Configure a query param. It looks like <code>http://example.com/rest/resource/helloworld?greeting=Hi+World%21</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Specify we want the reply in JSON format</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Make a GET request</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="rest-server-for-cookbook"><a class="anchor" href="#rest-server-for-cookbook"></a>REST Server for Cookbook</h3>
<div class="paragraph">
<p>If testing the three resources included in the Cookbook REST server, set up your connector to be SDK-based and select OAuth v2 as the authentication mechanism.</p>
</div>
<div class="paragraph">
<p>For more information, see the <a href="https://jersey.java.net/documentation/latest/client.html">Jersey client</a> documentation.</p>
</div>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../_theme/scripts/menu.js"></script>
<script src="../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
