<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="oauth v2, devkit, authentication, connector, api">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/anypoint-connector-devkit/3.8/oauth-v2.html">
  <link rel="stylesheet" href="../../_theme/stylesheets/theme.css">
  <title>OAuth V2 // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="index.html">Anypoint Connector DevKit</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="anypoint-connector-development.html">Getting Started with Anypoint Connector Development</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="setting-up-your-dev-environment.html">Setting Up Your Development Environment</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="devkit-tutorial.html">Anypoint Connector DevKit Tutorial</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-project-structure.html">Connector Project Structure</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="annotation-reference.html">DevKit Java Annotation Reference</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="creating-an-anypoint-connector-project.html">Creating an Anypoint Connector Project</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="setting-up-api-access.html">Setting up API Access</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-connection-strategies.html">Configuring Connection Strategies</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="authentication.html">Supporting Authentication</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="authentication-methods.html">Authentication Methods</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="oauth-v1.html">OAuth V1</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="oauth-v2.html">OAuth V2</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="http-basic-authentication.html">HTTP Basic Authentication</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="connection-management.html">Connection Management</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="no-authentication.html">No Authentication</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="creating-a-java-sdk-based-connector.html">Creating a Java SDK-Based Connector</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="creating-a-connector-using-a-java-sdk.html">Java SDK-Based Connector Example</a>
                                      </li>
                                  </ul>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                  <button class="nav-tgl"></button>
                                <a class="nav-lnk" href="creating-a-soap-connector.html">Creating a SOAP Connector</a>
                                  <ul class="nav-lst">
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="soap-connect-session-management.html">SOAP Session Management</a>
                                      </li>
                                      <li class="nav-itm" data-depth="3" data-state="collapsed">
                                        <a class="nav-lnk" href="creating-a-connector-for-a-soap-service-via-cxf-client.html">Creating a Connector for a SOAP Service Via CXF Client - Legacy</a>
                                      </li>
                                  </ul>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="connector-attributes-and-operations.html">Adding Connector Functionality</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-message-sources.html">Defining Message Sources</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="creating-message-processors.html">Creating Message Processors</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-connector-attributes.html">Defining Connector Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="complex-data-types-attributes.html">Complex Data Types Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="mime-type-and-encoding.html">MIME Type and Encoding</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="extending-connector-functionality.html">Extending Connector Functionality</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-datasense.html">Adding DataSense</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="multiple-level-datasense-support.html">Multiple Level DataSense Support</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-datasense-query-language.html">Adding DataSense Query Language</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-query-pagination-support.html">Adding Query Pagination Support</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="building-a-batch-enabled-connector.html">Building a Batch Enabled Connector</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="shading-libraries.html">Shading Libraries</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="adding-libraries.html">Adding Libraries or JARs to Connector Build</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="developing-devkit-connector-tests.html">Developing DevKit Connector Tests</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-testing-framework.html">Connector Testing Framework</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="installing-and-testing-your-connector-in-studio.html">Installing and Testing Your Connector in Studio</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="connector-reference-documentation.html">Creating Connector Reference Documentation</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="packaging-your-connector-for-release.html">Packaging Your Connector for Release</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="connector-certification-program-guidelines.html">Connector Certification Program Guidelines</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="certified-connector-license-management.html">MuleSoft Certified Connector License Management</a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">OAuth V2</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/anypoint-connector-devkit-docs/edit/v3.8/modules/ROOT/content/oauth-v2.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>OAuth V2</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This page presents a detailed discussion of DevKit&#8217;s support for OAuth V2 authentication and how to implement a connector that uses OAuth V2 to authenticate with your API.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="prerequisites"><a class="anchor" href="#prerequisites"></a>Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document assumes you are familiar with the  <a href="../../anypoint-studio/5/index.html">Anypoint Connector Essentials</a>  and are ready to implement authentication on your connector. It assumes you are familiar with the various  <a href="authentication-methods.html">authentication methods</a> and may be using OAuth V1 to authenticate with your API.</p>
</div>
<div class="paragraph">
<p>If you are not familiar with OAuth V1 authentication, what it is or how it works, we recommend visiting link:
<a href="http://tools.ietf.org/html/rfc5849">OAuth 1.0 protocol/RFC-5849</a>. Also see <a href="oauth-v1.html">OAuth V1</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="required-api-information"><a class="anchor" href="#required-api-information"></a>Required API Information</h2>
<div class="sectionbody">
<div class="paragraph">
<p>From the service provider&#8217;s API documentation, obtain the precise values for the variables listed in the table below. These variables reference URLs that are employed during the authorization process; for details on these steps of the process, consult the <a href="http://tools.ietf.org/html/rfc6749">OAuth 2 specification</a>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>accessTokenUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL from which to obtain the access token</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authorizationUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL from which to obtain authorization to resource access</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="oauth2-annotation"><a class="anchor" href="#oauth2-annotation"></a>@OAuth2 Annotation</h3>
<div class="paragraph">
<p>To implement OAuth V2 authentication on your Connector you need to create a new <code>@Config</code>. Create a new class and annotate it with the the <code>@OAuth2</code> annotation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
During the building process, a connector annotated with <code>@OAuth2</code> gets two additional auto-generated <code>@Processor</code> methods called  <code>authorize</code>  and  <code>unauthorize</code> . These message processors are in charge of initiating and ending the OAuth session.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following table describes all parameters for the <code>@OAuth2</code> annotation.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 10%;">
<col style="width: 15%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Parameter</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
<th class="tableblock halign-left valign-top"><strong>Required?</strong></th>
<th class="tableblock halign-left valign-top"><strong>Default Value</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>friendlyName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the name that is going to be displayed in the connector configuration pop up.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✓</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>configElementName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the name for the configuration to be used in the Mule app.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>config</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>accessTokenUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URL defined by the service provider to obtain an access token.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✓</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authorizationUrl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defined by the service provider, the URL where the resource owner is redirected in order to grant authorization to the consumer. You can override this value when configuring the processor by setting a different value in the <code>config</code> element. When creating a flow, you can override this value by entering your desired value in the <code>authorize</code> element.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">✓</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>authorizationParameters</code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Comma-delimited list of annotations, in the form:</p>
</div>
<div class="paragraph">
<p><code>@OAuthAuthorizationParameter(name = "xxx", type = xxx, description = "xxx", optional = true)</code></p>
</div>
<div class="paragraph">
<p>The type cannot be a collection or a complex type.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>verifierRegex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Java regular expression to extract the verifier from the service provider response, after the resource owner authorizes the consumer.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>code=([^&amp;]+)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>accessTokenRegex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Java regular expression to extract the access token from the service provider response.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"access_token":"([^&amp;]+?)"</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>expirationRegex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Java regular expression to extract the expiration time of the access token (in seconds) from the service provider response. If this regular expression is not found in the service provider response (because the regular expression is wrong or the access token never expires), the access token is treated as if it would never expire.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"expires_in":([^&amp;]+?),</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>refreshTokenRegex</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Java regular expression to extract a refresh token from the callback during the authorization flow.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>"\"refresh_token\":\"([^&amp;]+?)\""</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>callbackPath</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the service provider only accepts a known redirect URL. Assign this parameter to the path inside your domain (denoted by the  <code>fullDomain</code>  environment variable) that will be registered with the service provider as a redirect URL. If left empty (meaning the service provider accepts any URL as redirect URL), Mule uses a random path.</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;random path&gt;</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="adding-oauth2-to-your-connector"><a class="anchor" href="#adding-oauth2-to-your-connector"></a>Adding @OAuth2 to your @Connector</h3>
<div class="paragraph">
<p>To add OAuth V2 to a connector:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a connection strategy:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Connector(name = "oauth2connector")
public class MyConnector
{
    @ConnectionStrategy
    private OAuth2Strategy strategy;

    /**
    * YOUR CODE GOES HERE
    */
}</code></pre>
</div>
</div>
</li>
<li>
<p>Add the OAuth access URL, access token URL, and the OAuth strategy:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@OAuth2(authorizationUrl = "http://someUrl", accessTokenUrl = "http://someOtherUrl")
public class OAuth2Strategy
{
    /**
     * The OAuth2 consumer key
     */
    @Configurable
    @OAuthConsumerKey
    private String consumerKey;

    /**
     * The OAuth2 consumer secret
     */
    @Configurable
    @OAuthConsumerSecret
    private String consumerSecret;

    /**
    * YOUR CODE GOES HERE
    */
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="oauth2-class-properties"><a class="anchor" href="#oauth2-class-properties"></a>@OAuth2 Class Properties</h3>
<div class="paragraph">
<p>Your Strategy class needs <code>@Configurable</code> instance properties to allow the user to specify their private consumer key and secret when using the connector as shown above:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@OAuthConsumerKey</code> to hold the OAuth consumer key</p>
</li>
<li>
<p><code>@OAuthConsumerSecret</code> to hold the OAuth consumer secret</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Ensure these instance variables have public getters and setters (not shown).</p>
</div>
</div>
<div class="sect2">
<h3 id="processor-method-annotations"><a class="anchor" href="#processor-method-annotations"></a>@Processor Method Annotations</h3>
<div class="paragraph">
<p>In the methods that access the protected resources (annotated with <code>@Processor</code>), add one String parameter and annotate it with <code>@OAuthAccessToken</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Processor
public Object accessProtectedResource(@OAuthAccessToken String accessToken, ...)
{
    /**
    * YOUR PROCESSOR CODE GOES HERE
    */
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When invoked, a method that contains parameters annotated with <code>@OAuthAccessToken</code> initiates the following activities:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The first time a protected resource is accessed, the user is redirected to the authorization URL of the service provider to grant or deny access for the consumer to the protected resource.</p>
</li>
<li>
<p>During subsequent access requests, Mule includes the <strong>access token</strong> (contained within the parameters annotated with <code>@OAuthAccessToken</code>) in the request to the service provider. Refer to <a href="http://oauth.net/2">Oauth 2.0 specification</a> for more details.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="access-token-expiration"><a class="anchor" href="#access-token-expiration"></a>Access Token Expiration</h3>
<div class="paragraph">
<p>If you have specified a proper regular expression (using the <code>expirationRegex</code> parameter for the <code>@OAuth2</code> annotation), and an API&#8217;s access token expires, Anypoint DevKit automatically detects the expiration and, in such cases, it triggers the OAuth2 authorization flow again.</p>
</div>
</div>
<div class="sect2">
<h3 id="client-class-changes-passing-the-access-token"><a class="anchor" href="#client-class-changes-passing-the-access-token"></a>Client Class Changes: Passing the Access Token</h3>
<div class="paragraph">
<p>The OAuth V2 support in Anypoint DevKit provides the support for OAuth2 in a @Connector. However, the client class may have to include logic to actually pass the access token with the request when it calls the web service. Because OAuth2 is not a formalized and strict standard, the specifics of how access tokens are passed with requests depends upon the implementation of the API.</p>
</div>
<div class="paragraph">
<p>The API provider provides sample code that illustrates how to pass tokens to their service. When implementing your client class, use the API provider&#8217;s sample code as a reference.</p>
</div>
<div class="paragraph">
<p>For example, Imagine that a service supports OAuth 2.0 authentication, and expects the client to pass the access token as a query parameter. This example shows how to achieve that using Devkit.</p>
</div>
<div class="paragraph">
<p>The connector passes the <code>accessToken</code> as a parameter to the client class operation <code>client.usersGetList()</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@OAuthProtected
@Processor
public UsersListResponse usersGetList(
    @Optional @Default("self") String userId,
    @Optional @Default("") String group,
    @Optional @Default("") String location)
  throws Oauth2ConnectorExampleTokenExpiredException,
         Oauth2ConnectorExampleException {
        return client.usersGetList(accessToken, userId, group, location);
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Other services require similar changes at the client level, but differ in details, such as sending the token as a header. Also, this example illustrates the use of OAuth 2 with a RESTful web service using the Jersey Client; for a SOAP-based web service, the client class changes are analogous, but the specifics are different.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-your-oauth2-authenticated-connector"><a class="anchor" href="#using-your-oauth2-authenticated-connector"></a>Using your OAuth2 Authenticated Connector</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="authorizing-the-connector"><a class="anchor" href="#authorizing-the-connector"></a>Authorizing the Connector</h3>
<div class="paragraph">
<p>Before a consumer can execute any operation that requires authorization, the resource owner must grant access to the connector to access the protected resource. When it receives an authorization request, Mule redirects the resource owner&#8217;s browser to the service provider authorization page. Any subsequent attempts to access a protected resource fills the parameters annotated with <code>@OAuthAccessToken</code>. Mule includes the access token in the request to the service provider:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;connector:config-oauth name="oauth2" consumerKey="[ckey]" consumerSecret="[csec]"/&gt;
...
&lt;flow name="authorize"&gt;
  &lt;http:listener config-ref="config" path="/authorize"&gt;
  &lt;connector:authorize config-ref="oauth2"/&gt;
&lt;/flow&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuring-your-connector"><a class="anchor" href="#configuring-your-connector"></a>Configuring your Connector</h3>
<div class="paragraph">
<p>Configure the connector by passing the <code>apiKey</code> consumer key and <code>apiSecret</code> consumer secret for your application as supplied by the service provider:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">...
&lt;oauth2module:config apiKey="${api.key}" apiSecret="${api.secret}"/&gt;
...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="customizing-the-callback"><a class="anchor" href="#customizing-the-callback"></a>Customizing the Callback</h3>
<div class="paragraph">
<p>When a user grants access to the protected resource, the service provider makes an HTTP callback.</p>
</div>
<div class="paragraph">
<p>The callback passes an authorization code that Mule uses later to obtain the access token. To handle the callback, Mule dynamically creates an HTTP inbound endpoint, then passes the endpoint&#8217;s URL to the service provider. Thus, you do not need to complete any specific configuration to make an HTTP callback.</p>
</div>
<div class="paragraph">
<p>By default, Mule uses a host and port (determined by the <code>fullDomain</code> environment variable and the <code>http.port</code>) to construct a URL to send to the service provider. Where you need to use non-default values for host and port, add the configuration:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;connector:config-oauth name="oauth2" consumerKey="[ckey]" consumerSecret="[csec]"&gt;
  &lt;connector:oauth-callback-config domain="SOME_DOMAIN" localPort="SOME_PORT" path="SOME_PATH"/&gt;
&lt;/connector:config-oauth&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-secure-socket-layer-ssl"><a class="anchor" href="#adding-secure-socket-layer-ssl"></a>Adding Secure Socket Layer (SSL)</h3>
<div class="paragraph">
<p>When Mule automatically launches an HTTP listener request to handle the OAuth callback, it uses the HTTP connector by default. Where the service provider requires <strong>HTTPS</strong>, you can configure Mule to pass your own HTTPS connector:<br></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">...
&lt;http:listener-config name="configuration" protocol="HTTPS"
  host="localhost" port="8081"&gt;
  &lt;https:tls-key-store path="keystore.jks" keyPassword="mule2015"
    storePassword="mule2015"/&gt;
&lt;/http:listener-config&gt;
...
&lt;connector:config-oauth name="oauth2" apiKey="${api.key}" apiSecret="${api.secret}"&gt;
  &lt;connector:oauth-callback-config domain="localhost" localPort="${http.port}" remotePort="${http.port}" async="true" connector-ref="httpsConnector"/&gt;
&lt;/connector:config-oauth&gt;
...</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>See Also</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="../../mule-runtime/3.7/connectors/http/http-connector-reference.html">HTTPS Connector Reference</a></p>
</li>
<li>
<p><a href="../../mule-runtime/3.7/connectors/tls/tls-configuration.html">HTTPS Examples</a></p>
</li>
</ul>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../_theme/scripts/menu.js"></script>
<script src="../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
