<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/anypoint-connector-devkit/3.2/error-handling.html">
  <link rel="stylesheet" href="../../_theme/stylesheets/theme.css">
  <title>Error Handling // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="index.html">Anypoint Connector Devkit</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="mule-devkit.html">Mule DevKit</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="how-the-devkit-works.html">How the DevKit Works</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="creating-message-sources.html">Creating Message Sources</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="your-first-cloud-connector.html">Your First Cloud Connector</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="authorizing-your-connector-with-oauth-1.0a.html">Authorizing your Connector with OAuth 1.0a</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="authorizing-your-connector-with-oauth-2.0.html">Authorizing your Connector with Oauth 2.0</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="configuring-extensions.html">Configuring Extensions</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="creating-transformers.html">Creating Transformers</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="managing-connections.html">Managing Connections</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="nesting-message-processors.html">Nesting Message Processors</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="inbound-headers.html">Inbound Headers</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="invocation-headers.html">Invocation Headers</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="outbound-headers.html">Outbound Headers</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="using-the-cloud-connector-archetype.html">Using the Cloud Connector Archetype</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="injecting-mule-managers.html">Injecting Mule Managers</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="injecting-the-payload.html">Injecting the Payload</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="customizing-mule-studio-integration.html">Customizing Mule Studio integration</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="handling-collections.html">Handling Collections</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="handling-enums.html">Handling Enums</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="pooling-modules.html">Pooling Modules</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="handling-http-callbacks.html">Handling HTTP Callbacks</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="glossary.html">Publish</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="packaging-mule-extensions.html">Packaging Mule Extensions</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="testing-extensions.html">Testing Extensions</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="required-javadoc.html">Required JavaDoc</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="taking-advantage-of-mule-lifecycle.html">Taking Advantage of Mule Lifecycle</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="glossary.html">Glossary</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="../3.3/devkit-error-handling.html">Error Handling</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="writing-extensions-in-eclipse.html">Writing Extensions in Eclipse</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="writing-extensions-in-intellij.html">Writing Extensions in IntelliJ</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="contribute.html">Contribute</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="additional-resources.html">Additional Resources</a>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">Error Handling</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/anypoint-connector-devkit-docs/edit/v3.2/modules/ROOT/content/error-handling.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>Error Handling</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Mule Runtime provides several error handling options. You can configure <strong>Exception Strategies</strong> to cover flows, models, or individual services. You can use the <strong>Exception Router</strong> to specify where a message gets sent when an error occurs during message processing. You can also use the <strong>Exception Type</strong> filter for fine-grained control.</p>
</div>
<div class="paragraph">
<p>This page describes these various error handling techniques. For information on setting retry policies, which control how a connector behaves when its connection fails, see <a href="../../mule-runtime/3.2/mule-configuration/configuring-reconnection-strategies.html">Configuring Reconnection Strategies</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="exception-strategies"><a class="anchor" href="#exception-strategies"></a>Exception Strategies</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Exception Strategies</strong> handle the exception conditions that arise when an error occurs during the processing of a message. You can set exception strategies to cover the following scopes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>On a <strong>flow</strong> to set a common exception strategy for all message processors within that flow.</p>
</li>
<li>
<p>On a <strong>model</strong> to set a common exception strategy for all services within that model.</p>
</li>
<li>
<p>On a <strong>service</strong> to set an exception strategy for any exception within that service.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Component Exception Strategies</strong> handle <strong>component exceptions</strong>, which occur when a message is being processed though Mule. Typically, you customize an exception handler to control how component exceptions are logged and routed. Only <strong>system exceptions</strong>, which typically occur during connection initialization or disconnection, do not qualify as component exceptions.</p>
</div>
<div class="paragraph">
<p><strong>System Exception Strategies</strong> serve as a fallback to catch the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Exceptions that occur at startup</p>
</li>
<li>
<p>Connection attempts that fail</p>
</li>
<li>
<p>Exceptions not associated with a flow or service, which therefore cannot use a component exception strategy</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Typically, few, if any, options exist beyond logging system exceptions. Therefore, customization of a system exception strategy is generally not necessary.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For details on configuring exception strategies, see: <a href="../../mule-runtime/3.2/exceptions/exception-strategy-configuration-reference.html">Exception Strategy Configuration Reference</a>.<br>
<br>
For examples of the most common exception strategy configurations, see <a href="../../mule-runtime/3.2/exceptions/exception-strategy-most-common-use-cases.html">Exception Strategy Most Common Use Cases</a>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="specifying-exception-strategies"><a class="anchor" href="#specifying-exception-strategies"></a>Specifying Exception Strategies</h3>
<div class="paragraph">
<p>The default exception strategy is <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/exception/DefaultServiceExceptionStrategy.html">org.mule.exception.DefaultServiceExceptionStrategy</a>, which you configure with the <code>&lt;default-service-exception-strategy&gt;</code> element.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<strong>[Mule 3.2]</strong> DefaultServiceExceptionStrategy, which is shared by both the flow and the service approaches to configuration, is now named:<br>
<br>
<a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/exception/DefaultMessagingExceptionStrategy.html">org.mule.exception.DefaultMessagingExceptionStrategy</a> .
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To configure the default exception strategy so that it applies to all the message processors within a flow, insert the element <em>after</em> all the message processors (i.e., at the end of the flow):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;flow name="CreditCheck"&gt;
  &lt;http:inbound-endpoint exchange-pattern="request-response" host="localhost" port="8080"/&gt;
  &lt;logger message="#[payload]" level="INFO"/&gt;
...
  &lt;default-exception-strategy&gt;
    &lt;vm:outbound-endpoint path="systemErrorHandler"/&gt;
  &lt;/default-exception-strategy&gt;
&lt;/flow&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To configure the default exception strategy so that it applies to all the services within a model, insert the element <em>before</em> all the services:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;model name="CreditCheck"&gt;
  &lt;default-exception-strategy&gt;
    &lt;vm:outbound-endpoint path="systemErrorHandler"/&gt;
  &lt;/default-exception-strategy&gt;
  &lt;service&gt; ... &lt;/service&gt;
  &lt;service&gt; ... &lt;/service&gt;
&lt;/model&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To configure the default exception strategy so that it applies to all the components within a service, insert it <em>at the end</em> of the service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;model name="CreditCheck"&gt;
  &lt;service&gt;
    ...
    &lt;default-exception-strategy&gt;
      &lt;vm:outbound-endpoint path="systemErrorHandler"/&gt;
    &lt;/default-exception-strategy&gt;
  &lt;/service&gt;
&lt;/model&gt;</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Set an endpoint on an exception strategy to forward messages that fail to an error queue (or some other destination).
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="implicit-exception-strategy"><a class="anchor" href="#implicit-exception-strategy"></a>Implicit Exception Strategy</h3>
<div class="paragraph">
<p>Every flow has an implicit exception strategy, even when you don&#8217;t place a &lt;default-exception-strategy&gt; element in it. In other words, not configuring an exception strategy has the same practical effect as inserting an empty &lt;default-exception-strategy&gt; element into your flow.</p>
</div>
</div>
<div class="sect2">
<h3 id="exception-strategy-behavior"><a class="anchor" href="#exception-strategy-behavior"></a>Exception Strategy Behavior</h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Typically, an exception strategy can incorporate only a single message processor (or service), which executes as part of the exception strategy&#8217;s logic. To incorporate multiple message processors (or services) into a single exception strategy, use the &lt;processor-chain&gt; element.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once an exception is thrown within a flow or service, the &lt;default-exception-strategy&gt; executes, and the following actions apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The exception is logged</p>
</li>
<li>
<p>If no transaction has occurred</p>
<div class="ulist">
<ul>
<li>
<p>The message is routed through the message processors configured for the exception strategy</p>
</li>
</ul>
</div>
</li>
<li>
<p>If a transaction does occur within the exception strategy context</p>
<div class="ulist">
<ul>
<li>
<p>The transaction is rolled back, and</p>
</li>
<li>
<p>The message is routed through the message processors configured for the exception strategy</p>
</li>
</ul>
</div>
</li>
<li>
<p>If a transaction occurs within the exception strategy context, <em>and</em> that transaction must be committed</p>
<div class="ulist">
<ul>
<li>
<p>The message is routed through the message processors configured for the exception strategy</p>
</li>
<li>
<p>The transaction is committed</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the payload is a stream, it is shut down</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Before the message is routed through the message processors configured for the exception strategy, that message is transformed so that it now contains information about the exception. Thus, a new payload of the following type is created: <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/message/ExceptionMessage.html">org.mule.message.ExceptionMessage</a> . It contains the current payload in the payload attribute and the exception in the exception attribute.</p>
</div>
<div class="paragraph">
<p>If the flow exchange-pattern is <em>request-response</em>, a different message is returned to the caller after &lt;default-exception-strategy&gt; has been executed. The message has <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/transport/NullPayload.html">org.mule.transport.NullPayload</a> as its payload and the exceptionPayload attribute is set to the following: <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/api/ExceptionPayload.html">org.mule.api.ExceptionPayload</a> .</p>
</div>
</div>
<div class="sect2">
<h3 id="implementing-custom-exception-strategies"><a class="anchor" href="#implementing-custom-exception-strategies"></a>Implementing Custom Exception Strategies</h3>
<div class="paragraph">
<p>You can implement a strategy of your own that your class can extend through <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/exception/AbstractExceptionListener.html">org.mule.exception.AbstractExceptionListener</a>. However, the recommended approach is to extend <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/exception/DefaultServiceExceptionStrategy.html">org.mule.exception.DefaultServiceExceptionStrategy</a>, then overload the <code>defaultHandler()</code> method. You can set bean properties on your custom exception strategy in the same way as other Mule-configured objects using a <code>&lt;properties&gt;</code> element.</p>
</div>
<div class="paragraph">
<p>The <code>defaultHandler()</code> method performs all necessary processing to contain an exception, so an exception must never be thrown from an exception strategy, since the exception strategy needs to manage fatal errors.</p>
</div>
<div class="paragraph">
<p>For example, when an error queue is being used and the dispatch fails, your error handling strategy should execute the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stop the current component</p>
</li>
<li>
<p>send a server notification to alert the system monitor</p>
</li>
<li>
<p>write the event to file</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To change the way exceptions are logged, override the <code>logException()</code> method from <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/exception/AbstractExceptionListener.html">org.mule.exception.AbstractExceptionListener</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="implementing-custom-exception-strategies-2"><a class="anchor" href="#implementing-custom-exception-strategies-2"></a>Implementing Custom Exception Strategies</h3>
<div class="paragraph">
<p>When you implement a custom strategy, your class can extend <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/exception/AbstractMessagingExceptionStrategy.html">org.mule.exception.AbstractMessagingExceptionStrategy</a>, since this class provides the logic required to manage transactions and streams. Redefine <code>handleException(Exception ex, MuleEvent event, RollbackSourceCallback rollbackMethod)</code> and <code>handleException(Exception ex, MuleEvent event)</code> methods to apply your custom behavior but you must not forget to call <code>super.handleException(Exception ex, MuleEvent event, RollbackSourceCallback rollbackMethod)</code> and <code>super.handleException(Exception ex, MuleEvent event)</code> so transactions, message routing and streams are handled properly.</p>
</div>
<div class="paragraph">
<p>If you want to change the way exceptions are logged, override the <code>logException()</code> method from <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/exception/AbstractExceptionStrategy.html">org.mule.exception.AbstractExceptionStrategy</a>.</p>
</div>
<div class="paragraph">
<p>To transform the message being routed, you must configure message processors inside &lt;custom-exception-strategy&gt; element.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-exception-based-router"><a class="anchor" href="#using-the-exception-based-router"></a>Using the Exception-based Router</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When an exception occurs, the exception-based router <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/routing/outbound/ExceptionBasedRouter.html">org.mule.routing.outbound.ExceptionBasedRouter</a> determines where the message goes. You can have multiple endpoints specified on the exception-based router, so that if the first endpoint fails with a <code>FatalConnectionException</code>, the next endpoint is tried, and then the next.</p>
</div>
<div class="paragraph">
<p>If all endpoints fail, an <a href="https://www.mulesoft.org/docs/site/current/apidocs/org/mule/api/routing/RoutingException.html">org.mule.api.routing.RoutingException</a> is thrown. Note that the exception-based router overrides the endpoint mode, setting it to synchronous, while seeking a successful send, and it uses the endpoint&#8217;s mode for the last item in the list.</p>
</div>
<div class="paragraph">
<p>The following example configures an exception-based router:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;outbound&gt;
  &lt;exception-based-router&gt;
    &lt;tcp:endpoint host="10.192.111.10" port="10001" /&gt;
    &lt;tcp:endpoint host="10.192.111.11" port="10001" /&gt;
    &lt;tcp:endpoint host="10.192.111.12" port="10001" /&gt;
  &lt;/exception-based-router&gt;
&lt;/outbound&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on routers, see <a href="../../mule-runtime/3.2/using-message-routers.html">Using Message Routers</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-the-exception-type-filter"><a class="anchor" href="#using-the-exception-type-filter"></a>Using the Exception Type Filter</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use the Exception Type filter to gain fine-grained control over messages that produce errors. For example, when a message processed by a synchronous flow gets sent to a validation service, but fails validation, the message and its exception get forwarded to another service AND the message and its exception get returned to the caller. You can achieve this using a chaining router and the <code>&lt;exception-type-filter&gt;</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;chaining-router&gt;
  &lt;vm:outbound-endpoint path="ValidationService" synchronous="true"/&gt;
  &lt;vm:outbound-endpoint path="ValidationError" synchronous="true"&gt;
    &lt;exception-type-filter expectedType="java.lang.Exception"/&gt;
  &lt;/vm:outbound-endpoint&gt;
&lt;/chaining-router&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on filters, see <a href="../../mule-runtime/3.2/using-filters.html">Using Filters</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="error-handling-with-transactions"><a class="anchor" href="#error-handling-with-transactions"></a>Error Handling with Transactions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are using <a href="../../mule-runtime/3.2/transactions/transaction-management.html">transactions</a>, you can use the <code>&lt;commit-transaction&gt;</code> and <code>&lt;rollback-transaction&gt;</code> elements to specify whether a transaction gets committed or rolled back on the basis of the name of the exception that is caught.</p>
</div>
<div class="paragraph">
<p>You can set a comma-separated list of wildcard patterns that will be matched against the fully qualified classname of the current exception.</p>
</div>
<div class="paragraph">
<p>You can use the following patterns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>java.lang.Exception</code> — Matches only if the exception is exactly <code>java.lang.Exception</code></p>
</li>
<li>
<p><code>java.lang.Exception+</code> — Matches if the exception is <code>java.lang.Exception</code> or a subclass</p>
</li>
<li>
<p><code>org.mule.routing.*</code> — Matches any exception which names starts with <code>org.mule.routing</code></p>
</li>
<li>
<p><code>*</code> — Matches any exception type</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the following code rolls back the transaction only if the exception classname begins with <code>com.ibm.mq.</code>, otherwise it commits all other transactions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;default-exception-strategy&gt;
  &lt;commit-transaction exception-pattern="*"/&gt;
  &lt;rollback-transaction exception-pattern="com.ibm.mq.*"/&gt;
  &lt;vm:outbound-endpoint path="handleError"/&gt;
&lt;/default-exception-strategy&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the following example, rollback occurs if the exception thrown is an instance of<br>
<code>java.lang.IllegalArgumentException</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;default-service-exception-strategy&gt;
  &lt;commit-transaction exception-pattern="*"/&gt;
  &lt;rollback-transaction exception-pattern="java.lang.IllegalArgumentException+"/&gt;
  &lt;vm:outbound-endpoint path="handleError"/&gt;
&lt;/default-service-exception-strategy&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mule uses the following criteria to commit or rollback message processing events:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Default</strong>: If neither <code>&lt;rollback-transaction&gt;</code> nor <code>&lt;commit-transaction&gt;</code> return an <code>exception-pattern</code> that matches the <code>exception-pattern</code> values specified for the applicable exception strategy, the transaction is rolled back.</p>
</li>
<li>
<p>If the returned exception-pattern matches the value specified for the exception-pattern attribute associated with the rollback transaction element of the relevant exception strategy, then the transaction is rolled back.</p>
</li>
<li>
<p>If the returned exception-pattern <em>doesn’t</em> match, <em>and</em> the returned value for the &lt;commit-transaction&gt; exception pattern <em>does</em> match, then the transaction is committed.</p>
</li>
<li>
<p>For all other cases, the transaction is rolled back.</p>
</li>
</ul>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../_theme/scripts/menu.js"></script>
<script src="../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
