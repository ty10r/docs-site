<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/anypoint-connector-devkit/3.4/implementing-connection-management.html">
  <link rel="stylesheet" href="../../_theme/stylesheets/theme.css">
  <title>Implementing Connection Management // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="index.html">Anypoint Connector DevKit</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="devkit-shortcut-to-success.html">DevKit Shortcut to Success</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="index.html">Anypoint Connector DevKit</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="setting-up-a-devkit-development-environment.html">Setting Up a DevKit Development Environment</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="preparing-api-access-or-a-sandbox-environment.html">Preparing API Access or a Sandbox Environment</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="creating-a-connector-project.html">Creating a Connector Project</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="examining-the-generated-connector-project.html">Examining the Generated Connector Project</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="examining-the-generated-connector-project.html">Examining the Generated Connector Project</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="installing-and-testing-your-connector.html">Installing and Testing Your Connector</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="authentication-and-connection-management.html">Authentication and Connection Management</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="authentication-methods.html">Authentication Methods</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="implementing-connection-management.html">Implementing Connection Management</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="implementing-oauth-1.0-authentication.html">Implementing OAuth 1.0 Authentication</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="implementing-oauth-2.0-authentication.html">Implementing OAuth 2.0 Authentication</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="connector-attributes-operations-and-data-model.html">Connector Attributes Operations and Data Model</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="defining-configurable-connector-attributes.html">Defining Connector Attributes</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-to-java-client-library-example.html">Connector to Java Client Library Example</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-to-soap-service-via-cxf-client-example.html">Connector to a SOAP Service via CXF Client Example</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-to-restful-service-with-jersey-client-example.html">Connector to RESTful Service with Jersey Client Example</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="connector-to-restful-api-with-restcall-annotations-example.html">Connector to RESTful API with <code>@RestCall</code> Annotations Example</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="customizing-connector-integration-with-esb-and-studio.html">Customizing Connector Integration with ESB and Studio</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="developing-devkit-connector-tests.html">Developing DevKit Connector Tests</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="creating-devkit-connector-documentation.html">Creating DevKit Connector Documentation</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="packaging-your-connector-for-release.html">Packaging Your Connector for Release</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="devkit-connector-examples.html">DevKit Connector Examples</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="devkit-advanced-topics.html">DevKit Advanced Topics</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="http-callbacks.html">HTTP Callbacks</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="integrating-connectors-with-the-mule-lifecycle.html">Integrating Connectors with the Mule Lifecycle</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="handling-data-types-for-configurable-properties.html">Handling Data Types for Configurable Properties</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="architectural-considerations-with-connectors-and-the-mule-container.html">Architectural Considerations with Connectors and the Mule Container</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="injecting-mule-managers-into-anypoint-connectors.html">Injecting Mule Managers into Anypoint Connectors</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="supporting-datasense-with-dynamic-data-models.html">Supporting DataSense with Dynamic Data Models</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="implementing-datasense-query-language-support.html">Implementing DataSense Query Language Support</a>
                              </li>
                          </ul>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">Implementing Connection Management</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/anypoint-connector-devkit-docs/edit/v3.4/modules/ROOT/content/implementing-connection-management.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>Implementing Connection Management</h1>
    <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The DevKit connection management framework provides multi-tenancy capabilities for a connector (managing multiple simultaneous connections with different credentials for a given connector within your application), as well as connection pooling and instance pooling. These benefits are available for connectors supporting most authentication schemes other than OAuth, and for connectors to targets that do not require authentication.</p>
</div>
<div class="paragraph">
<p>This document describes the benefits of using the connection management framework, the Java annotations through which it is exposed, and how to implement connection management support in your own connector. Examples in this discussion show the use of connection management with basic username/password authentication, but they can easily be generalized to other non-OAuth protocols.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assumptions"><a class="anchor" href="#assumptions"></a>Assumptions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document assumes you have <a href="creating-a-connector-project.html">created a connector project</a>, <a href="installing-and-testing-your-connector.html">installed and tested</a> it in Mule Studio, and are ready to implement authentication on your connector. It assumes you are familiar with the various <a href="authentication-methods.html">authentication methods</a> and have <a href="authentication-and-connection-management.html">compared the authentication support options in DevKit</a> and selected Connection Management as your option of choice.</p>
</div>
<div class="paragraph">
<p>This document also assumes you are familiar with the @Connector class within a connector, which provides the interface between the connector&#8217;s client implementation (for calling the remote service) and Mule.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="about-connection-management"><a class="anchor" href="#about-connection-management"></a>About Connection Management</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The DevKit&#8217;s connection management framework provides the following benefits, with minimal effort on the part of the connector developer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>transparent multitenancy– a Mule application can open many connections to a single target, using different credentials to connect on behalf of many users simultaneously</p>
</li>
<li>
<p>connection pooling–  automated management of a pool of instances of the connector class, to manage connection resources effectively</p>
</li>
<li>
<p>automatically invalidating connections on exceptions, and reconnecting as needed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>DevKit makes it easy to add connection management functionality to connectors, by applying annotations at the @Connector class level.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Connection Management Framework and Authentication Protocols</strong></p>
</div>
<div class="paragraph">
<p>The connection management framework can be used in conjunction with most authentication protocols, such as Basic username/password authentication (most common), SAML, Kerberos, LDAP and NTLM.</p>
</div>
<div class="paragraph">
<p>However, you cannot use the connection management framework with connectors that use OAuth authentication; the framework does not support the "OAuth dance" or the management of OAuth tokens.</p>
</div>
<div class="paragraph">
<p>OAuth 2-based authentication in DevKit provides functionality comparable to the connection management framework, if you use the OAuth-related annotations. See <a href="implementing-oauth-2.0-authentication.html">Implementing OAuth 2.0 Authentication</a> for details.</p>
</div>
<div class="paragraph">
<p>OAuth 1-based connectors do not support multi-tenancy through DevKit. In cases where OAuth 1 is the only method of authentication available, it is possible to implement multi-tenancy without DevKit, but building your own multitenancy mechanism is beyond the scope of this document. It is simplest to instead choose OAuth 2 if your target supports it; contact MuleSoft for other options if you have a strict business or technical requirement in this area.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connection-management-annotations-in-devkit"><a class="anchor" href="#connection-management-annotations-in-devkit"></a>Connection Management Annotations in DevKit</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use connection management in a connector, define and annotate the following methods on the @Connector class:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>@Connect</code> method, that creates a connection</p>
</li>
<li>
<p>A <code>@Disconnect</code> method, that explicitly closes a connection</p>
</li>
<li>
<p>A <code>@ValidateConnection</code> method, that returns <code>true</code> if a connection is still valid, <code>false</code> otherwise</p>
</li>
<li>
<p>A <code>@ConnectionIdentifier</code> method, that returns a prefix used in generating unique identifies for connector instances in the connection pool</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also available is an <code>@InvalidateConnectionOn</code>  method, useful when an API operation encounters an exception due to a lost connection.</p>
</div>
<div class="paragraph">
<p>Specifics of the implementation of these methods depends on the target.</p>
</div>
<div class="paragraph">
<p>Because connection management is such a useful and fundamental feature, the generated code skeleton from the Maven archetype includes placeholder methods with the connection management annotations already applied.</p>
</div>
<div class="paragraph">
<p><strong>Skeleton Connector with Connection Management Annotated Methods</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text">/**
* Connect
*
* @param username A username
* @param password A password
* @throws ConnectionException
*/
@Connect public void connect(@ConnectionKey String username, String password)
    throws ConnectionException
{

    /**
    * CODE FOR ESTABLISHING A CONNECTION GOES IN HERE
    */
}

/**
* Disconnect
*/
@Disconnect
public void disconnect()
{

    /**
    * CODE FOR CLOSING A CONNECTION GOES IN HERE
    */
}

/**
* Are we connected
*/
@ValidateConnection public boolean isConnected()
{
    return true;
}

/**
* Connection identifier
*/
@ConnectionIdentifier public String connectionId()
{
    return "001";
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The methods are called automatically as needed by the DevKit framework; you never call them directly from your code.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connect-method"><a class="anchor" href="#connect-method"></a>@Connect Method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This method indicates which method inside an <code>@Connector</code> class is responsible for creating a connection to the target. The <code>@Connect</code> method is called automatically by Mule when the connector starts up, or if the connection to the API has been lost and must be reestablished. When this method finishes, if authentication is successful, the connector instance is ready to make requests to the API.</p>
</div>
<div class="paragraph">
<p>A method annotated with <code>@Connect</code> must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>be <code>public</code></p>
</li>
<li>
<p>throw <code>org.mule.api.ConnectionException</code> (and no other exceptions)</p>
</li>
<li>
<p>have a <code>void</code> return type</p>
</li>
<li>
<p>have exactly one method annotated <code>@Connect</code> (or compilation will fail), if automatic connection management is used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The specific code that implements the actual connection will depend on the API. Here is an example of how a @Connect method can be implemented for the Salesforce connector:</p>
</div>
<div class="paragraph">
<p><strong>Connect method for salesforce connector</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Connect
public void connect(@ConnectionKey String username, String password)
throws ConnectionException
{
   ConnectorConfig config = new ConnectorConfig();
   config.setUsername(username);
   config.setPassword(password);
   try
   {
      connection = com.sforce.soap.partner.Connector.newConnection(config);
   }
   catch (com.sforce.ws.ConnectionException e)
   {
      throw new org.mule.api.ConnectionException(ConnectionExceptionCode.UNKNOWN, null, e.getMessage(), e);
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The parameters required by this method are the credentials needed for authentication, in this case username and password. Since this method is annotated with <code>@Connect</code> , DevKit makes these parameters available both in the configuration element for this Connector (as occurs with <code>@Configurable</code> fields), as well as in the message processor whenever an instance of it is dragged into a flow. Specified credentials override those that are set in the configuration element.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connectionkey-and-connection-pooling"><a class="anchor" href="#connectionkey-and-connection-pooling"></a>@ConnectionKey and Connection Pooling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Note that the username parameter is annotated with <code>@ConnectionKey</code>. If pools are enabled (see Pooling Modules below), Mule keeps a pool of simultaneous connections which are used as needed to make calls. The <code>@ConnectionKey</code> annotation marks that this field is used as the key for this particular connection within the connection pool, so once a connection for this username has been created and added to the pool, it will be reused rather than recreated for each request.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Choosing a Connection Key</strong><br></p>
</div>
<div class="paragraph">
<p>For username/password authentication, the username is the obvious choice for <code>@ConnectionKey</code>; for other protocols, identify the value that is most obviously associated with different users and access privileges that connect to your service and choose that as your @ConnectionKey.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The above <code>@Connect `method first creates a `ConnectorConfig</code> (a Salesforce type that holds connection configuration information) object, then loads the username and password values into the object. This object is used as the argument to the static <code>newConnection()</code> call, which returns a <code>PartnerConnection</code> if successful. If the authentication fails (because of invalid login information or for some other reason) the code catches the Salesforce typed exception and throws a new exception containing the same information but labeled as the correct Mule exception type.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Use the fully qualified name for the Salesforce Connector class (on which you call n`ewConnection(config)`) rather than importing the class, because the DevKit also imports a class called Connector, which causes an import conflict.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
For clients where no authentication is used, you must still supply a @ConnectionKey field. An invented username is one possibility; see <a href="connector-to-soap-service-via-cxf-client-example.html">Connector to SOAP Service via CXF Client Example</a> for such an implementation.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="disconnect-method"><a class="anchor" href="#disconnect-method"></a>@Disconnect Method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This annotation indicates the method inside a <code>@Connector</code> class that is responsible for disposing of a connection. It is called when the connector is shut down or the connection is explicitly terminated.</p>
</div>
<div class="paragraph">
<p>A method annotated with <code>@Disconnect</code> must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>be <code>public</code></p>
</li>
<li>
<p>take no input parameters</p>
</li>
<li>
<p>have a <code>void</code> return type</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If connection management is used, the @Connector class must have exactly one annotated <code>@Disconnect</code> method (or compilation will fail).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Disconnect
public void disconnect()
{
   if (connection != null)
   {
       try
         {
         connection.logout();
         }
      catch (com.sforce.ws.ConnectionException e)
         {
         e.printStackTrace();
         }
      finally
         {
         connection = null;
         }
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the connector currently has a connection open, this code calls <code>connection.logout()</code> , a Salesforce client method that explicitly de-authenticates and closes the connection. The "finally" block ensures that, if the logout fails for any reason, the connection is still set to null, so the connector does not again try to reference that connector instance.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="validateconnection-method"><a class="anchor" href="#validateconnection-method"></a>@ValidateConnection Method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This method is called by Mule to check whether the connection is actually open or not.</p>
</div>
<div class="paragraph">
<p>A method annotated with <code>@ValidateConnection</code> must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>be <code>public</code></p>
</li>
<li>
<p>decline to receive parameters</p>
</li>
<li>
<p>return <code>boolean</code> or <code>java.lang.Boolean</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Only one method on a @Connector class can be annotated with <code>@ValidateConnection.</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ValidateConnection
public boolean isConnected()
{
return connection != null;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>For this example, this code simply checks whether the connection parameter is null to check whether the connection is active. For other connectors, depending upon the protocol, a different implementation may be required.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connectionidentifier-method"><a class="anchor" href="#connectionidentifier-method"></a>@ConnectionIdentifier Method</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This annotation identifies a method inside a <code>@Connector</code> that returns a unique identifier for the connection, used for logging and debugging.</p>
</div>
<div class="paragraph">
<p>A method annotated with <code>@ConnectionIdentifier</code> must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>be <code>public</code></p>
</li>
<li>
<p>not be <code>static</code></p>
</li>
<li>
<p>not take arguments</p>
</li>
<li>
<p>return <code>java.lang.String</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A @Connector class that uses connection management must have exactly one method annotated <code>@ConnectionIdentifier</code> (or compilation will fail).</p>
</div>
<div class="paragraph">
<p>This code returns the connection SessionId as an identifier (if available). The SessionHeader is a Salesforce object containing header information about the current connection to the API, including the session ID.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@ConnectionIdentifier
   public String connectionId() {
    if (connection != null){
     return connection.getSessionHeader().getSessionId();
    } else {
     return null;
    }
   }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="invalidateconnectionon-annotation"><a class="anchor" href="#invalidateconnectionon-annotation"></a>@InvalidateConnectionOn Annotation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This annotation is used for exception handling related to connections. Attach this annotation to any method with a <code>@Processor</code> or <code>@Source</code> annotation. If the Processor/Source throws an exception of this class, <code>@InvalidateConnectionOn</code> automatically invalidates the connection. <code>@InvalidateConnectionOn</code> receives a single argument: the class of the exception to be caught. See <a href="../../mule-runtime/3.4/mule-configuration/configuring-reconnection-strategies.html">Configuring Reconnection Strategies</a> for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="connection-pooling"><a class="anchor" href="#connection-pooling"></a>Connection Pooling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can allow users of your connector to use a pool of simultaneous connections instead of sharing a single instance to process messages.</p>
</div>
<div class="paragraph">
<p>Connectors that implement pools are each assigned a pool component, which contains multiple instances of the connector to handle simultaneous requests. A flow&#8217;s pooling profile configures its component pool.</p>
</div>
<div class="paragraph">
<p>If you set the <code>poolable</code> annotation parameter to true, the generated schema will include additional configuration elements.</p>
</div>
<div class="sect2">
<h3 id="example"><a class="anchor" href="#example"></a>Example</h3>
<div class="paragraph">
<p><strong>Connector</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@Connector(name = "myconnector", poolable = true)
public class MyConnector
{</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the corresponding XML, the <code>pooling-config</code> element is nested inside the <code>config</code> element. Notice that there is no need to provide any custom Java code to handle the pool, all that is needed is to provide a few parameters:</p>
</div>
<div class="paragraph">
<p><strong>XML</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;mymodule:config&gt;
    &lt;mymodule:pooling-profile maxActive="10" maxIdle="5"
        initialisationPolicy="INITIALISE_ALL"
        exhaustedAction="WHEN_EXHAUSTED_FAIL" maxWait="60"/&gt;
&lt;/mymodule:config&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The table that follows offers a breakdown of <code>pooling-profile</code> parameters.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Attribute Name</strong></th>
<th class="tableblock halign-left valign-top"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxActive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required.</strong> Controls the maximum number of Mule components that can be borrowed from a session at once. When set to a negative value, there is no limit to the number of components that may be active at once. When <code>maxActive</code> is exceeded, the pool is said to be exhausted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxIdle</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required.</strong> Controls the maximum number of Mule components that can sit idle in the pool at once. When set to a negative value, there is no limit to the number of Mule components that may be idle at once.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">initialisationPolicy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Optional.</strong> Determines how components in a pool should be initialized. Its possible values are:<br>
<code>INITIALISE_NONE</code> (will not load any components into the pool on startup), <code>INITIALISE_ONE</code> (will load one initial component into the pool on startup), or <code>INITIALISE_ALL</code> (will load all components in the pool on startup). <br>
Default value is <code>INITIALISE_ONE</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exhaustedAction</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><strong>Optional.</strong> Specifies the behavior of the Mule component pool when the pool is exhausted. Its possible values are:</p>
</div>
<div class="paragraph">
<p><code>WHEN_EXHAUSTED_FAIL</code> (throw a NoSuchElementException) <br>
<code>WHEN_EXHAUSTED_WAIT `(block by invoking `Object.wait(long)</code> until a new or idle object is available)</p>
</div>
<div class="paragraph">
<p><code>WHEN_EXHAUSTED_GROW</code> (create a new Mule instance and return it, essentially making maxActive meaningless).</p>
</div>
<div class="paragraph">
<p>If a positive <code>maxWait `value is supplied, it will block for at most that many milliseconds, after which a `NoSuchElementException</code> will be thrown. If `maxThreadWait `is a negative value, it will block indefinitely.</p>
</div>
<div class="paragraph">
<p>Default value is <code>WHEN_EXHAUSTED_GROW</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">maxWait</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Required.</strong> Specifies the number of milliseconds to wait for a pooled component to become available when the pool is exhausted and the <code>exhaustedAction</code> is set to <code>WHEN_EXHAUSTED_WAIT</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="see-also"><a class="anchor" href="#see-also"></a>See Also</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>See the <a href="connector-to-soap-service-via-cxf-client-example.html">Connector to SOAP Service via CXF Client Example</a> example to see the connection management annotations in a fully working example.</p>
</li>
<li>
<p>Take a look at <a href="https://github.com/mulesoft/salesforce-connector/blob/master/src/main/java/org/mule/modules/salesforce/SalesforceConnector.java">Salesforce.com connector source code</a> and see how the connection management is implemented.</p>
</li>
<li>
<p>Return to the <a href="devkit-shortcut-to-success.html">DevKit Shortcut to Success</a>.</p>
</li>
</ul>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../_theme/scripts/menu.js"></script>
<script src="../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
