<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="keywords" content="munit, testing, unit testing">
  <link rel="canonical" href="https://ede65566-docs-migration.github.io/docs-site/munit/1.3/example-testing-apikit.html">
  <link rel="stylesheet" href="../../_theme/stylesheets/theme.css">
  <title>Example: Testing APIkit // MuleSoft Documentation</title>
</head>
<body class="article">
<header class="header" id="header" role="banner"><div class="header__wrapper clearfix">
      <div class="header__logo--primary-nav clearfix">
        <a href="https://docs.mulesoft.com" title="Home" rel="home" class="header__logo" id="logo">
          <img src="../../_theme/images/mulesoft-dev-logo.svg" alt="Home" class="header__logo-image"></a>
          <div class="header__region region region-header">
    <div id="block-system-main-menu" class="block block-menu first last odd" role="navigation">

        <h2 class="block__title block-title">Main Dev Menu</h2>
    
  <ul class="menu"><li class="menu__item is-expanded first expanded"><span class="menu__link">Platform</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/dev/anypoint-studio" title="" class="menu__link">Studio</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/connectors" title="" class="menu__link">Connectors</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/anypoint-exchange" title="" class="menu__link">Exchange</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/design-api" title="" class="menu__link">API Designer</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-developer-portal" title="" class="menu__link">API Portal</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/mule-runtime-engine" title="" class="menu__link">Mule runtime engine</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/dev/api-management" title="" class="menu__link">API Manager</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/dev/reporting-api-analytics" title="" class="menu__link">API Analytics</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><span class="menu__link">Resources</span><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="https://developer.mulesoft.com/getting-started/anypoint-platform" class="menu__link">Getting started</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/tutorials-and-howtos" class="menu__link">Tutorials &amp; HowTos</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/webinars-and-videos" title="" class="menu__link">Webinars &amp; Videos</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/workshops" class="menu__link">Online Workshops</a></li>
<li class="menu__item is-leaf leaf"><a href="https://developer.mulesoft.com/integration-books-and-resources" class="menu__link">Books &amp; Whitepapers</a></li>
<li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/dev/" class="menu__link">Blog</a></li>
<li class="menu__item is-leaf leaf"><a href="https://docs.mulesoft.com" class="menu__link">Documentation</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://training.mulesoft.com" class="menu__link">Training</a></li>
</ul></li>
<li class="menu__item is-expanded expanded"><a href="https://developer.mulesoft.com/community" class="menu__link">Community</a><ul class="menu"><li class="menu__item is-leaf first leaf"><a href="http://forum.mulesoft.org/" class="menu__link">Forums</a></li>
<li class="menu__item is-leaf leaf"><a href="https://meetups.mulesoft.com" class="menu__link">Meetups</a></li>
<li class="menu__item is-leaf leaf"><a href="http://s2.developer.mulesoft.com/" class="menu__link">Contributed Content</a></li>
<li class="menu__item is-leaf leaf"><a href="https://s2.developer.mulesoft.com/jobs.html" class="menu__link">Jobs</a></li>
<li class="menu__item is-leaf last leaf"><a href="https://www.mulesoft.org/jira/browse/MULE" class="menu__link">Issue tracker</a></li>
</ul></li>
<li class="menu__item is-leaf last leaf"><a href="https://developer.mulesoft.com/champions" class="menu__link">Champions</a></li>
</ul></div>
  </div>
      </div> <!-- header__logo--primary-nav -->
      <div class="header__top-wrapper">
        <div class="header__nav-wrapper">
                      <div class="region region-header-top">
    <div id="block-search-form" class="block block-search first last odd" role="search">

      
  
</div>
  </div>
        </div>
        <div class="top-nav-ctas">
          <a class="icon-muletheme-phone" href="https://mulesoft.com/lp/contact" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-contact');"></a>
          <a href="https://anypoint.mulesoft.com/login/#/signup?apintent=dmc_generic" class="try" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-nav');">Try now</a>
          <a href="https://mulesoft.com/" class="dev" onclick="ga('send', 'event', 'CTA', 'Click', 'dmc-top-mscom');">MuleSoft.com</a>
        </div>
      </div> <!-- header__secondary-nav-search -->
    </div> <!-- header__wrapper -->
    <a href="#sidr" id="open-left" class="closed">
    </a>
  </header><main role="main" class="main-wrapper">
  <div class="navigation-wrapper">
    <nav role="navigation" class="navigation">
      <div class="search">
        <input type="text" placeholder="Search the docs" class="search-input" autocomplete="off" autocorrect="off" autocapitalize="off">
      </div>
      <div class="inner-nav">
          <ul class="nav-lst">
              <li class="nav-itm" data-depth="0" data-state="collapsed">
                  <button class="nav-tgl"></button>
                <a class="nav-lnk" href="index.html">MUnit</a>
                  <ul class="nav-lst">
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="munit-suite.html">Test Suite</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="using-munit-in-anypoint-studio.html">Using MUnit in Anypoint Studio</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="munit-maven-support.html">Maven Support</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="munit-domain-support.html">Domain Support</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="munit-coverage-report.html">Coverage Report</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="message-processors.html">Message Processors</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="assertion-message-processor.html">Assertion</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="set-message-processor.html">Set</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="mock-message-processor.html">Mock</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="verify-message-processor.html">Verify</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="spy-message-processor.html">Spy</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="munit-matchers.html">Matchers</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="munit-utils.html">Utilities</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="munit-database-server.html">Database Server</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="munit-ftp-server.html">FTP Server</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="run-and-wait-scope.html">Run and Wait Scope</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                          <button class="nav-tgl"></button>
                        <a class="nav-lnk" href="munit-examples.html">Examples</a>
                          <ul class="nav-lst">
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="munit-short-tutorial.html">Short Tutorial</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="example-testing-apikit.html">Testing APIkit</a>
                              </li>
                              <li class="nav-itm" data-depth="2" data-state="collapsed">
                                <a class="nav-lnk" href="logging-in-munit.html">Logging</a>
                              </li>
                          </ul>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="munit-tests-with-java.html">Tests With Java</a>
                      </li>
                      <li class="nav-itm" data-depth="1" data-state="collapsed">
                        <a class="nav-lnk" href="../../solutions/migration/munit/1.2-migration-guide.html">MUnit 1.2 Migration Guide</a>
                      </li>
                  </ul>
              </li>
          </ul>
      </div>
    </nav>
  </div>
  <article class="primary-content">
    <header class="article-header">
      <div class="breadcrumb">
        <strong class="breadcrumb-item">[ Domain Selector Placeholder ]</strong> /
        <span class="breadcrumb-item">Example: Testing APIkit</span>
      </div>
      <div class="edit-on-github">
        <a href="https://github.com/ede65566-docs-migration/munit-docs/edit/v1.2/modules/ROOT/content/example-testing-apikit.adoc" class="edit-on-github-link">Edit on Github</a>
      </div>
    </header>
    <h1>Example: Testing APIkit</h1>
    <div class="sect1">
<h2 id="scenario"><a class="anchor" href="#scenario"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document contains a basic example on testing APIkit-based applications. There are two basic ways to test an application based on APIkit: Going through the APIkit router, or <em>not</em> going through the APIkit router.</p>
</div>
<div class="paragraph">
<p>The difference resides in what you are trying to test. Clearly, if you go through the APIkit router you have a more complete test than if you do not; however, not going through the router shields your test from API-related information, allowing you to test only the business logic of the API.</p>
</div>
<div class="paragraph">
<p>In this example, we go through the APIkit router.</p>
</div>
<div class="paragraph">
<p>Aside of what is contained in the XML configuration, the APIkit router handles some tasks under the hood:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Routing by resource/method/content-type</p>
</li>
<li>
<p>Validation of input payloads, headers, query-params, uri-params</p>
</li>
<li>
<p>Auto-transformation (serialization) of the response payload</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To perform these tasks, the APIkit Router constantly reads the <code>api.raml</code> file. Thus, going through the APIkit Router helps you maintain consistency between the XML configuration that implements the API and the RAML definition file.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="hands-on"><a class="anchor" href="#hands-on"></a>Example Test</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create a new Mule Studio project and create a RAML definition file in the <code>api</code> folder (for details on how to do this, see the <a href="../../apikit/3.8/apikit-tutorial.html">APIkit Tutorial</a>).</p>
</div>
<div class="sect2">
<h3 id="the-raml-definition"><a class="anchor" href="#the-raml-definition"></a>The RAML Definition</h3>
<div class="listingblock">
<div class="content">
<pre>#%RAML 0.8
---
title: Sample API

/munit:
  displayName: Login
  get:
    description: Login through signed request
    responses:
      200:
        body:
          application/json:
  post:
    description: Login through signed request
    responses:
      201:
        body:
          application/json:
  put:
    description: Login through signed request
    responses:
      201:
        body:
          application/json:
  delete:
    description: Login through signed request
    responses:
      200:
        body:
          application/json:</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="the-api-implementation"><a class="anchor" href="#the-api-implementation"></a>The API Implementation</h3>
<div class="paragraph">
<p>Below is the result after you generate the flows for the RAML definition:</p>
</div>
<div class="exampleblock ex">
<div class="content">
<h3 id="studio-visual-editor" class="discrete view">Studio Visual Editor</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/api-kit-generated-flow.png" alt="api kit generated flow">
</div>
</div>
<div class="paragraph">
<p>Note that APIKit also creates a Global Exception Strategy to catch all possible http status code errors:<br></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/api-kit-generated-exceptions.png" alt="api kit generated exceptions">
</div>
</div>
<h3 id="xml-or-standalone-editor" class="discrete view">XML or Standalone Editor</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;apikit:config name="api-config" raml="api.raml" consoleEnabled="true" consolePath="console" doc:name="Router" /&gt;
    &lt;http:listener-config name="HTTP_Listener_Configuration" host="localhost" port="9090" connectionIdleTimeout="999999" doc:name="HTTP Listener Configuration" basePath="/api"/&gt;
    &lt;apikit:mapping-exception-strategy name="api-apiKitGlobalExceptionMapping" &gt;
        &lt;apikit:mapping statusCode="404"&gt;
            &lt;apikit:exception value="org.mule.module.apikit.exception.NotFoundException" /&gt;
            &lt;set-property propertyName="Content-Type" value="application/json" doc:name="Property" /&gt;
            &lt;set-payload value="{ &amp;quot;message&amp;quot;: &amp;quot;Resource not found&amp;quot;]" doc:name="Set Payload" /&gt;
        &lt;/apikit:mapping&gt;
        &lt;apikit:mapping statusCode="405"&gt;
            &lt;apikit:exception value="org.mule.module.apikit.exception.MethodNotAllowedException" /&gt;
            &lt;set-property propertyName="Content-Type" value="application/json" doc:name="Property" /&gt;
            &lt;set-payload value="{ &amp;quot;message&amp;quot;: &amp;quot;Method not allowed&amp;quot;]" doc:name="Set Payload" /&gt;
        &lt;/apikit:mapping&gt;
        &lt;apikit:mapping statusCode="415"&gt;
            &lt;apikit:exception value="org.mule.module.apikit.exception.UnsupportedMediaTypeException" /&gt;
            &lt;set-property propertyName="Content-Type" value="application/json" doc:name="Property" /&gt;
            &lt;set-payload value="{ &amp;quot;message&amp;quot;: &amp;quot;Unsupported media type&amp;quot;]" doc:name="Set Payload" /&gt;
        &lt;/apikit:mapping&gt;
        &lt;apikit:mapping statusCode="406"&gt;
            &lt;apikit:exception value="org.mule.module.apikit.exception.NotAcceptableException" /&gt;
            &lt;set-property propertyName="Content-Type" value="application/json" doc:name="Property" /&gt;
            &lt;set-payload value="{ &amp;quot;message&amp;quot;: &amp;quot;Not acceptable&amp;quot;]" doc:name="Set Payload" /&gt;
        &lt;/apikit:mapping&gt;
        &lt;apikit:mapping statusCode="400"&gt;
            &lt;apikit:exception value="org.mule.module.apikit.exception.BadRequestException" /&gt;
            &lt;set-property propertyName="Content-Type" value="application/json" doc:name="Property" /&gt;
            &lt;set-payload value="{ &amp;quot;message&amp;quot;: &amp;quot;Bad request&amp;quot;]" doc:name="Set Payload" /&gt;
        &lt;/apikit:mapping&gt;
    &lt;/apikit:mapping-exception-strategy&gt;
    &lt;flow name="api-main" &gt;
        &lt;http:listener config-ref="HTTP_Listener_Configuration" path="*" doc:name="HTTP"/&gt;
        &lt;apikit:router config-ref="api-config" doc:name="APIkit Router" /&gt;
        &lt;exception-strategy ref="api-apiKitGlobalExceptionMapping" doc:name="Reference Exception Strategy" /&gt;
    &lt;/flow&gt;
    &lt;flow name="get:/munit:api-config" &gt;
        &lt;set-payload value="#['GET RESPONSE']" doc:name="Set Payload" /&gt;
    &lt;/flow&gt;
    &lt;flow name="put:/munit:api-config" &gt;
        &lt;set-payload value="#['PUT RESPONSE']" doc:name="Set Payload"/&gt;
    &lt;/flow&gt;
    &lt;flow name="delete:/munit:api-config" &gt;
        &lt;set-payload value="#['DELETE RESPONSE']" doc:name="Set Payload"/&gt;
    &lt;/flow&gt;
    &lt;flow name="post:/munit:api-config" &gt;
        &lt;set-payload value="#['POST RESPONSE']" doc:name="Set Payload"/&gt;
    &lt;/flow&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When creating this example, make sure you add APIkit components to your project:<br></p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/create-project-add-apikit-components.png" alt="create project add apikit components">
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the above example, the default listener port of the HTTP global configuration has been changed to 9090.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="the-munit-test"><a class="anchor" href="#the-munit-test"></a>The MUnit Test</h3>
<div class="paragraph">
<p>These sections contain a breakdown of the important parts of the test. You can find a complete version of the XML at the bottom of the page.</p>
</div>
<div class="paragraph">
<p><strong>The MUnit configuration:</strong></p>
</div>
<div class="exampleblock ex">
<div class="content">
<h3 id="studio-visual-editor-2" class="discrete view">Studio Visual Editor</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/munit-configuration-mock-false.png" alt="munit configuration mock false">
</div>
</div>
<h3 id="xml-or-standalone-editor-2" class="discrete view">XML or Standalone Editor</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;munit:config doc:name="Munit configuration" mock-connectors="false" mock-inbounds="false"/&gt;
&lt;spring:beans&gt;
  &lt;spring:import resource="classpath:api.xml"/&gt;
&lt;/spring:beans&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the MUnit configuration, it is essential that you set <code>mock-connectors</code> and <code>mock-inbounds</code> to <code>false</code>. By default, MUnit sets these values to <code>true</code> (since usually you don&#8217;t want to enable inbound endpoints), so you must manually set these values to false; otherwise the test does not work.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>An actual test:</strong></p>
</div>
<div class="exampleblock ex">
<div class="content">
<h3 id="studio-visual-editor-3" class="discrete view">Studio Visual Editor</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/test-get-sample.png" alt="test get sample">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/test-get-sample-global.png" alt="test get sample global">
</div>
</div>
<h3 id="xml-or-standalone-editor-3" class="discrete view">XML or Standalone Editor</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;munit:test name="api-test-get" description="Test"&gt;
  &lt;munit:set payload="#['']" doc:name="Set Message"/&gt;
  &lt;http:request config-ref="HTTP_Request_Configuration" path="/munit" method="GET" doc:name="HTTP"/&gt;
  &lt;object-to-string-transformer doc:name="Object to String"/&gt;
  &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(200))]" doc:name="Assert True"/&gt;
  &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="&amp;quot;GET RESPONSE&amp;quot;" actualValue="#[payload]" doc:name="Assert Equals"/&gt;
&lt;/munit:test&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>As you can see, we are using an <code>http connector</code> to trigger the test. This enables you to use the HTTP outbound endpoint to define everything you need in order to hit a resource of your API (HTTP verbs, headers, paths, MIME types, etc.). In this example, we cover only the verb.</p>
</div>
<div class="paragraph">
<p><strong>The two assertions in the test:</strong></p>
</div>
<div class="exampleblock ex">
<div class="content">
<h3 id="studio-visual-editor-4" class="discrete view">Studio Visual Editor</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/test-get-sample-assert-true.png" alt="test get sample assert true">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/test-get-assert-equals.png" alt="test get assert equals">
</div>
</div>
<h3 id="xml-or-standalone-editor-4" class="discrete view">XML or Standalone Editor</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq('200'))]" doc:name="Assert True"/&gt;

&lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="#['\&amp;quot;GET RESPONSE\&amp;quot;']" actualValue="#[payload]" doc:name="Assert Equals"/&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>This example illustrates one of the most basic assertions needed in a test like this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To validate the HTTP status code</p>
</li>
<li>
<p>To validate the returned payload</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Full test config XML:</strong></p>
</div>
<div class="exampleblock ex">
<div class="content">
<h3 id="studio-visual-editor-5" class="discrete view">Studio Visual Editor</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/full-test.png" alt="full test">
</div>
</div>
<h3 id="xml-or-standalone-editor-5" class="discrete view">XML or Standalone Editor</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;munit:config name="munit" doc:name="MUnit configuration" mock-connectors="false" mock-inbounds="false"/&gt;
&lt;spring:beans&gt;
    &lt;spring:import resource="classpath:apigwexample-docs.xml"/&gt;
&lt;/spring:beans&gt;

&lt;http:request-config name="HTTP_Request_Configuration" host="localhost" port="9090" basePath="/api" connectionIdleTimeout="999999" doc:name="HTTP Request Configuration"&gt;
    &lt;http:raml-api-configuration location="api.raml"/&gt;
&lt;/http:request-config&gt;


&lt;munit:test name="api-test-get" description="Test"&gt;
    &lt;munit:set payload="#['']" doc:name="Set Message"/&gt;
    &lt;http:request config-ref="HTTP_Request_Configuration" path="/munit" method="GET" doc:name="HTTP"/&gt;
    &lt;object-to-string-transformer doc:name="Object to String"/&gt;
    &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(200))]" doc:name="Assert True"/&gt;
    &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="&amp;quot;GET RESPONSE&amp;quot;" actualValue="#[payload]" doc:name="Assert Equals"/&gt;
&lt;/munit:test&gt;

&lt;munit:test name="api-test-post" description="Test"&gt;
    &lt;munit:set payload="#['']" doc:name="Set Message"/&gt;
    &lt;http:request config-ref="HTTP_Request_Configuration" path="/munit" method="POST" doc:name="HTTP"/&gt;
    &lt;object-to-string-transformer doc:name="Object to String"/&gt;
    &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(201))]" doc:name="Assert True"/&gt;
    &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="&amp;quot;POST RESPONSE&amp;quot;" actualValue="#[payload]" doc:name="Assert Equals"/&gt;
&lt;/munit:test&gt;

&lt;munit:test name="api-test-put" description="Test"&gt;
    &lt;munit:set payload="#['']" doc:name="Set Message"/&gt;
    &lt;http:request config-ref="HTTP_Request_Configuration" path="/munit" method="PUT" doc:name="HTTP"/&gt;
    &lt;object-to-string-transformer doc:name="Object to String"/&gt;
    &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(201))]" doc:name="Assert True"/&gt;
    &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="&amp;quot;PUT RESPONSE&amp;quot;" actualValue="#[payload]" doc:name="Assert Equals"/&gt;
&lt;/munit:test&gt;

&lt;munit:test name="api-test-delete" description="Test"&gt;
    &lt;munit:set payload="#['']" doc:name="Set Message"/&gt;
    &lt;http:request config-ref="HTTP_Request_Configuration" path="/munit" method="DELETE" doc:name="HTTP"/&gt;
    &lt;object-to-string-transformer doc:name="Object to String"/&gt;
    &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(200))]" doc:name="Assert True"/&gt;
    &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="&amp;quot;DELETE RESPONSE&amp;quot;" actualValue="#[payload]" doc:name="Assert Equals"/&gt;
&lt;/munit:test&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="conclusion"><a class="anchor" href="#conclusion"></a>Conclusion</h3>
<div class="paragraph">
<p>This example shows how to trigger hits to the endpoint exposed by APIkit, and why it is important to test the endpoint in this manner. As always, you can make your test as sophisticated as you deem necessary by using the tools that MUnit offers: <a href="mock-message-processor.html">Mock</a>, <a href="spy-message-processor.html">Spy</a>, <a href="verify-message-processor.html">Verification</a>, <a href="assertion-message-processor.html">Assertion</a>, etc.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="create-a-test-suite-automatically"><a class="anchor" href="#create-a-test-suite-automatically"></a>Create a Test Suite Automatically</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Although this example is meant to showcase how to build a test suite from the ground, MUnit allows you to automatically create a test Suite based on your RAML definitions.<br>
This is illustrated in the <a href="../../solutions/getting-started/implement-and-test-api.html">implementing and testing an API quickstart</a> section.</p>
</div>
<div class="paragraph">
<p>Based on <a href="./_attachments/t-shirt.raml">complete t-shirt API definition</a>, the MUnit&#8217;s scaffolder automatically creates the following test Suite:</p>
</div>
<div class="exampleblock ex">
<div class="content">
<h3 id="studio-visual-editor-6" class="discrete view">Studio Visual Editor</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/generated-test-suite.png" alt="generated test suite">
</div>
</div>
<h3 id="xml-or-standalone-editor-6" class="discrete view">XML or Standalone Editor</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;mule xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:http="http://www.mulesoft.org/schema/mule/http" xmlns:mock="http://www.mulesoft.org/schema/mule/mock" xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:spring="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd http://www.mulesoft.org/schema/mule/http http://www.mulesoft.org/schema/mule/http/current/mule-http.xsd http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd http://www.mulesoft.org/schema/mule/mock http://www.mulesoft.org/schema/mule/mock/current/mule-mock.xsd "&gt;
    &lt;spring:beans&gt;
        &lt;spring:import resource="classpath:t-shirt.xml" /&gt;
    &lt;/spring:beans&gt;
    &lt;munit:config mock-connectors="false" mock-inbounds="false" /&gt;
    &lt;http:request-config name="HTTP_Request_Configuration" host="localhost" port="8081" basePath="/api" /&gt;
    &lt;munit:test name="get:/products:t-shirt-config-200-application/json-FlowTest" description="Verifying functionality of [get:/products:t-shirt-config-200-application/json]"&gt;
        &lt;http:request config-ref="HTTP_Request_Configuration" method="GET" path="/products"&gt;
            &lt;http:request-builder&gt;
                &lt;http:header headerName="Accept" value="application/json" /&gt;
            &lt;/http:request-builder&gt;
        &lt;/http:request&gt;
        &lt;object-to-string-transformer doc:name="http response to string" /&gt;
        &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(200))]" doc:name="assert that - http.status eq 200" /&gt;
        &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="#[getResource('scaffolder/response/get_200_products_application_json.json').asString()]" actualValue="#[payload]" doc:name="assert that - payload is as expected" /&gt;
    &lt;/munit:test&gt;
    &lt;munit:test name="get:/orders/status:t-shirt-config-200-application/json-FlowTest" description="Verifying functionality of [get:/orders/status:t-shirt-config-200-application/json]"&gt;
        &lt;set-variable variableName="orderId" value="#['4321']" doc:name="orderId" /&gt;
        &lt;set-variable variableName="email" value="#['max@mule.com']" doc:name="email" /&gt;
        &lt;http:request config-ref="HTTP_Request_Configuration" method="GET" path="/orders/status"&gt;
            &lt;http:request-builder&gt;
                &lt;http:header headerName="Accept" value="application/json" /&gt;
                &lt;http:query-param paramName="orderId" value="#[flowVars['orderId']]" /&gt;
                &lt;http:query-param paramName="email" value="#[flowVars['email']]" /&gt;
            &lt;/http:request-builder&gt;
        &lt;/http:request&gt;
        &lt;object-to-string-transformer doc:name="http response to string" /&gt;
        &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(200))]" doc:name="assert that - http.status eq 200" /&gt;
        &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="#[getResource('scaffolder/response/get_200_orders_status_application_json.json').asString()]" actualValue="#[payload]" doc:name="assert that - payload is as expected" /&gt;
    &lt;/munit:test&gt;
    &lt;munit:test name="post:/orders:application/json:t-shirt-config-200-application/json-FlowTest" description="Verifying functionality of [post:/orders:application/json:t-shirt-config-200-application/json]"&gt;
        &lt;set-payload value="#[getResource('scaffolder/request/post_orders_application_json.json').asString()]" /&gt;
        &lt;http:request config-ref="HTTP_Request_Configuration" method="POST" path="/orders"&gt;
            &lt;http:request-builder&gt;
                &lt;http:header headerName="Accept" value="application/json" /&gt;
                &lt;http:header headerName="Content-Type" value="application/json" /&gt;
            &lt;/http:request-builder&gt;
        &lt;/http:request&gt;
        &lt;object-to-string-transformer doc:name="http response to string" /&gt;
        &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(200))]" doc:name="assert that - http.status eq 200" /&gt;
        &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="#[getResource('scaffolder/response/post_200_orders_application_json.json').asString()]" actualValue="#[payload]" doc:name="assert that - payload is as expected" /&gt;
    &lt;/munit:test&gt;
&lt;/mule&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The new RAML scaffolder bundled in MUnit 1.2 generates external files located in <code>src/test/resources/scaffolder</code> based on the requests and responses examples in the API definition.
Using a <a href="mock-message-processor.html#loading-payloads-from-files-and-scripts">getResource MEL expression</a> it then references those request and responses from the MUnit test:</p>
</div>
<div class="exampleblock ex">
<div class="content">
<h3 id="studio-visual-editor-7" class="discrete view">Studio Visual Editor</h3>
<div class="imageblock">
<div class="content">
<img src="./_images/example-testing-apikit-4dee9.png" alt="example testing apikit 4dee9">
</div>
</div>
<h3 id="xml-or-standalone-editor-7" class="discrete view">XML or Standalone Editor</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;munit:test name="post:/orders:application/json:api-config-200-application/json-FlowTest" description="Verifying functionality of [post:/orders:application/json:api-config-200-application/json]"&gt;
        &lt;set-payload value="#[getResource('scaffolder/request/post_orders_application_json.json').asString()]" /&gt;
        &lt;http:request config-ref="HTTP_Request_Configuration" method="POST" path="/orders"&gt;
            &lt;http:request-builder&gt;
                &lt;http:header headerName="Accept" value="application/json" /&gt;
                &lt;http:header headerName="Content-Type" value="application/json" /&gt;
            &lt;/http:request-builder&gt;
        &lt;/http:request&gt;
        &lt;object-to-string-transformer doc:name="http response to string" /&gt;
        &lt;munit:assert-true message="The HTTP Status code is not correct!" condition="#[messageInboundProperty('http.status').is(eq(200))]" doc:name="assert that - http.status eq 200" /&gt;
        &lt;munit:assert-on-equals message="The response payload is not correct!" expectedValue="#[getResource('scaffolder/response/post_200_orders_application_json.json').asString()]" actualValue="#[payload]" doc:name="assert that - payload is as expected" /&gt;
&lt;/munit:test&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Scaffolder that generates the MUnit test from the RAML definition does not consider if your application uses <a href="../../mule-runtime/3.8/connectors/tls/tls-configuration.html">TLS configuration</a>.<br>
If your application is using a listener configured to use TLS, when running the scaffolder to generate the MUnit suite, you need to manually configure the requester in your test to use TLS as well.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If your API definition does not have examples set for your query parameters or headers, you can configure the scaffolder to set default values for your MUnit test.<br>
Go to <strong>Preferences</strong>, then select <em>Anypoint Studio</em> &gt; <em>Munit</em> &gt; <em>Scaffolder</em> and select <code>Allow setting default values when scaffolding tests</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./_images/example-testing-apikit-8d4e2.png" alt="example testing apikit 8d4e2">
</div>
</div>
<div class="paragraph">
<p>Additionally you can choose to disable the request/response file creation in case you want to define them inside your xml file.</p>
</div>
<div class="sect2">
<h3 id="scaffolder-support-for-raml-1-0"><a class="anchor" href="#scaffolder-support-for-raml-1-0"></a>Scaffolder Support for RAML 1.0</h3>
<div class="paragraph">
<p>The scaffolder doesn&#8217;t make use of some new RAML 1.0 features yet. For example, if you define an element that has a certain type, the scaffolder won&#8217;t generate a payload with that type&#8217;s properties (like it does with JSON schema), it will generate an empty payload.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While <a href="munit-coverage-report.html">app coverage</a> is a measure of quality based on how much of your application runs as a result of your test being executed, RAML (API) coverage refers to how many cases your RAML definition has and how many are being tested.</p>
</div>
<div class="paragraph">
<p>There is no hard correlation between all the possible RAML API scenarios and the actual API implementation.<br>
The scaffolding of tests tries to create a test scenario for each possible path in the API.</p>
</div>
<div class="paragraph">
<p>In any case there is no monitoring/reporting tool that shows you how much of your raml api is implemented/covered.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="last-minute-comment"><a class="anchor" href="#last-minute-comment"></a>Last Minute Comment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use APIkit in Mule runtime with or without API Gateway. API Gateway Runtime 1.3 - 2.x has a <a href="../../anypoint-platform/api-manager/api-gateway-domain.html">domain named api-gateway</a>.</p>
</div>
<div class="paragraph">
<p>Learn how to work with domains <a href="munit-domain-support.html">here</a>.</p>
</div>
</div>
</div>
  </article>
</main>
<footer class="footer"><div class="footer__wrapper">
      <div class="footer__top">
              </div>
      <div class="footer-bottom-wrapper">
        <!--<a href="/" title="Home" rel="home" class="header__logo" id="logo"><img src="/sites/all/themes/muletheme/images/mule_logo.svg" alt="Home" class="header__logo-image" /></a>-->
        <div class="connect-footer">
          <p>Sign up for our Dev newsletter</p>
          <div class="connect-footer">

</div>
  </div>
        <div class="terms-conditions temp">
          <div id="block-menu-menu-footer-bottom-menu" class="block block-menu contextual-links-region first last odd" role="navigation">
            <ul class="menu"><li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/" class="menu__link">MuleSoft.com</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://blogs.mulesoft.com/" class="menu__link">Blog</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/content/terms-service" class="menu__link">Terms</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/privacy-policy" class="menu__link">Privacy</a></li>
              <li class="menu__item is-leaf leaf"><a href="https://www.mulesoft.com/contact" class="menu__link">Contact</a></li>
            </ul></div>
                    <div class="default-terms-conditions">
          </div>
          MuleSoft provides a widely used <a href="https://www.mulesoft.com/platform/enterprise-integration">integration platform</a> for connecting SaaS and enterprise applications in the cloud and on-premise. Delivered as a unified integration experience, <a href="https://www.mulesoft.com/platform/saas/cloudhub-ipaas-cloud-based-integration">CloudHub&trade;</a> and <a href="https://www.mulesoft.com/platform/soa/mule-esb-open-source-esb">Mule ESB&trade;</a> (Enterprise Service Bus) are built on proven open source technology for fast and reliable on-premise and cloud integration without vendor lock-in.


        </div>
      </div>
      <div class="footer-end">
        <div class="footer-logo-wrapper">
          <a href="https://developer.mulesoft.com/" class="footer-logo"></a>
        </div>
        <ul class="social-links"><li><a href="https://www.mulesoft.com/lp/contact" target="_blank" class="icon-muletheme-phone"></a></li>
          <li><a href="https://www.linkedin.com/company/mulesoft" target="_blank" class="icon-muletheme-linkedin"></a></li>
          <li><a href="https://twitter.com/muledev" target="_blank" class="icon-muletheme-twitter"></a></li>
          <li><a href="https://www.facebook.com/MuleSoft" target="_blank" class="icon-muletheme-facebook"></a></li>
          <li><a href="mailto:info@mulesoft.com" target="_blank" class="icon-muletheme-email"></a></li>
          <li><a href="https://videos.mulesoft.com/" target="_blank" class="icon-muletheme-youtube"></a></li>
        </ul><p class="copyright"><span>&copy;2017</span> MuleSoft, INC.</p>
      </div>
    </div>
    </footer><script src="../../_theme/scripts/menu.js"></script>
<script src="../../_theme/scripts/highlight.pack.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>
